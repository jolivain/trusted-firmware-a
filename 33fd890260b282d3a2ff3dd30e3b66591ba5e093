{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "db3ae2c2_420ca922",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2024-08-19T11:08:01Z",
      "side": 1,
      "message": "Hi Chris,\n\nThe changes look good to me. I have a few questions about what this update offers.\n\nIIUC, the Jenkins CI is currently showing warnings during the \u0027make distclean\u0027 process, and unconditionally attempting to install the tool via the Makefile eventually leads to the error \u0027make: convert-to-c: No such file or directory,\u0027 as the Jenkins environment cannot locate the tool. Jenkins is running Python version 3.10. Although these warnings are non-harmful, as file creation still occurs and it gets built for BL2, your changes seem to address these issues.\nAdditionally, your updates seem to improve the cot-dt2c tool with Python version 3.12 (on Ubuntu 24.04 and onward), which tackles the issues mentioned in the commit messages. Please correct me if I\u0027m wrong.\n\nAlso, IIUC, you used Poetry to manage third-party packages, which helps eliminate the need to pull in source files for third-party dependencies within the tool\u0027s source. The patch also preprocesses the device tree files before feeding them to the tool, which is a great enhancement. However, should it be mentioned that Python 3.12 can\u0027t parse #ifdef directives, whereas Python 3.10 didn\u0027t have this issue?\n\nThe patch also removes the Makefile for the tool—does this mean we should no longer use the make command to build this tool? Additionally, should the test vectors (test DTSI files) be preprocessed, and some might not be required at all which were added for  #ifdef checks?\n\nWe need to update the documentation towards this tool as it used make commands and also it used direct dtsi files rather preprocessed ones so we need to update documentation towards input parameter also\nAlso, there are other tools in TF-A like tlc which also uses makefile, can we remove that too to make it consistent?",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a579c008_56527f3a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000744
      },
      "writtenOn": "2024-08-19T16:06:55Z",
      "side": 1,
      "message": "A few minor comments from me, otherwise LGTM.",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ba4ad521_e3d868f4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2024-08-19T16:49:49Z",
      "side": 1,
      "message": "Hi Manish, that\u0027s about right, though with a fresh Python 3.12 virtual environment and a clean repository I\u0027m no longer able to reproduce the original \"ifdef\" error I was seeing.\n\nI do see additional errors with Python 3.8, as even though the tool reports that it supports it, it has a dependency on pandas that it doesn\u0027t use. If you remove that dependency then you\u0027ll get the following error (unrelated to pandas):\n\n    Traceback (most recent call last):\n      File \"/home/vscode/.cache/pypoetry/virtualenvs/trusted-firmware-a-xJCVjTsP-py3.8/bin/cot-dt2c\", line 5, in \u003cmodule\u003e\n        from cot_dt2c.__main__ import cli\n      File \"/home/vscode/.cache/pypoetry/virtualenvs/trusted-firmware-a-xJCVjTsP-py3.8/lib/python3.8/site-packages/cot_dt2c/__main__.py\", line 8, in \u003cmodule\u003e\n        from cot_dt2c.cli import cli\n      File \"/home/vscode/.cache/pypoetry/virtualenvs/trusted-firmware-a-xJCVjTsP-py3.8/lib/python3.8/site-packages/cot_dt2c/cli.py\", line 8, in \u003cmodule\u003e\n        from cot_dt2c.cot_dt2c import generateMain\n      File \"/home/vscode/.cache/pypoetry/virtualenvs/trusted-firmware-a-xJCVjTsP-py3.8/lib/python3.8/site-packages/cot_dt2c/cot_dt2c.py\", line 8, in \u003cmodule\u003e\n        from cot_dt2c.cot_parser import COT\n      File \"/home/vscode/.cache/pypoetry/virtualenvs/trusted-firmware-a-xJCVjTsP-py3.8/lib/python3.8/site-packages/cot_dt2c/cot_parser.py\", line 25, in \u003cmodule\u003e\n        class COT:\n      File \"/home/vscode/.cache/pypoetry/virtualenvs/trusted-firmware-a-xJCVjTsP-py3.8/lib/python3.8/site-packages/cot_dt2c/cot_parser.py\", line 354, in COT\n        def get_node(self, nodes: list[Node], name: str) -\u003e Node:\n    TypeError: \u0027type\u0027 object is not subscriptable\n\nThis error is also resolved (accidentally) by this change.\n\n\u003e The patch also removes the Makefile for the tool—does this mean we should no longer use the make command to build this tool?\n\nI would generally recommend it - Poetry plays a similar sort of role for Python scripts that Make plays for our C sources... not entirely identical, but if we had kept it, it would have been exceedingly short and probably a bit pointless.\n\n\u003e Additionally, should the test vectors (test DTSI files) be preprocessed, and some might not be required at all which were added for #ifdef checks?\n\n\u003e We need to update the documentation towards this tool as it used make commands and also it used direct dtsi files rather preprocessed ones so we need to update documentation towards input parameter also\n\nAh, yes, you\u0027re right on both counts.\n\n\u003e Also, there are other tools in TF-A like tlc which also uses makefile, can we remove that too to make it consistent?\n\nOnly the TLC tool, which Harrison is working on a similar set of changes for in parallel.",
      "parentUuid": "db3ae2c2_420ca922",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5fef6717_f83bfbba",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2024-08-20T13:48:09Z",
      "side": 1,
      "message": "\u003e I would generally recommend it - Poetry plays a similar sort of role for Python scripts that Make plays for our C sources... not entirely identical, but if we had kept it, it would have been exceedingly short and probably a bit pointless.\n\nI\u0027m fine with removal with this explanation.\n\nAck, after this patch will look into the other patch to do the necessary modifications in the documentation and also, will remove un-necessary test dtsi files.",
      "parentUuid": "ba4ad521_e3d868f4",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a8535b3e_3e383a4d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2024-08-27T10:31:42Z",
      "side": 1,
      "message": "\u003e Ah, yes, you\u0027re right on both counts.\n\nUpdated the documentation and removed unused test Device Tree (DT) files due to this change. Additionally, modified the remaining test DT files to include preprocessed data. See this change [1]\n\n[1]: https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/30745",
      "parentUuid": "5fef6717_f83bfbba",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9b25fee9_a71b8570",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2024-08-27T11:47:40Z",
      "side": 1,
      "message": "Thanks Manish, I\u0027ll address Harrison\u0027s minor comments when I reach the office and then we should be good to go.",
      "parentUuid": "a8535b3e_3e383a4d",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e50c9e5_0de89312",
        "filename": "Makefile",
        "patchSetId": 3
      },
      "lineNbr": 124,
      "author": {
        "id": 1000744
      },
      "writtenOn": "2024-08-21T08:19:18Z",
      "side": 1,
      "message": "Probably makes sense to remove this since it is now unused.",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67fbbbf6_1d394f7b",
        "filename": "Makefile",
        "patchSetId": 3
      },
      "lineNbr": 124,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2024-08-27T16:10:45Z",
      "side": 1,
      "message": "+1, as per this change, it is not used.",
      "parentUuid": "7e50c9e5_0de89312",
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "89d22144_46236d24",
        "filename": "tools/cot_dt2c/.gitignore",
        "patchSetId": 3
      },
      "lineNbr": 73,
      "author": {
        "id": 1000744
      },
      "writtenOn": "2024-08-19T16:06:55Z",
      "side": 1,
      "message": "We don\u0027t use any of these tools and are unlikely to do so in this project, does it make sense to include them?",
      "range": {
        "startLine": 62,
        "startChar": 0,
        "endLine": 73,
        "endChar": 7
      },
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9d94ee43_83fecd40",
        "filename": "tools/cot_dt2c/.gitignore",
        "patchSetId": 3
      },
      "lineNbr": 73,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2024-08-19T16:49:49Z",
      "side": 1,
      "message": "I can remove them - it\u0027s just if we regenerate it (with gitignore.io) they\u0027ll be added and we\u0027ll have to remove them again.",
      "parentUuid": "89d22144_46236d24",
      "range": {
        "startLine": 62,
        "startChar": 0,
        "endLine": 73,
        "endChar": 7
      },
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d9c1abd_79fad8d1",
        "filename": "tools/cot_dt2c/.gitignore",
        "patchSetId": 3
      },
      "lineNbr": 73,
      "author": {
        "id": 1000744
      },
      "writtenOn": "2024-08-21T08:19:18Z",
      "side": 1,
      "message": "Leave it to your judgement, my uneducated guess is we won\u0027t need to touch the file down the line. But if you can see us needing to make wholesale changes down the road I\u0027m happy for it to stay as is.",
      "parentUuid": "9d94ee43_83fecd40",
      "range": {
        "startLine": 62,
        "startChar": 0,
        "endLine": 73,
        "endChar": 7
      },
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8572cc60_c5410dfe",
        "filename": "tools/cot_dt2c/.gitignore",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1000744
      },
      "writtenOn": "2024-08-19T16:06:55Z",
      "side": 1,
      "message": "ditto",
      "range": {
        "startLine": 82,
        "startChar": 0,
        "endLine": 87,
        "endChar": 17
      },
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e912b130_b4fd9536",
        "filename": "tools/cot_dt2c/.gitignore",
        "patchSetId": 3
      },
      "lineNbr": 114,
      "author": {
        "id": 1000744
      },
      "writtenOn": "2024-08-19T16:06:55Z",
      "side": 1,
      "message": "Do we need these?",
      "range": {
        "startLine": 89,
        "startChar": 0,
        "endLine": 114,
        "endChar": 9
      },
      "revId": "33fd890260b282d3a2ff3dd30e3b66591ba5e093",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}