{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d90a2561_14375810",
        "filename": "/COMMIT_MSG",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2023-01-20T15:22:18Z",
      "side": 1,
      "message": "We should explain why we are doing that. I think it\u0027s enough to say this is for using the latest and greatest version of mbedTLS, as advised in TF-A documentation. You could also say we were overdue on this for a number of releases.\n\nWe should also mention that mbedTLS 3.x introduces API breakages with regards to mbedTLS 2.x, and that where appropriate this commit calls the mbedtls 3.x variant, while maintaining support for the 2.x API. All of this being handled at compile time through build flags, so no runtime overhead is expected.",
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b63ee64f_00e0c0c4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 8
      },
      "lineNbr": 9,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2023-01-20T15:22:18Z",
      "side": 1,
      "message": "(minor) Remove? This just repeats the commit title.",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 28
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9fbfc004_ea5acd63",
        "filename": "/COMMIT_MSG",
        "patchSetId": 8
      },
      "lineNbr": 12,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2023-01-20T15:22:18Z",
      "side": 1,
      "message": "(minor) typo",
      "range": {
        "startLine": 12,
        "startChar": 30,
        "endLine": 12,
        "endChar": 38
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8806ef84_8471b4e4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-01-20T11:04:17Z",
      "side": 1,
      "message": "Also, I think these platform-defined mbedTLS configurations [1] and [2] should be guarded under mbedTLS Version 2 check or Do these files work with both mbedTLS versions (i.e. mbedTLS version 2.* and 3.*)?\n\n[1]: https://git.trustedfirmware.org/TF-A/trusted-firmware-a.git/tree/plat/st/stm32mp1/platform.mk#n384\n[2]: https://git.trustedfirmware.org/TF-A/trusted-firmware-a.git/tree/plat/arm/board/tc/platform_test.mk#n27",
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c56908e5_799b9e56",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2023-01-20T15:24:38Z",
      "side": 1,
      "message": "I agree with Manish.\nIt might be better to keep these changes in separate patches, though. It should make seeking ST \u0026 TC maintainers approval easier if the patch is limited to this.",
      "parentUuid": "8806ef84_8471b4e4",
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1cbefb74_283e4f18",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000103
      },
      "writtenOn": "2023-01-20T16:16:03Z",
      "side": 1,
      "message": "Hi,\nI made a quick test with mbedTLS 3.3.0.\nI had one compilation issue with SHA224, which is corrected but not in 3.3 (should be in next version):\nhttps://github.com/Mbed-TLS/mbedtls/issues/6702\n\nTo workaround this, I had to add:\n#define MBEDTLS_SHA224_C\nBut I don\u0027t know what could be the impacts of this.\n\nAnd I should run more tests with this new version.",
      "parentUuid": "c56908e5_799b9e56",
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c6bf147_a9b57854",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-01-23T09:40:48Z",
      "side": 1,
      "message": "This seems to be the reason why Govindraj included this option MBEDTLS_SHA224_C here https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/18887/8/include/drivers/auth/mbedtls/mbedtls_config-3.h#73. \n\n\u003e And I should run more tests with this new version.\nYes, to verify the sanity of this configuration file, I suggest running as many tests as possible.",
      "parentUuid": "1cbefb74_283e4f18",
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "14afb17a_c02d3b15",
        "filename": "drivers/auth/mbedtls/mbedtls_common.mk",
        "patchSetId": 8
      },
      "lineNbr": 19,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-01-19T19:27:44Z",
      "side": 1,
      "message": "Does it make sense to display the full version of mbedTLS instead of just the major version?\nIt is possible to display both major and minor, but use only major within the source code.",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 19,
        "endChar": 43
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "28fda712_2b7b3e08",
        "filename": "drivers/auth/mbedtls/mbedtls_common.mk",
        "patchSetId": 8
      },
      "lineNbr": 19,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2023-01-20T15:22:18Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "14afb17a_c02d3b15",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 19,
        "endChar": 43
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d5b013a1_01c3bfc6",
        "filename": "drivers/auth/mbedtls/mbedtls_common.mk",
        "patchSetId": 8
      },
      "lineNbr": 70,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-01-19T19:27:44Z",
      "side": 1,
      "message": "What is the purpose of introducing this compilation switch for MBEDTLS 3.*?\nAlso, setting this compilation switch via global TF_CFLAGS compiles all files with this option instead of just MBEDTLS files. If possible, should this be removed by introducing necessary changes?",
      "range": {
        "startLine": 70,
        "startChar": 1,
        "endLine": 70,
        "endChar": 40
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b5f5b5d_d89619b9",
        "filename": "drivers/auth/mbedtls/mbedtls_common.mk",
        "patchSetId": 8
      },
      "lineNbr": 70,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2023-01-20T15:22:18Z",
      "side": 1,
      "message": "\u003e What is the purpose of introducing this compilation switch for MBEDTLS 3.*?\n\nSee https://github.com/Mbed-TLS/mbedtls/issues/6910\n\n\u003e Also, setting this compilation switch via global TF_CFLAGS compiles all files with this option instead of just MBEDTLS files. If possible, should this be removed by introducing necessary changes?\n\nI agree it would be desirable to limit this flag to mbedTLS source files but unfortunately I don\u0027t think TF-A build system supports per-file (or even per-module) compilation flags right now, does it? Do you have any solution in mind?",
      "parentUuid": "d5b013a1_01c3bfc6",
      "range": {
        "startLine": 70,
        "startChar": 1,
        "endLine": 70,
        "endChar": 40
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "424b2ed6_98af952c",
        "filename": "drivers/auth/mbedtls/mbedtls_common.mk",
        "patchSetId": 8
      },
      "lineNbr": 70,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-01-23T09:40:48Z",
      "side": 1,
      "message": "\u003e I agree it would be desirable to limit this flag to mbedTLS source files but unfortunately I don\u0027t think TF-A build system supports per-file (or even per-module) compilation flags right now, does it?\n\nNo, TF-A does not have that capability at the moment. I think it would be better to add the compilation switch only to the library. Here are some changes I\u0027ve got in mind that work (haven\u0027t tested fully though):\n\n diff --git a/make_helpers/build_macros.mk b/make_helpers/build_macros.mk\n index 426e34494..75135e99e 100644\n --- a/make_helpers/build_macros.mk\n +++ b/make_helpers/build_macros.mk\n @@ -279,10 +279,11 @@ MAKE_DEP \u003d -Wp,-MD,$(DEP) -MT $$@ -MP\n  define MAKE_C_LIB\n  $(eval OBJ :\u003d $(1)/$(patsubst %.c,%.o,$(notdir $(2))))\n  $(eval DEP :\u003d $(patsubst %.o,%.d,$(OBJ)))\n +$(eval LIB :\u003d $(call uppercase, $(notdir $(1))))\n \n  $(OBJ): $(2) $(filter-out %.d,$(MAKEFILE_LIST)) | lib$(3)_dirs\n         $$(ECHO) \"  CC      $$\u003c\"\n -       $$(Q)$$(CC) $$(TF_CFLAGS) $$(CFLAGS) $(MAKE_DEP) -c $$\u003c -o $$@\n +       $$(Q)$$(CC) $$($(LIB)_CFLAGS) $$(TF_CFLAGS) $$(CFLAGS) $(MAKE_DEP) -c $$\u003c \n -o $$@",
      "parentUuid": "3b5f5b5d_d89619b9",
      "range": {
        "startLine": 70,
        "startChar": 1,
        "endLine": 70,
        "endChar": 40
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd1848a5_9b1c9fcd",
        "filename": "drivers/auth/mbedtls/mbedtls_crypto.c",
        "patchSetId": 8
      },
      "lineNbr": 300,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-01-19T19:27:44Z",
      "side": 1,
      "message": "nit: size_t output_length __unused instead?",
      "range": {
        "startLine": 300,
        "startChar": 1,
        "endLine": 300,
        "endChar": 21
      },
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "247bddcf_7795cffa",
        "filename": "include/drivers/auth/mbedtls/mbedtls_config-3.h",
        "patchSetId": 8
      },
      "lineNbr": 1,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-01-19T19:27:44Z",
      "side": 1,
      "message": "Could you please confirm that all these options are being tested for our various CI configurations?",
      "revId": "7f0a1fc4f812a6043181299d7f3cd4db9eb27d0b",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}