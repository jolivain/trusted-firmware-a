{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c7abfcfa_77775c54",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000103
      },
      "writtenOn": "2024-02-01T16:06:27Z",
      "side": 1,
      "message": "Hi Jayanth, thanks for the patch.\nFor me you should keep Patrick\u0027s patch (or series once the issues are solved) and just have the plat/arm/common/arm_pm.c modification in this patch.\nI\u0027ve asked him to update his series.\nOr should he take your patch on top of his series?",
      "revId": "6e2ea6b93d6f4c29ad73c91870859b765751d716",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "94667c43_69f0f77c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000660
      },
      "writtenOn": "2024-02-01T16:15:46Z",
      "side": 1,
      "message": "Hi Yann,\n\nThanks for the confirmation.\n\nIf needed, I  will abandon my patch, if he modifies/includes (arm_pm.c) change as part of his patch and get through the CI.\n\nLet me know if that works.\n\nIf not, I will modify this patch to keep only the changes with arm_pm.c, so that he can rebase on top of my change and trigger the CI.",
      "parentUuid": "c7abfcfa_77775c54",
      "revId": "6e2ea6b93d6f4c29ad73c91870859b765751d716",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d189ca41_0a7de795",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000690
      },
      "writtenOn": "2024-02-01T16:46:47Z",
      "side": 1,
      "message": "Hi,\n\nI made a comment, I can propose the modification to check if it is enough to solve the issue.\n\nFirst the correction proposed in https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/26207/comment/613356f6_7abe6f4b/\n\nAnd after my patches.\n\nPatrick",
      "parentUuid": "94667c43_69f0f77c",
      "revId": "6e2ea6b93d6f4c29ad73c91870859b765751d716",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d176b155_468b09c8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000660
      },
      "writtenOn": "2024-02-01T16:57:19Z",
      "side": 1,
      "message": "Hi Patrick,\n\nPlease post your patch with the modification you have mentioned.\nI will restrict this patch change to arm_pm.c.",
      "parentUuid": "d189ca41_0a7de795",
      "revId": "6e2ea6b93d6f4c29ad73c91870859b765751d716",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3cbf7f7c_4eed0a12",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000690
      },
      "writtenOn": "2024-02-01T18:03:39Z",
      "side": 1,
      "message": "I am preparing it... \n\nAnd realized I make a mistake when I read, again, the PSCI spec:\n\n- Last in Level \u003d Bits[15:12] in 6.5 Recommended StateID Encoding\n- it is not Bits[25:24] PowerLevel in 5.4.2.1 Original format\n\nI adapt my first proposal and I push it soon....",
      "parentUuid": "d176b155_468b09c8",
      "revId": "6e2ea6b93d6f4c29ad73c91870859b765751d716",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "613356f6_7abe6f4b",
        "filename": "plat/arm/common/arm_pm.c",
        "patchSetId": 4
      },
      "lineNbr": 82,
      "author": {
        "id": 1000690
      },
      "writtenOn": "2024-02-01T16:34:35Z",
      "side": 1,
      "message": "I think the test must change here:\n\nif PSCI_EXTENDED_STATE_ID \u003d\u003d 0\n\nbecause PLAT_MAX_PWR_LVL is not linked to OSI\n\n\u003d\u003e ARM_LAST_AT_PLVL_MASK : bit 25:24 is only used in power_state encoding\n   for original format in PSCI specification.\n   see chapter 5.4.2 CPU_SUSPEND parameters: power_state\n   \u003d\u003e 5.4.2.1 Origin Format\n   \u003d\u003e 5.4.2.2 Extendeted StateId format\n\nmoreover ARM_LAST_AT_PLVL_MASK should be not defined\nin include/plat/arm/common/plat_arm.h:129\n\n#if ARM_RECOM_STATE_ID_ENC\n...\n#if PSCI_OS_INIT_MODE\n#define ARM_LAST_AT_PLVL_MASK\t\t(ARM_LOCAL_PSTATE_MASK \u003c\u003c\t\\\n\t\t\t\t\t (ARM_LOCAL_PSTATE_WIDTH *\t\\\n\t\t\t\t\t  (PLAT_MAX_PWR_LVL + 1)))\n#endif /* __PSCI_OS_INIT_MODE__ */\n\n\u003d\u003e the test here can be modified also in this include file\n\nfor example, move this deine in the else of PSCI_EXTENDED_STATE_ID test\nin include/plat/arm/common/plat_arm.h:\n-----------------------------------------------------------------------\n\n#if ARM_RECOM_STATE_ID_ENC\n/*\n * Macros used to parse state information from State-ID if it is using the\n * recommended encoding for State-ID.\n */\n#define ARM_LOCAL_PSTATE_WIDTH\t\t4\n#define ARM_LOCAL_PSTATE_MASK\t\t((1 \u003c\u003c ARM_LOCAL_PSTATE_WIDTH) - 1)\n\n#if PSCI_OS_INIT_MODE\n#define ARM_LAST_AT_PLVL_MASK\t\t(ARM_LOCAL_PSTATE_MASK \u003c\u003c\t\\\n\t\t\t\t\t (ARM_LOCAL_PSTATE_WIDTH *\t\\\n\t\t\t\t\t  (PLAT_MAX_PWR_LVL + 1)))\n#endif /* __PSCI_OS_INIT_MODE__ */\n\n/* Make composite power state parameter till power level 0 */\n#if PSCI_EXTENDED_STATE_ID\n\n#define arm_make_pwrstate_lvl0(lvl0_state, pwr_lvl, type) \\\n\t\t(((lvl0_state) \u003c\u003c PSTATE_ID_SHIFT) | ((type) \u003c\u003c PSTATE_TYPE_SHIFT))\n#else\n#define arm_make_pwrstate_lvl0(lvl0_state, pwr_lvl, type) \\\n\t\t(((lvl0_state) \u003c\u003c PSTATE_ID_SHIFT) | \\\n\t\t((pwr_lvl) \u003c\u003c PSTATE_PWR_LVL_SHIFT) | \\\n\t\t((type) \u003c\u003c PSTATE_TYPE_SHIFT))\n\n#define ARM_LAST_AT_PLVL_MASK\t\t(ARM_LOCAL_PSTATE_MASK \u003c\u003c\t\\\n\t\t\t\t\t (ARM_LOCAL_PSTATE_WIDTH *\t\\\n\t\t\t\t\t  (PLAT_MAX_PWR_LVL + 1)))\n#endif /* __PSCI_EXTENDED_STATE_ID__ */\n\n-----------------------------------------------------------------------\n\nand the test here can change here\n\n#ifdef ARM_LAST_AT_PLVL_MASK\n\t\tif ((power_state \u0026 ~ARM_LAST_AT_PLVL_MASK) \u003d\u003d\n\t\t\t\t\tarm_pm_idle_states[i])\n#else\n\t\tif (power_state \u003d\u003d arm_pm_idle_states[i])\n#endif /* __PSCI_OS_INIT_MODE__ */\n\n\nNB: arm_pm_idle_states[i] not use ARM_LAST_AT_PLVL\n    plat/arm/css/common/css_pm.c \u003d\u003e use only arm_make_pwrstate_lvl2 macro\n\nI hope that this modification the test are OK for ARM platform without other\nmodification",
      "revId": "6e2ea6b93d6f4c29ad73c91870859b765751d716",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "627e578e_4fa0f72d",
        "filename": "plat/arm/common/arm_pm.c",
        "patchSetId": 4
      },
      "lineNbr": 82,
      "author": {
        "id": 1000690
      },
      "writtenOn": "2024-02-01T16:46:47Z",
      "side": 1,
      "message": "I will push the modified patch to check if test issues are solved with my proposal",
      "parentUuid": "613356f6_7abe6f4b",
      "revId": "6e2ea6b93d6f4c29ad73c91870859b765751d716",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}