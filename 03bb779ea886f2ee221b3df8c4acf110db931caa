{
  "comments": [
    {
      "key": {
        "uuid": "93bccab5_67a5ac6c",
        "filename": "plat/rpi/common/aarch64/plat_helpers.S",
        "patchSetId": 1
      },
      "lineNbr": 95,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2020-03-24T16:02:44Z",
      "side": 1,
      "message": "not sure i see the problem. Can you elaborate ? If the go condition is set by another PE, presumably it also executed an SEV. The WFE on this PE should consume it. What is the race condition here ?",
      "revId": "03bb779ea886f2ee221b3df8c4acf110db931caa",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "63e31591_24f00733",
        "filename": "plat/rpi/common/aarch64/plat_helpers.S",
        "patchSetId": 1
      },
      "lineNbr": 95,
      "author": {
        "id": 1000353
      },
      "writtenOn": "2020-03-25T04:02:31Z",
      "side": 1,
      "message": "If you look at https://github.com/andreiw/lampone-tf-a/commit/a7b6f7f5bb513a91738cf7cf5390cebdecd58541#diff-5a58b5ad8f4bf97eb9a36c54f18229afR86, here is what my thought process was. It was a flawed thought process\n\n- plat_wait_for_warm_boot runs on BSP in response to PSCI CPU_OFF\n- PSCI CPU_ON may occur asynchronously while BSP is executing plat_wait_for_warm_boot. Because the SEV from CPU_ON may come any time before plat_wait_for_warm_boot, I thought I couldn\u0027t rely on WFE on picking up that state (perhaps it got eaten earlier somewhere), hence the sevl + wfe in that code.\n\nIn practice there was no point, because the mailbox gets cleared with PLAT_RPI3_TM_HOLD_STATE_WAIT right above. So on a race between CPU_ON and BSP acting out the CPU_OFF, CPU_ON could fail.\n\nMy recommendation is to skip reordering wfe+ldr. Also, change the CPU_ON code to _wait_ for HOLD_STATE_WAIT iff core \u003d\u003d BSP and previous state was PLAT_RPI3_TM_HOLD_STATE_BSP_OFF. Well, that\u0027s in the next patch. So I suppose this whole patch can just be deleted.",
      "parentUuid": "93bccab5_67a5ac6c",
      "revId": "03bb779ea886f2ee221b3df8c4acf110db931caa",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    }
  ]
}