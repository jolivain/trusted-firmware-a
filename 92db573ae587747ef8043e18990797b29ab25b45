{
  "comments": [
    {
      "key": {
        "uuid": "15ce5ac4_17b7eb1c",
        "filename": "drivers/arm/smmu/smmu_v3.c",
        "patchSetId": 2
      },
      "lineNbr": 48,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2019-04-11T11:31:08Z",
      "side": 1,
      "message": "According to the SMMUv3 spec [1], the initialization of the (non-secure) GBPA bit differs from the S_GBPA and requires polling. See section 6.3.13.1 \"Update procedure:\n\n This register must be written with a single 32-bit write that simultaneously sets the Update bit to 1.\n Software must then poll the Update bit which is cleared when the attribute update has completed.\n\nThis seems to be confirmed by the Linux driver, see the arm_smmu_update_gbpa() function at [2], where it calls readl_relaxed_poll_timeout().\n\n[1] https://static.docs.arm.com/ihi0070/c/IHI0070C_System_Memory_Management_Unit_Arm_Architecture_Specification.pdf?_ga\u003d2.71652371.1056949138.1554899565-765340249.1548863181\n\n[2] https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/iommu/arm-smmu-v3.c?h\u003dv5.1-rc4#n2271",
      "range": {
        "startLine": 48,
        "startChar": 0,
        "endLine": 48,
        "endChar": 63
      },
      "revId": "92db573ae587747ef8043e18990797b29ab25b45",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b4d821c_de388aef",
        "filename": "drivers/arm/smmu/smmu_v3.c",
        "patchSetId": 2
      },
      "lineNbr": 48,
      "author": {
        "id": 1000105
      },
      "writtenOn": "2019-04-16T11:03:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "15ce5ac4_17b7eb1c",
      "range": {
        "startLine": 48,
        "startChar": 0,
        "endLine": 48,
        "endChar": 63
      },
      "revId": "92db573ae587747ef8043e18990797b29ab25b45",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a8d741a9_94b4ec2b",
        "filename": "drivers/arm/smmu/smmu_v3.c",
        "patchSetId": 2
      },
      "lineNbr": 58,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2019-04-11T11:31:08Z",
      "side": 1,
      "message": "Is that still a failure if the SMMU does not support secure state? I would argue that, not necessarily, as we would still have successfully configured the SMMU_GBPA bit for the non-secure side.",
      "range": {
        "startLine": 58,
        "startChar": 2,
        "endLine": 58,
        "endChar": 12
      },
      "revId": "92db573ae587747ef8043e18990797b29ab25b45",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9a5fb4ef_67e44288",
        "filename": "drivers/arm/smmu/smmu_v3.c",
        "patchSetId": 2
      },
      "lineNbr": 58,
      "author": {
        "id": 1000105
      },
      "writtenOn": "2019-04-16T11:03:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a8d741a9_94b4ec2b",
      "range": {
        "startLine": 58,
        "startChar": 2,
        "endLine": 58,
        "endChar": 12
      },
      "revId": "92db573ae587747ef8043e18990797b29ab25b45",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    }
  ]
}