{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ded18542_99ad95a0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000935
      },
      "writtenOn": "2022-12-07T17:33:14Z",
      "side": 1,
      "message": "Sandrine, do you have suggestions for rewording the comment?",
      "revId": "c80f9f4f2d180a55c442610e37dbb9a443fcb90d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "39a5b3a5_114dc551",
        "filename": "drivers/auth/mbedtls/mbedtls_x509_parser.c",
        "patchSetId": 5
      },
      "lineNbr": 325,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2022-12-07T14:47:15Z",
      "side": 1,
      "message": "Correct me if I am wrong but I think this part of the comment is meant to refer to the following ASN.1 grammar excerpt:\n\n Extensions  ::\u003d  SEQUENCE SIZE (1..MAX) OF Extension\n                                 ^\n                                here\n\nHowever, the Extensions field itself is optional:\n\n        extensions      [3]  EXPLICIT Extensions OPTIONAL\n                             -- If present, version MUST be v3\n\nwhich means that it is valid from a specification perspective for an X.509 v3 certificate to have no extensions at all. Do you agree? If yes then I think we should reword this part of the comment. I am fine with the code changes below but my understanding (as discussed in the other review [1]) is that they don\u0027t change the behaviour in any way - lines 316-320 already enforce that at least one extension is present, a do-while loop just makes that fact more explicit.\n\n[1] https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/17898/comment/e1443ede_485dacfb/",
      "range": {
        "startLine": 325,
        "startChar": 17,
        "endLine": 325,
        "endChar": 59
      },
      "revId": "c80f9f4f2d180a55c442610e37dbb9a443fcb90d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "18a451f4_0fc8eb1b",
        "filename": "drivers/auth/mbedtls/mbedtls_x509_parser.c",
        "patchSetId": 5
      },
      "lineNbr": 325,
      "author": {
        "id": 1000935
      },
      "writtenOn": "2022-12-07T17:33:14Z",
      "side": 1,
      "message": "The specification allows for the extensions field to be omitted entirely.  However, if the field is present, it must not be empty.  Every use of X.509 certificates in TF-A requires that the extensions field be both present and non-empty: the parser checks that it is present, and if it is empty, get_ext() will fail.  This change rejects an empty extensions field (as opposed to a missing one) in the parser, instead of waiting for get_exts() to fail.",
      "parentUuid": "39a5b3a5_114dc551",
      "range": {
        "startLine": 325,
        "startChar": 17,
        "endLine": 325,
        "endChar": 59
      },
      "revId": "c80f9f4f2d180a55c442610e37dbb9a443fcb90d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}