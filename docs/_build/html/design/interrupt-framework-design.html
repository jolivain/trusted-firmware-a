

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>5. Interrupt Management Framework &mdash; Trusted Firmware-A  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. PSCI Power Domain Tree Structure" href="psci-pd-tree.html" />
    <link rel="prev" title="4. Firmware Design" href="firmware-design.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Trusted Firmware-A
          

          
            
            <img src="../_static/TrustedFirmware-Logo_standard-white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/features.html">1. Feature Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/features.html#current-features">1.1. Current features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/features.html#still-to-come">1.2. Still to come</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/release-information.html">2. Release Processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/release-information.html#project-release-cadence">2.1. Project Release Cadence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../about/release-information.html#upcoming-releases">2.1.1. Upcoming Releases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../about/release-information.html#removal-of-deprecated-interfaces">2.2. Removal of Deprecated Interfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/maintainers.html">3. Project Maintenance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/maintainers.html#maintainers">3.1. Maintainers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/maintainers.html#code-owners">3.2. Code owners</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../about/maintainers.html#core-code">3.2.1. Core Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/maintainers.html#drivers-libraries-and-framework-code">3.2.2. Drivers, Libraries and Framework Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/maintainers.html#platform-ports">3.2.3. Platform Ports</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/maintainers.html#secure-payloads-and-dispatchers">3.2.4. Secure Payloads and Dispatchers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../about/maintainers.html#tools">3.2.5. Tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/contact.html">4. Support &amp; Contact</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about/contact.html#mailing-lists">4.1. Mailing Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contact.html#open-tech-forum-call">4.2. Open Tech Forum Call</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contact.html#issue-tracker">4.3. Issue Tracker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about/contact.html#arm-licensees">4.4. Arm Licensees</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about/acknowledgements.html">5. Contributor Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/prerequisites.html">1. Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/prerequisites.html#build-host">1.1. Build Host</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/prerequisites.html#toolchain">1.2. Toolchain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/prerequisites.html#software-and-libraries">1.3. Software and Libraries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/prerequisites.html#package-installation-linux">1.3.1. Package Installation (Linux)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/prerequisites.html#supporting-files">1.4. Supporting Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/prerequisites.html#getting-the-tf-a-source">1.5. Getting the TF-A Source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/docs-build.html">2. Building Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/docs-build.html#prerequisites">2.1. Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/docs-build.html#building-rendered-documentation">2.2. Building rendered documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/docs-build.html#building-rendered-documentation-from-a-container">2.3. Building rendered documentation from a container</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/tools-build.html">3. Building Supporting Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/tools-build.html#building-and-using-the-fip-tool">3.1. Building and using the FIP tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/tools-build.html#building-the-certificate-generation-tool">3.2. Building the Certificate Generation Tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/tools-build.html#building-the-firmware-encryption-tool">3.2.1. Building the Firmware Encryption Tool</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/initial-build.html">4. Performing an Initial Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/build-options.html">5. Build Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/build-options.html#common-build-options">5.1. Common build options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/build-options.html#gicv3-driver-options">5.2. GICv3 driver options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/build-options.html#debugging-options">5.3. Debugging options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/image-terminology.html">6. Image Terminology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/image-terminology.html#general-notes">6.1. General Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/image-terminology.html#trusted-firmware-images">6.2. Trusted Firmware Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#ap-boot-rom-ap-bl1">6.2.1. AP Boot ROM: <code class="docutils literal notranslate"><span class="pre">AP_BL1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#ap-ram-firmware-ap-bl2">6.2.2. AP RAM Firmware: <code class="docutils literal notranslate"><span class="pre">AP_BL2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#el3-runtime-firmware-ap-bl31">6.2.3. EL3 Runtime Firmware: <code class="docutils literal notranslate"><span class="pre">AP_BL31</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#secure-el1-payload-sp-ap-bl32">6.2.4. Secure-EL1 Payload (SP): <code class="docutils literal notranslate"><span class="pre">AP_BL32</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#ap-normal-world-firmware-ap-bl33">6.2.5. AP Normal World Firmware: <code class="docutils literal notranslate"><span class="pre">AP_BL33</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#other-ap-3rd-level-images-ap-bl3-xxx">6.2.6. Other AP 3rd level images: <code class="docutils literal notranslate"><span class="pre">AP_BL3_XXX</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#scp-boot-rom-scp-bl1-previously-bl0">6.2.7. SCP Boot ROM: <code class="docutils literal notranslate"><span class="pre">SCP_BL1</span></code> (previously <code class="docutils literal notranslate"><span class="pre">BL0</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#scp-ram-firmware-scp-bl2-previously-bl3-0">6.2.8. SCP RAM Firmware: <code class="docutils literal notranslate"><span class="pre">SCP_BL2</span></code> (previously <code class="docutils literal notranslate"><span class="pre">BL3-0</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/image-terminology.html#firmware-update-fwu-images">6.3. Firmware Update (FWU) Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#ap-firmware-update-boot-rom-ap-ns-bl1u">6.3.1. AP Firmware Update Boot ROM: <code class="docutils literal notranslate"><span class="pre">AP_NS_BL1U</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#ap-firmware-update-config-ap-bl2u">6.3.2. AP Firmware Update Config: <code class="docutils literal notranslate"><span class="pre">AP_BL2U</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#scp-firmware-update-config-scp-bl2u-previously-bl2-u0">6.3.3. SCP Firmware Update Config: <code class="docutils literal notranslate"><span class="pre">SCP_BL2U</span></code> (previously <code class="docutils literal notranslate"><span class="pre">BL2-U0</span></code>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#ap-firmware-updater-ap-ns-bl2u-previously-bl3-u">6.3.4. AP Firmware Updater: <code class="docutils literal notranslate"><span class="pre">AP_NS_BL2U</span></code> (previously <code class="docutils literal notranslate"><span class="pre">BL3-U</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/image-terminology.html#other-processor-firmware-images">6.4. Other Processor Firmware Images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#mcp-boot-rom-mcp-bl1">6.4.1. MCP Boot ROM: <code class="docutils literal notranslate"><span class="pre">MCP_BL1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/image-terminology.html#mcp-ram-firmware-mcp-bl2">6.4.2. MCP RAM Firmware: <code class="docutils literal notranslate"><span class="pre">MCP_BL2</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/porting-guide.html">7. Porting Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#introduction">7.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#common-modifications">7.2. Common modifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#common-mandatory-modifications">7.3. Common mandatory modifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#file-platform-def-h-mandatory">7.3.1. File : platform_def.h [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#file-plat-macros-s-mandatory">7.3.2. File : plat_macros.S [mandatory]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#handling-reset">7.4. Handling Reset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-my-entrypoint-mandatory-when-programmable-reset-address-0">7.4.1. Function : plat_get_my_entrypoint() [mandatory when PROGRAMMABLE_RESET_ADDRESS == 0]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-secondary-cold-boot-setup-mandatory-when-cold-boot-single-cpu-0">7.4.2. Function : plat_secondary_cold_boot_setup() [mandatory when COLD_BOOT_SINGLE_CPU == 0]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-is-my-cpu-primary-mandatory-when-cold-boot-single-cpu-0">7.4.3. Function : plat_is_my_cpu_primary() [mandatory when COLD_BOOT_SINGLE_CPU == 0]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-platform-mem-init-mandatory">7.4.4. Function : platform_mem_init() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-rotpk-info">7.4.5. Function: plat_get_rotpk_info()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-nv-ctr">7.4.6. Function: plat_get_nv_ctr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-set-nv-ctr">7.4.7. Function: plat_set_nv_ctr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-set-nv-ctr2">7.4.8. Function: plat_set_nv_ctr2()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#common-mandatory-function-modifications">7.5. Common mandatory function modifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-my-core-pos">7.5.1. Function : plat_my_core_pos()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-core-pos-by-mpidr">7.5.2. Function : plat_core_pos_by_mpidr()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-mbedtls-heap-when-trusted-board-boot-1">7.5.3. Function : plat_get_mbedtls_heap() [when TRUSTED_BOARD_BOOT == 1]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-enc-key-info-when-fw-enc-status-0-or-1">7.5.4. Function : plat_get_enc_key_info() [when FW_ENC_STATUS == 0 or 1]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#common-optional-modifications">7.6. Common optional modifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-set-my-stack">7.6.1. Function : plat_set_my_stack()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-my-stack">7.6.2. Function : plat_get_my_stack()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-report-exception">7.6.3. Function : plat_report_exception()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-reset-handler">7.6.4. Function : plat_reset_handler()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-disable-acp">7.6.5. Function : plat_disable_acp()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-error-handler">7.6.6. Function : plat_error_handler()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-panic-handler">7.6.7. Function : plat_panic_handler()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-bl-image-load-info">7.6.8. Function : plat_get_bl_image_load_info()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-next-bl-params">7.6.9. Function : plat_get_next_bl_params()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-stack-protector-canary">7.6.10. Function : plat_get_stack_protector_canary()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-flush-next-bl-params">7.6.11. Function : plat_flush_next_bl_params()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-log-get-prefix">7.6.12. Function : plat_log_get_prefix()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-soc-version">7.6.13. Function : plat_get_soc_version()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-soc-revision">7.6.14. Function : plat_get_soc_revision()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-is-smccc-feature-available">7.6.15. Function : plat_is_smccc_feature_available()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#modifications-specific-to-a-boot-loader-stage">7.7. Modifications specific to a Boot Loader stage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#boot-loader-stage-1-bl1">7.8. Boot Loader Stage 1 (BL1)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-early-platform-setup-mandatory">7.8.1. Function : bl1_early_platform_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-arch-setup-mandatory">7.8.2. Function : bl1_plat_arch_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-platform-setup-mandatory">7.8.3. Function : bl1_platform_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-sec-mem-layout-mandatory">7.8.4. Function : bl1_plat_sec_mem_layout() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-prepare-exit-optional">7.8.5. Function : bl1_plat_prepare_exit() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-set-ep-info-optional">7.8.6. Function : bl1_plat_set_ep_info() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-get-next-image-id-optional">7.8.7. Function : bl1_plat_get_next_image_id() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-get-image-desc-optional">7.8.8. Function : bl1_plat_get_image_desc() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-handle-pre-image-load-optional">7.8.9. Function : bl1_plat_handle_pre_image_load() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-handle-post-image-load-optional">7.8.10. Function : bl1_plat_handle_post_image_load() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-fwu-done-optional">7.8.11. Function : bl1_plat_fwu_done() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl1-plat-mem-check-mandatory">7.8.12. Function : bl1_plat_mem_check() [mandatory]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#boot-loader-stage-2-bl2">7.9. Boot Loader Stage 2 (BL2)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-early-platform-setup2-mandatory">7.9.1. Function : bl2_early_platform_setup2() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-plat-arch-setup-mandatory">7.9.2. Function : bl2_plat_arch_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-platform-setup-mandatory">7.9.3. Function : bl2_platform_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-plat-handle-pre-image-load-optional">7.9.4. Function : bl2_plat_handle_pre_image_load() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-plat-handle-post-image-load-optional">7.9.5. Function : bl2_plat_handle_post_image_load() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-plat-preload-setup-optional">7.9.6. Function : bl2_plat_preload_setup [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-try-next-boot-source-optional">7.9.7. Function : plat_try_next_boot_source() [optional]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#boot-loader-stage-2-bl2-at-el3">7.10. Boot Loader Stage 2 (BL2) at EL3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-el3-early-platform-setup-mandatory">7.10.1. Function : bl2_el3_early_platform_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-el3-plat-arch-setup-mandatory">7.10.2. Function : bl2_el3_plat_arch_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2-el3-plat-prepare-exit-optional">7.10.3. Function : bl2_el3_plat_prepare_exit() [optional]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#fwu-boot-loader-stage-2-bl2u">7.11. FWU Boot Loader Stage 2 (BL2U)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2u-early-platform-setup-mandatory">7.11.1. Function : bl2u_early_platform_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2u-plat-arch-setup-mandatory">7.11.2. Function : bl2u_plat_arch_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2u-platform-setup-mandatory">7.11.3. Function : bl2u_platform_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl2u-plat-handle-scp-bl2u-optional">7.11.4. Function : bl2u_plat_handle_scp_bl2u() [optional]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#boot-loader-stage-3-1-bl31">7.12. Boot Loader Stage 3-1 (BL31)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl31-early-platform-setup2-mandatory">7.12.1. Function : bl31_early_platform_setup2() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl31-plat-arch-setup-mandatory">7.12.2. Function : bl31_plat_arch_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl31-platform-setup-mandatory">7.12.3. Function : bl31_platform_setup() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl31-plat-runtime-setup-optional">7.12.4. Function : bl31_plat_runtime_setup() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl31-plat-get-next-image-ep-info-mandatory">7.12.5. Function : bl31_plat_get_next_image_ep_info() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-bl31-plat-enable-mmu-optional">7.12.6. Function : bl31_plat_enable_mmu [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-init-apkey-optional">7.12.7. Function : plat_init_apkey [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-syscnt-freq2-mandatory">7.12.8. Function : plat_get_syscnt_freq2() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-arm-set-twedel-scr-el3-optional">7.12.9. Function : plat_arm_set_twedel_scr_el3() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#define-plat-percpu-bakery-lock-size-optional">7.12.10. #define : PLAT_PERCPU_BAKERY_LOCK_SIZE [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#sdei-porting-requirements">7.12.11. SDEI porting requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#trng-porting-requirements">7.12.12. TRNG porting requirements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#power-state-coordination-interface-in-bl31">7.13. Power State Coordination Interface (in BL31)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-psci-stat-accounting-start-optional">7.13.1. Function : plat_psci_stat_accounting_start() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-psci-stat-accounting-stop-optional">7.13.2. Function : plat_psci_stat_accounting_stop() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-psci-stat-get-residency-optional">7.13.3. Function : plat_psci_stat_get_residency() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-target-pwr-state-optional">7.13.4. Function : plat_get_target_pwr_state() [optional]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-get-power-domain-tree-desc-mandatory">7.13.5. Function : plat_get_power_domain_tree_desc() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-setup-psci-ops-mandatory">7.13.6. Function : plat_setup_psci_ops() [mandatory]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#interrupt-management-framework-in-bl31">7.14. Interrupt Management framework (in BL31)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-interrupt-type-to-line-mandatory">7.14.1. Function : plat_interrupt_type_to_line() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-ic-get-pending-interrupt-type-mandatory">7.14.2. Function : plat_ic_get_pending_interrupt_type() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-ic-get-pending-interrupt-id-mandatory">7.14.3. Function : plat_ic_get_pending_interrupt_id() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-ic-acknowledge-interrupt-mandatory">7.14.4. Function : plat_ic_acknowledge_interrupt() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-ic-end-of-interrupt-mandatory">7.14.5. Function : plat_ic_end_of_interrupt() [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-ic-get-interrupt-type-mandatory">7.14.6. Function : plat_ic_get_interrupt_type() [mandatory]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#crash-reporting-mechanism-in-bl31">7.15. Crash Reporting mechanism (in BL31)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-crash-console-init-mandatory">7.15.1. Function : plat_crash_console_init [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-crash-console-putc-mandatory">7.15.2. Function : plat_crash_console_putc [mandatory]</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-crash-console-flush-mandatory">7.15.3. Function : plat_crash_console_flush [mandatory]</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#external-abort-handling-and-ras-support">7.16. External Abort handling and RAS Support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-ea-handler">7.16.1. Function : plat_ea_handler</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-handle-uncontainable-ea">7.16.2. Function : plat_handle_uncontainable_ea</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-handle-double-fault">7.16.3. Function : plat_handle_double_fault</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/porting-guide.html#function-plat-handle-el3-ea">7.16.4. Function : plat_handle_el3_ea</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#build-flags">7.17. Build flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#platform-include-paths">7.18. Platform include paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#c-library">7.19. C Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/porting-guide.html#storage-abstraction-layer">7.20. Storage abstraction layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html">8. PSCI Library Integration guide for Armv8-A AArch32 systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#generic-call-sequence-for-psci-library-interface-aarch32">8.1. Generic call sequence for PSCI Library interface (AArch32)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#psci-cpu-context-management">8.2. PSCI CPU context management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#psci-library-interface">8.3. PSCI Library Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#interface-psci-setup">8.3.1. Interface : psci_setup()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#interface-psci-prepare-next-non-secure-ctx">8.3.2. Interface : psci_prepare_next_non_secure_ctx()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#interface-psci-register-spd-pm-hook">8.3.3. Interface : psci_register_spd_pm_hook()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#interface-psci-smc-handler">8.3.4. Interface : psci_smc_handler()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#interface-psci-warmboot-entrypoint">8.3.5. Interface : psci_warmboot_entrypoint()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#el3-runtime-software-dependencies">8.4. EL3 Runtime Software dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#general-dependencies">8.4.1. General dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#cpu-context-management-api">8.4.2. CPU Context management API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#platform-api">8.4.3. Platform API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#secure-payload-power-management-callback">8.4.4. Secure payload power management callback</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/psci-lib-integration-guide.html#cpu-operations">8.4.5. CPU operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html">9. EL3 Runtime Service Writer’s Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#introduction">9.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#owning-entities-call-types-and-function-ids">9.2. Owning Entities, Call Types and Function IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#getting-started">9.3. Getting started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#registering-a-runtime-service">9.4. Registering a runtime service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#initializing-a-runtime-service">9.5. Initializing a runtime service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#handling-runtime-service-requests">9.6. Handling runtime service requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#services-that-contain-multiple-sub-services">9.7. Services that contain multiple sub-services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/rt-svc-writers-guide.html#secure-el1-payload-dispatcher-service-spd">9.8. Secure-EL1 Payload Dispatcher service (SPD)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Processes &amp; Policies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../process/security.html">1. Security Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/security.html#security-disclosures">1.1. Security Disclosures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/security.html#found-a-security-issue">1.2. Found a Security Issue?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/security.html#attribution">1.3. Attribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/security.html#security-advisories">1.4. Security Advisories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/platform-compatibility-policy.html">2. Platform Compatibility Policy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/platform-compatibility-policy.html#introduction">2.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/platform-compatibility-policy.html#id1">2.2. Platform compatibility policy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/coding-style.html">3. Coding Style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#file-encoding">3.1. File Encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#language">3.2. Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#c-language-standard">3.3. C Language Standard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#misra-compliance">3.4. MISRA Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#indentation">3.5. Indentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#spacing">3.6. Spacing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#line-length">3.7. Line Length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#blank-lines">3.8. Blank Lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#braces">3.9. Braces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#opening-brace-placement">3.9.1. Opening Brace Placement</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#conditional-statement-bodies">3.9.2. Conditional Statement Bodies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#naming">3.10. Naming</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#functions">3.10.1. Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#local-variables-and-parameters">3.10.2. Local Variables and Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#preprocessor-macros">3.10.3. Preprocessor Macros</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#function-attributes">3.11. Function Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#alignment">3.12. Alignment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#switch-statement-alignment">3.12.1. Switch Statement Alignment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#pointer-alignment">3.12.2. Pointer Alignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#comments">3.13. Comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#headers-and-inclusion">3.14. Headers and inclusion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#header-guards">3.14.1. Header guards</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#include-statement-ordering">3.14.2. Include statement ordering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#include-statement-variants">3.14.3. Include statement variants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-style.html#typedefs">3.15. Typedefs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-style.html#avoid-anonymous-typedefs-of-structs-enums-in-headers">3.15.1. Avoid anonymous typedefs of structs/enums in headers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/coding-guidelines.html">4. Coding Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-guidelines.html#automatic-editor-configuration">4.1. Automatic Editor Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-guidelines.html#automatic-compliance-checking">4.2. Automatic Compliance Checking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#ignored-checkpatch-warnings">4.2.1. Ignored Checkpatch Warnings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-guidelines.html#performance-considerations">4.3. Performance considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#avoid-printf-and-use-logging-macros">4.3.1. Avoid printf and use logging macros</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#use-const-data-where-possible">4.3.2. Use const data where possible</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-guidelines.html#libc-functions-that-are-banned-or-to-be-used-with-caution">4.4. Libc functions that are banned or to be used with caution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-guidelines.html#error-handling-and-robustness">4.5. Error handling and robustness</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#using-cassert-to-check-for-compile-time-data-errors">4.5.1. Using CASSERT to check for compile time data errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#using-assert-to-check-for-programming-errors">4.5.2. Using assert() to check for programming errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#handling-integration-errors">4.5.3. Handling integration errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#handling-recoverable-errors">4.5.4. Handling recoverable errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#handling-unrecoverable-errors">4.5.5. Handling unrecoverable errors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/coding-guidelines.html#handling-critical-unresponsiveness">4.5.6. Handling critical unresponsiveness</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-guidelines.html#use-of-built-in-c-and-libc-data-types">4.6. Use of built-in <em>C</em> and <em>libc</em> data types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/coding-guidelines.html#favor-c-language-over-assembly-language">4.7. Favor C language over assembly language</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/contributing.html">5. Contributor’s Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/contributing.html#getting-started">5.1. Getting Started</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/contributing.html#making-changes">5.2. Making Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/contributing.html#submitting-changes">5.3. Submitting Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/contributing.html#binary-components">5.4. Binary Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/code-review-guidelines.html">6. Code Review Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/code-review-guidelines.html#why-do-we-do-code-reviews">6.1. Why do we do code reviews?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/code-review-guidelines.html#good-practices">6.2. Good practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/code-review-guidelines.html#guidelines-for-patch-contributors">6.3. Guidelines for patch contributors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/code-review-guidelines.html#guidelines-for-all-reviewers">6.4. Guidelines for all reviewers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/code-review-guidelines.html#guidelines-for-code-owners">6.5. Guidelines for code owners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/code-review-guidelines.html#guidelines-for-maintainers">6.6. Guidelines for maintainers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/faq.html">7. Frequently-Asked Questions (FAQ)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/faq.html#how-do-i-update-my-changes">7.1. How do I update my changes?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/faq.html#how-long-will-my-changes-take-to-merge-into-integration">7.2. How long will my changes take to merge into <code class="docutils literal notranslate"><span class="pre">integration</span></code>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/faq.html#how-long-will-it-take-for-my-changes-to-go-from-integration-to-master">7.3. How long will it take for my changes to go from <code class="docutils literal notranslate"><span class="pre">integration</span></code> to <code class="docutils literal notranslate"><span class="pre">master</span></code>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process/faq.html#what-are-these-strange-comments-in-my-changes">7.4. What are these strange comments in my changes?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../process/security-hardening.html">8. Secure Development Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../process/security-hardening.html#security-considerations">8.1. Security considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../process/security-hardening.html#do-not-leak-secrets-to-the-normal-world">8.1.1. Do not leak secrets to the normal world</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/security-hardening.html#handling-denial-of-service-attacks">8.1.2. Handling Denial of Service attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../process/security-hardening.html#preventing-secure-world-timing-information-leakage-via-pmu-counters">8.1.3. Preventing Secure-world timing information leakage via PMU counters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../process/security-hardening.html#build-options">8.2. Build options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../components/index.html">Components</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../components/spd/index.html">1. Secure Payload Dispatcher (SPD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/spd/optee-dispatcher.html">1.1. OP-TEE Dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/spd/tlk-dispatcher.html">1.2. Trusted Little Kernel (TLK) Dispatcher</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/spd/tlk-dispatcher.html#trusted-little-kernel-tlk">1.2.1. Trusted Little Kernel (TLK)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/spd/tlk-dispatcher.html#build-tlk">1.2.2. Build TLK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/spd/tlk-dispatcher.html#input-parameters-to-tlk">1.2.3. Input parameters to TLK</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/spd/trusty-dispatcher.html">1.3. Trusty Dispatcher</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/spd/trusty-dispatcher.html#boot-parameters">1.3.1. Boot parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/spd/trusty-dispatcher.html#supported-platforms">1.3.2. Supported platforms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/arm-sip-service.html">2. Arm SiP Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/arm-sip-service.html#performance-measurement-framework-pmf">2.1. Performance Measurement Framework (PMF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/arm-sip-service.html#execution-state-switching-service">2.2. Execution State Switching service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#arm-sip-svc-exe-state-switch">2.2.1. <code class="docutils literal notranslate"><span class="pre">ARM_SIP_SVC_EXE_STATE_SWITCH</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/arm-sip-service.html#debugfs-interface">2.3. DebugFS interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#mount">2.3.1. MOUNT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#open">2.3.2. OPEN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#close">2.3.3. CLOSE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#read">2.3.4. READ</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#seek">2.3.5. SEEK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#bind">2.3.6. BIND</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#stat">2.3.7. STAT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#init">2.3.8. INIT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/arm-sip-service.html#version">2.3.9. VERSION</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/debugfs-design.html">3. Debug FS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/debugfs-design.html#overview">3.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/debugfs-design.html#virtual-filesystem">3.2. Virtual filesystem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/debugfs-design.html#namespace">3.2.1. Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/debugfs-design.html#p-interface">3.2.2. 9p interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/debugfs-design.html#smc-interface">3.3. SMC interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/debugfs-design.html#security-considerations">3.4. Security considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/debugfs-design.html#limitations">3.5. Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/debugfs-design.html#applications">3.6. Applications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/exception-handling.html">4. Exception Handling Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#introduction">4.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#the-role-of-exception-handling-framework">4.2. The role of Exception Handling Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#interrupt-handling">4.3. Interrupt handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/exception-handling.html#partitioning-priority-levels">4.3.1. Partitioning priority levels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/exception-handling.html#programming-priority">4.3.2. Programming priority</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#registering-handler">4.4. Registering handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#interrupt-handling-example">4.5. Interrupt handling example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#activating-and-deactivating-priorities">4.6. Activating and Deactivating priorities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#transition-of-priority-levels">4.7. Transition of priority levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#effect-on-smc-calls">4.8. Effect on SMC calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#build-time-flow">4.9. Build-time flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#run-time-flow">4.10. Run-time flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#interrupt-prioritisation-considerations">4.11. Interrupt Prioritisation Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/exception-handling.html#limitations">4.12. Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/fconf/index.html">5. Firmware Configuration Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/fconf/index.html#introduction">5.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/fconf/index.html#accessing-properties">5.2. Accessing properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/fconf/index.html#defining-properties">5.3. Defining properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/fconf/index.html#loading-the-property-device-tree">5.4. Loading the property device tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/fconf/index.html#populating-the-properties">5.5. Populating the properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/fconf/index.html#namespace-guidance">5.6. Namespace guidance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/fconf/index.html#properties-binding-information">5.7. Properties binding information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/fconf/fconf_properties.html">5.7.1. DTB binding for FCONF properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/firmware-update.html">6. Firmware Update (FWU)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/firmware-update.html#introduction">6.1. Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#scope">6.1.1. Scope</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/firmware-update.html#fwu-overview">6.2. FWU Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/firmware-update.html#image-identification">6.3. Image Identification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/firmware-update.html#fwu-state-machine">6.4. FWU State Machine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/firmware-update.html#bl1-smc-interface">6.5. BL1 SMC Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#bl1-smc-call-count">6.5.1. BL1_SMC_CALL_COUNT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#bl1-smc-uid">6.5.2. BL1_SMC_UID</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#bl1-smc-version">6.5.3. BL1_SMC_VERSION</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#bl1-smc-run-image">6.5.4. BL1_SMC_RUN_IMAGE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#fwu-smc-image-copy">6.5.5. FWU_SMC_IMAGE_COPY</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#fwu-smc-image-auth">6.5.6. FWU_SMC_IMAGE_AUTH</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#fwu-smc-image-execute">6.5.7. FWU_SMC_IMAGE_EXECUTE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#fwu-smc-image-resume">6.5.8. FWU_SMC_IMAGE_RESUME</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#fwu-smc-sec-image-done">6.5.9. FWU_SMC_SEC_IMAGE_DONE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#fwu-smc-update-done">6.5.10. FWU_SMC_UPDATE_DONE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/firmware-update.html#fwu-smc-image-reset">6.5.11. FWU_SMC_IMAGE_RESET</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/measured_boot/index.html">7. Measured Boot Driver (MBD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/measured_boot/index.html#properties-binding-information">7.1. Properties binding information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/measured_boot/event_log.html">7.1.1. DTB binding for Event Log properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/platform-interrupt-controller-API.html">8. Platform Interrupt Controller API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-unsigned-int-plat-ic-get-running-priority-void-optional">8.1. Function: unsigned int plat_ic_get_running_priority(void); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-int-plat-ic-is-spi-unsigned-int-id-optional">8.2. Function: int plat_ic_is_spi(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-int-plat-ic-is-ppi-unsigned-int-id-optional">8.3. Function: int plat_ic_is_ppi(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-int-plat-ic-is-sgi-unsigned-int-id-optional">8.4. Function: int plat_ic_is_sgi(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-unsigned-int-plat-ic-get-interrupt-active-unsigned-int-id-optional">8.5. Function: unsigned int plat_ic_get_interrupt_active(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-enable-interrupt-unsigned-int-id-optional">8.6. Function: void plat_ic_enable_interrupt(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-disable-interrupt-unsigned-int-id-optional">8.7. Function: void plat_ic_disable_interrupt(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-set-interrupt-priority-unsigned-int-id-unsigned-int-priority-optional">8.8. Function: void plat_ic_set_interrupt_priority(unsigned int id, unsigned int priority); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-int-plat-ic-has-interrupt-type-unsigned-int-type-optional">8.9. Function: int plat_ic_has_interrupt_type(unsigned int type); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-set-interrupt-type-unsigned-int-id-unsigned-int-type-optional">8.10. Function: void plat_ic_set_interrupt_type(unsigned int id, unsigned int type); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-raise-el3-sgi-int-sgi-num-u-register-t-target-optional">8.11. Function: void plat_ic_raise_el3_sgi(int sgi_num, u_register_t target); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-set-spi-routing-unsigned-int-id-unsigned-int-routing-mode-u-register-t-mpidr-optional">8.12. Function: void plat_ic_set_spi_routing(unsigned int id, unsigned int routing_mode, u_register_t mpidr); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-set-interrupt-pending-unsigned-int-id-optional">8.13. Function: void plat_ic_set_interrupt_pending(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-void-plat-ic-clear-interrupt-pending-unsigned-int-id-optional">8.14. Function: void plat_ic_clear_interrupt_pending(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-unsigned-int-plat-ic-set-priority-mask-unsigned-int-id-optional">8.15. Function: unsigned int plat_ic_set_priority_mask(unsigned int id); [optional]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/platform-interrupt-controller-API.html#function-unsigned-int-plat-ic-get-interrupt-id-unsigned-int-raw-optional">8.16. Function: unsigned int plat_ic_get_interrupt_id(unsigned int raw); [optional]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/ras.html">9. Reliability, Availability, and Serviceability (RAS) Extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/ras.html#overview">9.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/ras.html#platform-apis">9.2. Platform APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/ras.html#registering-ras-error-records">9.3. Registering RAS error records</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/ras.html#standard-error-record-helpers">9.3.1. Standard Error Record helpers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/ras.html#registering-ras-interrupts">9.4. Registering RAS interrupts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/ras.html#double-fault-handling">9.5. Double-fault handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/ras.html#engaging-the-ras-framework">9.6. Engaging the RAS framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/ras.html#interaction-with-exception-handling-framework">9.7. Interaction with Exception Handling Framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/romlib-design.html">10. Library at ROM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/romlib-design.html#introduction">10.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/romlib-design.html#index-file">10.2. Index file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/romlib-design.html#wrapper-functions">10.3. Wrapper functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/romlib-design.html#script">10.4. Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/romlib-design.html#patching-of-functions-in-library-at-rom">10.5. Patching of functions in library at ROM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/romlib-design.html#memory-impact">10.6. Memory impact</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/romlib-design.html#build-library-at-rom">10.7. Build library at ROM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/sdei.html">11. SDEI: Software Delegated Exception Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#introduction">11.1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#defining-events">11.2. Defining events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/sdei.html#event-flags">11.2.1. Event flags</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#event-definition-example">11.3. Event definition example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#configuration-within-exception-handling-framework">11.4. Configuration within Exception Handling Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#determining-client-el">11.5. Determining client EL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#explicit-dispatch-of-events">11.6. Explicit dispatch of events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/sdei.html#conditions-for-event-dispatch">11.6.1. Conditions for event dispatch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#porting-requirements">11.7. Porting requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/sdei.html#note-on-writing-sdei-event-handlers">11.8. Note on writing SDEI event handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/secure-partition-manager.html">12. Secure Partition Manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager.html#acronyms">12.1. Acronyms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager.html#foreword">12.2. Foreword</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#terminology">12.2.1. Terminology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#support-for-legacy-platforms">12.2.2. Support for legacy platforms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager.html#sample-reference-stack">12.3. Sample reference stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager.html#tf-a-build-options">12.4. TF-A build options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager.html#boot-process">12.5. Boot process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#loading-hafnium-and-secure-partitions-in-the-secure-world">12.5.1. Loading Hafnium and Secure Partitions in the secure world</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#booting-through-tf-a">12.5.2. Booting through TF-A</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager.html#hafnium-in-the-secure-world">12.6. Hafnium in the secure world</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#general-considerations">12.6.1. General considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#parsing-sp-partition-manifests">12.6.2. Parsing SP partition manifests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#passing-boot-data-to-the-sp">12.6.3. Passing boot data to the SP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#sp-boot-order">12.6.4. SP Boot order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#boot-phases">12.6.5. Boot phases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#mandatory-interfaces">12.6.6. Mandatory interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#direct-messaging">12.6.7. Direct messaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#memory-management">12.6.8. Memory management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#interrupt-management">12.6.9. Interrupt management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#power-management">12.6.10. Power management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager.html#sp-notification">12.6.11. SP notification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager.html#references">12.7. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/secure-partition-manager-mm.html">13. Secure Partition Manager (MM)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager-mm.html#foreword">13.1. Foreword</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager-mm.html#background">13.2. Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager-mm.html#introduction">13.3. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager-mm.html#description">13.4. Description</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#building-tf-a-with-secure-partition-support">13.4.1. Building TF-A with Secure Partition support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#describing-secure-partition-resources">13.4.2. Describing Secure Partition resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#accessing-secure-partition-services">13.4.3. Accessing Secure Partition services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#exchanging-data-with-the-secure-partition">13.4.4. Exchanging data with the Secure Partition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/secure-partition-manager-mm.html#runtime-model-of-the-secure-partition">13.5. Runtime model of the Secure Partition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#interface-with-spm">13.5.1. Interface with SPM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#miscellaneous-interfaces">13.5.2. Miscellaneous interfaces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#secure-partition-initialisation">13.5.3. Secure Partition Initialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#runtime-event-delegation">13.5.4. Runtime Event Delegation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#secure-partition-memory-management">13.5.5. Secure Partition Memory Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/secure-partition-manager-mm.html#error-codes">13.5.6. Error Codes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/psa-ffa-manifest-binding.html">14. PSA FF-A manifest binding to device tree</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/psa-ffa-manifest-binding.html#version-1-0">14.1. Version 1.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/psa-ffa-manifest-binding.html#partition-properties">14.1.1. Partition Properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/psa-ffa-manifest-binding.html#memory-regions">14.2. Memory Regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/psa-ffa-manifest-binding.html#device-regions">14.3. Device Regions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html">15. Translation (XLAT) Tables Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#about-version-1-and-version-2">15.1. About version 1 and version 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#design-concepts-and-interfaces">15.2. Design concepts and interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#mmap-regions">15.2.1. <cite>mmap</cite> regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#translation-context">15.2.2. Translation Context</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#static-and-dynamic-memory-regions">15.2.3. Static and dynamic memory regions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#library-apis">15.3. Library APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#library-limitations">15.4. Library limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#implementation-details">15.5. Implementation details</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#code-structure">15.5.1. Code structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#from-mmap-regions-to-translation-tables">15.5.2. From mmap regions to translation tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#the-memory-mapping-algorithm">15.5.3. The memory mapping algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/xlat-tables-lib-v2-design.html#tlb-maintenance-operations">15.5.4. TLB maintenance operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../components/cot-binding.html">16. Chain of trust bindings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../components/cot-binding.html#cot">16.1. cot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/cot-binding.html#manifests-and-certificate-node-bindings-definition">16.2. Manifests and Certificate node bindings definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/cot-binding.html#images-and-image-node-bindings-definition">16.3. Images and Image node bindings definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/cot-binding.html#non-volatile-counter-node-binding-definition">16.4. non-volatile counter node binding definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../components/cot-binding.html#future-update-to-chain-of-trust-binding">16.5. Future update to chain of trust binding</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">System Design</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alt-boot-flows.html">1. Alternative Boot Flows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="alt-boot-flows.html#el3-payloads-alternative-boot-flow">1.1. EL3 payloads alternative boot flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="alt-boot-flows.html#booting-an-el3-payload">1.1.1. Booting an EL3 payload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="alt-boot-flows.html#preloaded-bl33-alternative-boot-flow">1.2. Preloaded BL33 alternative boot flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auth-framework.html">2. Authentication Framework &amp; Chain of Trust</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auth-framework.html#framework-design">2.1. Framework design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#chain-of-trust">2.1.1. Chain of Trust</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#image-types">2.1.2. Image types</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#component-responsibilities">2.1.3. Component responsibilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#authentication-methods">2.1.4. Authentication methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="auth-framework.html#specifying-a-chain-of-trust">2.2. Specifying a Chain of Trust</a><ul>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#describing-the-image-parsing-methods">2.2.1. Describing the image parsing methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#describing-the-authentication-method-s">2.2.2. Describing the authentication method(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#storing-authentication-parameters">2.2.3. Storing Authentication parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#describing-an-image-in-a-cot">2.2.4. Describing an image in a CoT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="auth-framework.html#implementation-example">2.3. Implementation example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#the-tbbr-cot">2.3.1. The TBBR CoT</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#the-image-parser-library">2.3.2. The image parser library</a></li>
<li class="toctree-l4"><a class="reference internal" href="auth-framework.html#the-cryptographic-library">2.3.3. The cryptographic library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cpu-specific-build-macros.html">3. Arm CPU Specific Build Macros</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cpu-specific-build-macros.html#security-vulnerability-workarounds">3.1. Security Vulnerability Workarounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpu-specific-build-macros.html#cpu-errata-workarounds">3.2. CPU Errata Workarounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpu-specific-build-macros.html#dsu-errata-workarounds">3.3. DSU Errata Workarounds</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpu-specific-build-macros.html#cpu-specific-optimizations">3.4. CPU Specific optimizations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="firmware-design.html">4. Firmware Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#cold-boot">4.1. Cold boot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#dynamic-configuration-during-cold-boot">4.1.1. Dynamic Configuration during cold boot</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#bl1">4.1.2. BL1</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#bl2">4.1.3. BL2</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#running-bl2-at-el3-execution-level">4.1.4. Running BL2 at EL3 execution level</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#aarch64-bl31">4.1.5. AArch64 BL31</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#using-alternative-trusted-boot-firmware-in-place-of-bl1-bl2-aarch64-only">4.1.6. Using alternative Trusted Boot Firmware in place of BL1 &amp; BL2 (AArch64 only)</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#aarch32-el3-runtime-software-entrypoint-interface">4.1.7. AArch32 EL3 Runtime Software entrypoint interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#el3-runtime-services-framework">4.2. EL3 runtime services framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#registration">4.2.1. Registration</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#initialization">4.2.2. Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#handling-an-smc">4.2.3. Handling an SMC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#exception-handling-framework">4.3. Exception Handling Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#power-state-coordination-interface">4.4. Power State Coordination Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#secure-el1-payloads-and-dispatchers">4.5. Secure-EL1 Payloads and Dispatchers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#initializing-a-bl32-image">4.5.1. Initializing a BL32 Image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#crash-reporting-in-bl31">4.6. Crash Reporting in BL31</a></li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#guidelines-for-reset-handlers">4.7. Guidelines for Reset Handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#configuring-secure-interrupts">4.8. Configuring secure interrupts</a></li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#cpu-specific-operations-framework">4.9. CPU specific operations framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#cpu-specific-reset-handling">4.9.1. CPU specific Reset Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#cpu-specific-power-down-sequence">4.9.2. CPU specific power down sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#cpu-specific-register-reporting-during-crash">4.9.3. CPU specific register reporting during crash</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#cpu-errata-status-reporting">4.9.4. CPU errata status reporting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#memory-layout-of-bl-images">4.10. Memory layout of BL images</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#linker-scripts-and-symbols">4.10.1. Linker scripts and symbols</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#how-to-choose-the-right-base-addresses-for-each-bootloader-stage-image">4.10.2. How to choose the right base addresses for each bootloader stage image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#firmware-image-package-fip">4.11. Firmware Image Package (FIP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#firmware-image-package-layout">4.11.1. Firmware Image Package layout</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#firmware-image-package-creation-tool">4.11.2. Firmware Image Package creation tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#loading-from-a-firmware-image-package-fip">4.11.3. Loading from a Firmware Image Package (FIP)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#use-of-coherent-memory-in-tf-a">4.12. Use of coherent memory in TF-A</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#disabling-the-use-of-coherent-memory-in-tf-a">4.12.1. Disabling the use of coherent memory in TF-A</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#coherent-memory-usage-in-psci-implementation">4.12.2. Coherent memory usage in PSCI implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#bakery-lock-data">4.12.3. Bakery lock data</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#non-functional-impact-of-removing-coherent-memory">4.12.4. Non Functional Impact of removing coherent memory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#isolating-code-and-read-only-data-on-separate-memory-pages">4.13. Isolating code and read-only data on separate memory pages</a></li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#publish-and-subscribe-framework">4.14. Publish and Subscribe Framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#publish-and-subscribe-example">4.14.1. Publish and Subscribe Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#reclaiming-the-bl31-initialization-code">4.14.2. Reclaiming the BL31 initialization code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#performance-measurement-framework">4.15. Performance Measurement Framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#timestamp-identifier-format">4.15.1. Timestamp identifier format</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#registering-a-pmf-service">4.15.2. Registering a PMF service</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#capturing-a-timestamp">4.15.3. Capturing a timestamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#retrieving-a-timestamp">4.15.4. Retrieving a timestamp</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#pmf-code-structure">4.15.5. PMF code structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#armv8-a-architecture-extensions">4.16. Armv8-A Architecture Extensions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#armv8-1-a">4.16.1. Armv8.1-A</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#armv8-2-a">4.16.2. Armv8.2-A</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#armv8-3-a">4.16.3. Armv8.3-A</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#armv8-5-a">4.16.4. Armv8.5-A</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware-design.html#armv7-a">4.16.5. Armv7-A</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="firmware-design.html#code-structure">4.17. Code Structure</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5. Interrupt Management Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concepts">5.1. Concepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#interrupt-types">5.1.1. Interrupt types</a></li>
<li class="toctree-l4"><a class="reference internal" href="#routing-model">5.1.2. Routing model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#valid-routing-models">5.1.3. Valid routing models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mapping-of-interrupt-type-to-signal">5.1.4. Mapping of interrupt type to signal</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#assumptions-in-interrupt-management-framework">5.2. Assumptions in Interrupt Management Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#software-components">5.3. Software components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interrupt-registration">5.4. Interrupt registration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#el3-runtime-firmware">5.4.1. EL3 runtime firmware</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-payload-dispatcher">5.4.2. Secure payload dispatcher</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-secure-payload-dispatcher-behavior">5.4.3. Test secure payload dispatcher behavior</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-payload">5.4.4. Secure payload</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-secure-payload-behavior">5.4.5. Test secure payload behavior</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#interrupt-handling">5.5. Interrupt handling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">5.5.1. EL3 runtime firmware</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">5.5.2. Secure payload dispatcher</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-payload-interrupt-handling">5.5.3. Secure payload interrupt handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#other-considerations">5.6. Other considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#implication-of-preempted-smc-on-non-secure-software">5.6.1. Implication of preempted SMC on Non-Secure Software</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="psci-pd-tree.html">6. PSCI Power Domain Tree Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="psci-pd-tree.html#requirements">6.1. Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="psci-pd-tree.html#design">6.2. Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="psci-pd-tree.html#describing-a-power-domain-tree">6.2.1. Describing a power domain tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="psci-pd-tree.html#removing-assumptions-about-mpidrs-used-in-a-platform">6.2.2. Removing assumptions about MPIDRs used in a platform</a></li>
<li class="toctree-l4"><a class="reference internal" href="psci-pd-tree.html#traversing-through-and-distinguishing-between-core-and-non-core-power-domains">6.2.3. Traversing through and distinguishing between core and non-core power domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="psci-pd-tree.html#populating-the-power-domain-tree">6.2.4. Populating the power domain tree</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reset-design.html">7. CPU Reset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reset-design.html#general-reset-code-flow">7.1. General reset code flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset-design.html#programmable-cpu-reset-address">7.2. Programmable CPU reset address</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset-design.html#cold-boot-on-a-single-cpu">7.3. Cold boot on a single CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset-design.html#programmable-cpu-reset-address-cold-boot-on-a-single-cpu">7.4. Programmable CPU reset address, Cold boot on a single CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset-design.html#using-bl31-entrypoint-as-the-reset-address">7.5. Using BL31 entrypoint as the reset address</a><ul>
<li class="toctree-l4"><a class="reference internal" href="reset-design.html#determination-of-boot-path">7.5.1. Determination of boot path</a></li>
<li class="toctree-l4"><a class="reference internal" href="reset-design.html#platform-initialization">7.5.2. Platform initialization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="trusted-board-boot.html">8. Trusted Board Boot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="trusted-board-boot.html#chain-of-trust">8.1. Chain of Trust</a></li>
<li class="toctree-l3"><a class="reference internal" href="trusted-board-boot.html#trusted-board-boot-sequence">8.2. Trusted Board Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="trusted-board-boot.html#authentication-framework">8.3. Authentication Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="trusted-board-boot.html#certificate-generation-tool">8.4. Certificate Generation Tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="trusted-board-boot.html#authenticated-encryption-framework">8.5. Authenticated Encryption Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="trusted-board-boot.html#firmware-encryption-tool">8.6. Firmware Encryption Tool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="trusted-board-boot-build.html">9. Building FIP images with support for Trusted Board Boot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plat/index.html">Platform Ports</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../plat/allwinner.html">1. Allwinner ARMv8 SoCs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/allwinner.html#trusted-os-dispatcher">1.1. Trusted OS dispatcher</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/arm/index.html">2. Arm Development Platforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/arm/juno/index.html">2.1. Arm Juno Development Platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#platform-specific-build-options">2.1.1. Platform-specific build options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#running-software-on-juno">2.1.2. Running software on Juno</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#preparing-tf-a-images">2.1.3. Preparing TF-A images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#creating-a-firmware-image-package-fip">2.1.4. Creating a Firmware Image Package (FIP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#booting-firmware-update-images">2.1.5. Booting Firmware Update images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#booting-an-el3-payload">2.1.6. Booting an EL3 payload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#booting-a-preloaded-kernel-image">2.1.7. Booting a preloaded kernel image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#testing-system-suspend">2.1.8. Testing System Suspend</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/juno/index.html#additional-resources">2.1.9. Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/arm/fvp/index.html">2.2. Arm Fixed Virtual Platforms (FVP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/fvp/index.html#fixed-virtual-platform-fvp-support">2.2.1. Fixed Virtual Platform (FVP) Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/fvp/index.html#arm-fvp-platform-specific-build-options">2.2.2. Arm FVP Platform Specific Build Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/fvp/index.html#booting-firmware-update-images">2.2.3. Booting Firmware Update images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/fvp/index.html#booting-an-el3-payload">2.2.4. Booting an EL3 payload</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/fvp/index.html#booting-a-preloaded-kernel-image-base-fvp">2.2.5. Booting a preloaded kernel image (Base FVP)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/arm/fvp-ve/index.html">2.3. Arm Versatile Express</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/fvp-ve/index.html#boot-sequence">2.3.1. Boot Sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/fvp-ve/index.html#how-to-build">2.3.2. How to build</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/arm/tc0/index.html">2.4. TC0 Total Compute Platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/tc0/index.html#boot-sequence">2.4.1. Boot Sequence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/arm/arm_fpga/index.html">2.5. Arm FPGA Platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/arm_fpga/index.html#platform-specific-build-options">2.5.1. Platform-specific build options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/arm_fpga/index.html#building-the-tf-a-image">2.5.2. Building the TF-A image</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/arm_fpga/index.html#running-the-tf-a-image">2.5.3. Running the TF-A image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/arm/arm-build-options.html">2.6. Arm Development Platform Build Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/arm-build-options.html#arm-platform-build-options">2.6.1. Arm Platform Build Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/arm-build-options.html#arm-css-platform-specific-build-options">2.6.2. Arm CSS Platform-Specific Build Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/arm/morello/index.html">2.7. Morello Platform</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/arm/morello/index.html#boot-sequence">2.7.1. Boot Sequence</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/meson-axg.html">3. Amlogic Meson A113D (AXG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plat/meson-gxbb.html">4. Amlogic Meson S905 (GXBB)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plat/meson-gxl.html">5. Amlogic Meson S905x (GXL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plat/meson-g12a.html">6. Amlogic Meson S905X2 (G12A)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plat/hikey.html">7. HiKey</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey.html#how-to-build">7.1. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/hikey.html#code-locations">7.1.1. Code Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/hikey.html#build-procedure">7.1.2. Build Procedure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey.html#setup-console">7.2. Setup Console</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey.html#flash-images-in-recovery-mode">7.3. Flash images in recovery mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey.html#boot-uefi-in-normal-mode">7.4. Boot UEFI in normal mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/hikey960.html">8. HiKey960</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey960.html#how-to-build">8.1. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/hikey960.html#code-locations">8.1.1. Code Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/hikey960.html#build-procedure">8.1.2. Build Procedure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey960.html#setup-console">8.2. Setup Console</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey960.html#boot-uefi-in-recovery-mode">8.3. Boot UEFI in recovery mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/hikey960.html#boot-uefi-in-normal-mode">8.4. Boot UEFI in normal mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/intel-agilex.html">9. Intel Agilex SoCFPGA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/intel-agilex.html#how-to-build">9.1. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/intel-agilex.html#code-locations">9.1.1. Code Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/intel-agilex.html#build-procedure">9.1.2. Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/intel-agilex.html#install-procedure">9.1.3. Install Procedure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/intel-agilex.html#boot-trace">9.2. Boot trace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/intel-stratix10.html">10. Intel Stratix 10 SoCFPGA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/intel-stratix10.html#how-to-build">10.1. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/intel-stratix10.html#code-locations">10.1.1. Code Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/intel-stratix10.html#build-procedure">10.1.2. Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/intel-stratix10.html#install-procedure">10.1.3. Install Procedure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/intel-stratix10.html#boot-trace">10.2. Boot trace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/marvell/index.html">11. Marvell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/marvell/armada/build.html">11.1. TF-A Build Instructions for Marvell Platforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/build.html#build-instructions">11.1.1. Build Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/build.html#special-build-flags">11.1.2. Special Build Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/build.html#build-output">11.1.3. Build output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/build.html#tools-and-external-components-installation">11.1.4. Tools and external components installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/marvell/armada/porting.html">11.2. TF-A Porting Guide for Marvell Platforms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/porting.html#source-code-structure">11.2.1. Source Code Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/porting.html#armada-70x0-armada-80x0-porting">11.2.2. Armada-70x0/Armada-80x0 Porting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-a8k-addr-map.html">11.3. Address decoding flow and address translation units of Marvell Armada 8K SoC family</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-amb.html">11.4. AMB - AXI MBUS address decoding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-amb.html#mandatory-functions">11.4.1. Mandatory functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-amb.html#mandatory-structures">11.4.2. Mandatory structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-amb.html#examples">11.4.3. Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-ccu.html">11.5. Marvell CCU address decoding bindings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-ccu.html#mandatory-functions">11.5.1. Mandatory functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-ccu.html#mandatory-structures">11.5.2. Mandatory structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-ccu.html#example">11.5.3. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-io-win.html">11.6. Marvell IO WIN address decoding bindings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-io-win.html#mandatory-functions">11.6.1. Mandatory functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-io-win.html#mandatory-structures">11.6.2. Mandatory structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-io-win.html#example">11.6.3. Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-iob.html">11.7. Marvell IOB address decoding bindings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-iob.html#mandatory-functions">11.7.1. Mandatory functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-iob.html#mandatory-structures">11.7.2. Mandatory structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-iob.html#target-id-options">11.7.3. Target ID options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/marvell/armada/misc/mvebu-iob.html#example">11.7.4. Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/mt8183.html">12. MediaTek 8183</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/mt8183.html#boot-sequence">12.1. Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/mt8183.html#how-to-build">12.2. How to Build</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/mt8192.html">13. MediaTek 8192</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/mt8192.html#boot-sequence">13.1. Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/mt8192.html#how-to-build">13.2. How to Build</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/nvidia-tegra.html">14. NVIDIA Tegra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/nvidia-tegra.html#directory-structure">14.1. Directory structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/nvidia-tegra.html#trusted-os-dispatcher">14.2. Trusted OS dispatcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/nvidia-tegra.html#scatter-files">14.3. Scatter files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/nvidia-tegra.html#preparing-the-bl31-image-to-run-on-tegra-socs">14.4. Preparing the BL31 image to run on Tegra SoCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/nvidia-tegra.html#power-management">14.5. Power Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/nvidia-tegra.html#tegra-configs">14.6. Tegra configs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/warp7.html">15. NXP i.MX7 WaRP7</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/warp7.html#boot-flow">15.1. Boot Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/warp7.html#build-instructions">15.2. Build Instructions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/warp7.html#u-boot">15.2.1. U-Boot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/warp7.html#op-tee">15.2.2. OP-TEE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/warp7.html#tf-a">15.2.3. TF-A</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/warp7.html#fip">15.2.4. FIP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/warp7.html#deploy-images">15.3. Deploy Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/warp7.html#signing-bl2">15.4. Signing BL2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/imx8.html">16. NXP i.MX 8 Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/imx8.html#boot-sequence">16.1. Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/imx8.html#how-to-build">16.2. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/imx8.html#build-procedure">16.2.1. Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/imx8.html#deploy-tf-a-images">16.2.2. Deploy TF-A Images</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/imx8m.html">17. NXP i.MX 8M Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/imx8m.html#boot-sequence">17.1. Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/imx8m.html#how-to-build">17.2. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/imx8m.html#build-procedure">17.2.1. Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/imx8m.html#deploy-tf-a-images">17.2.2. Deploy TF-A Images</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/ls1043a.html">18. NXP QorIQ® LS1043A</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/ls1043a.html#ls1043ardb-specification">18.1. LS1043ARDB Specification:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/ls1043a.html#boot-sequence">18.2. Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/ls1043a.html#how-to-build">18.3. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/ls1043a.html#build-procedure">18.3.1. Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/ls1043a.html#deploy-tf-a-images">18.3.2. Deploy TF-A Images</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/poplar.html">19. Poplar</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/poplar.html#how-to-build">19.1. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/poplar.html#code-locations">19.1.1. Code Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/poplar.html#build-procedure">19.1.2. Build Procedure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/poplar.html#install-procedure">19.2. Install Procedure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/poplar.html#boot-trace">19.3. Boot trace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/qemu.html">20. QEMU virt Armv8-A</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/qemu.html#getting-non-tf-images">20.1. Getting non-TF images</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/qemu.html#booting-via-semi-hosting-option">20.2. Booting via semi-hosting option</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/qemu.html#booting-via-flash-based-firmwares">20.3. Booting via flash based firmwares</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/qemu-sbsa.html">21. QEMU SBSA Target</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plat/qti.html">22. Qualcomm Technologies, Inc.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/qti.html#boot-trace">22.1. Boot Trace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/qti.html#how-to-build">22.2. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/qti.html#code-locations">22.2.1. Code Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/qti.html#build-procedure">22.2.2. Build Procedure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/rpi3.html">23. Raspberry Pi 3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/rpi3.html#design">23.1. Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/rpi3.html#placement-of-images">23.1.1. Placement of images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rpi3.html#boot-sequence">23.1.2. Boot sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rpi3.html#secondary-cores">23.1.3. Secondary cores</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rpi3.html#build-instructions">23.2. Build Instructions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/rpi3.html#building-the-firmware-for-kernels-that-don-t-support-psci">23.2.1. Building the firmware for kernels that don’t support PSCI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rpi3.html#building-the-firmware-for-kernels-that-support-psci">23.2.2. Building the firmware for kernels that support PSCI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rpi3.html#aarch64-kernel-build-instructions">23.3. AArch64 kernel build instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rpi3.html#setup-sd-card">23.4. Setup SD card</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/rpi4.html">24. Raspberry Pi 4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/rpi4.html#build-instructions">24.1. Build Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rpi4.html#tf-a-port-design">24.2. TF-A port design</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/rcar-gen3.html">25. Renesas R-Car</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/rcar-gen3.html#renesas-r-car-gen3-evaluation-boards">25.1. Renesas R-Car Gen3 evaluation boards:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rcar-gen3.html#overview">25.2. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rcar-gen3.html#how-to-build">25.3. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/rcar-gen3.html#build-tested">25.3.1. Build Tested:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rcar-gen3.html#system-tested">25.3.2. System Tested:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rcar-gen3.html#tf-a-build-procedure">25.3.3. TF-A Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rcar-gen3.html#install-procedure">25.3.4. Install Procedure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rcar-gen3.html#boot-trace">25.4. Boot trace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/rz-g2.html">26. Renesas RZ/G</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/rz-g2.html#renesas-rz-g2-reference-platforms">26.1. Renesas RZ/G2 reference platforms:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rz-g2.html#overview">26.2. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rz-g2.html#how-to-build">26.3. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/rz-g2.html#build-tested">26.3.1. Build Tested:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rz-g2.html#system-tested">26.3.2. System Tested:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rz-g2.html#tf-a-build-procedure">26.3.3. TF-A Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/rz-g2.html#install-procedure">26.3.4. Install Procedure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rz-g2.html#boot-trace">26.4. Boot trace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/rockchip.html">27. Rockchip SoCs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/rockchip.html#boot-sequence">27.1. Boot Sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rockchip.html#how-to-build">27.2. How to build</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/rockchip.html#how-to-deploy">27.3. How to deploy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/socionext-uniphier.html">28. Socionext UniPhier</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/socionext-uniphier.html#boot-flow">28.1. Boot Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/socionext-uniphier.html#basic-build">28.2. Basic Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/socionext-uniphier.html#optional-features">28.3. Optional features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/synquacer.html">29. Socionext Synquacer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/synquacer.html#how-to-build">29.1. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/synquacer.html#code-locations">29.1.1. Code Locations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/synquacer.html#boot-flow">29.1.2. Boot Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/synquacer.html#build-procedure">29.1.3. Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/synquacer.html#install-the-system-firmware">29.1.4. Install the System Firmware</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/stm32mp1.html">30. STMicroelectronics STM32MP1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/stm32mp1.html#stm32mp1-versions">30.1. STM32MP1 Versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/stm32mp1.html#design">30.2. Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/stm32mp1.html#memory-mapping">30.2.1. Memory mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/stm32mp1.html#boot-sequence">30.2.2. Boot sequence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/stm32mp1.html#build-instructions">30.3. Build Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/stm32mp1.html#populate-sd-card">30.4. Populate SD-card</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/ti-k3.html">31. Texas Instruments K3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/ti-k3.html#boot-flow">31.1. Boot Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/ti-k3.html#build-instructions">31.2. Build Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/ti-k3.html#deploy-images">31.3. Deploy Images</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/xilinx-versal.html">32. Xilinx Versal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/xilinx-versal.html#xilinx-versal-platform-specific-build-options">32.1. Xilinx Versal platform specific build options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/xilinx-versal.html#plm-tf-a-parameter-passing">32.2. # PLM-&gt;TF-A Parameter Passing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/xilinx-zynqmp.html">33. Xilinx Zynq UltraScale+ MPSoC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/xilinx-zynqmp.html#zynqmp-platform-specific-build-options">33.1. ZynqMP platform specific build options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/xilinx-zynqmp.html#fsbl-tf-a-parameter-passing">33.2. FSBL-&gt;TF-A Parameter Passing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/xilinx-zynqmp.html#power-domain-tree">33.3. Power Domain Tree</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plat/brcm-stingray.html">34. Broadcom Stingray</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../plat/brcm-stingray.html#description">34.1. Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plat/brcm-stingray.html#boot-sequence">34.2. Boot Sequence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/brcm-stingray.html#code-locations">34.2.1. Code Locations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../plat/brcm-stingray.html#how-to-build">34.3. How to build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../plat/brcm-stingray.html#build-procedure">34.3.1. Build Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../plat/brcm-stingray.html#deploy-tf-a-images">34.3.2. Deploy TF-A Images</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../perf/index.html">Performance &amp; Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../perf/psci-performance-juno.html">1. PSCI Performance Measurements on Arm Juno Development Platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../perf/psci-performance-juno.html#method">1.1. Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../perf/psci-performance-juno.html#results-and-commentary">1.2. Results and Commentary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../perf/psci-performance-juno.html#cpu-suspend-to-deepest-power-level-on-all-cpus-in-parallel">1.2.1. <code class="docutils literal notranslate"><span class="pre">CPU_SUSPEND</span></code> to deepest power level on all CPUs in parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../perf/psci-performance-juno.html#cpu-suspend-to-power-level-0-on-all-cpus-in-parallel">1.2.2. <code class="docutils literal notranslate"><span class="pre">CPU_SUSPEND</span></code> to power level 0 on all CPUs in parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../perf/psci-performance-juno.html#cpu-suspend-to-deepest-power-level-on-all-cpus-in-sequence">1.2.3. <code class="docutils literal notranslate"><span class="pre">CPU_SUSPEND</span></code> to deepest power level on all CPUs in sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../perf/psci-performance-juno.html#cpu-suspend-to-power-level-0-on-all-cpus-in-sequence">1.2.4. <code class="docutils literal notranslate"><span class="pre">CPU_SUSPEND</span></code> to power level 0 on all CPUs in sequence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../perf/psci-performance-juno.html#cpu-off-on-all-non-lead-cpus-in-sequence-then-cpu-suspend-on-lead-cpu-to-deepest-power-level">1.2.5. <code class="docutils literal notranslate"><span class="pre">CPU_OFF</span></code> on all non-lead CPUs in sequence then <code class="docutils literal notranslate"><span class="pre">CPU_SUSPEND</span></code> on lead CPU to deepest power level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../perf/psci-performance-juno.html#psci-version-on-all-cpus-in-parallel">1.2.6. <code class="docutils literal notranslate"><span class="pre">PSCI_VERSION</span></code> on all CPUs in parallel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../perf/tsp.html">2. Test Secure Payload (TSP) and Dispatcher (TSPD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../perf/tsp.html#building-the-test-secure-payload">2.1. Building the Test Secure Payload</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../perf/performance-monitoring-unit.html">3. Performance Monitoring Unit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../perf/performance-monitoring-unit.html#pmu-counters">3.1. PMU Counters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../perf/performance-monitoring-unit.html#architectural-mappings">3.1.1. Architectural mappings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../perf/performance-monitoring-unit.html#configuring-the-pmu-for-counting-events">3.2. Configuring the PMU for counting events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../perf/performance-monitoring-unit.html#id1">3.2.1. Architectural mappings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../perf/performance-monitoring-unit.html#relevant-register-fields">3.2.2. Relevant register fields</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security_advisories/index.html">Security Advisories</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-1.html">1. Advisory TFV-1 (CVE-2016-10319)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-2.html">2. Advisory TFV-2 (CVE-2017-7564)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-3.html">3. Advisory TFV-3 (CVE-2017-7563)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-4.html">4. Advisory TFV-4 (CVE-2017-9607)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-5.html">5. Advisory TFV-5 (CVE-2017-15031)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-6.html">6. Advisory TFV-6 (CVE-2017-5753, CVE-2017-5715, CVE-2017-5754)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/security-advisory-tfv-6.html#variant-1-cve-2017-5753">6.1. Variant 1 (CVE-2017-5753)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/security-advisory-tfv-6.html#variant-2-cve-2017-5715">6.2. Variant 2 (CVE-2017-5715)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/security-advisory-tfv-6.html#variant-3-cve-2017-5754">6.3. Variant 3 (CVE-2017-5754)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-7.html">7. Advisory TFV-7 (CVE-2018-3639)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/security-advisory-tfv-7.html#static-mitigation">7.1. Static mitigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/security-advisory-tfv-7.html#dynamic-mitigation">7.2. Dynamic mitigation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/security-advisory-tfv-8.html">8. Advisory TFV-8 (CVE-2018-19440)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design_documents/index.html">Design Documents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../design_documents/cmake_framework.html">1. TF-A CMake Build System Proposal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_documents/cmake_framework.html#abstract">1.1. Abstract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_documents/cmake_framework.html#introduction">1.2. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_documents/cmake_framework.html#main-features">1.3. Main features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../design_documents/cmake_framework.html#structured-configuration-description">1.3.1. Structured configuration description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../design_documents/cmake_framework.html#target-description">1.3.2. Target description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../design_documents/cmake_framework.html#compiler-abstraction">1.3.3. Compiler abstraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../design_documents/cmake_framework.html#external-tools">1.3.4. External tools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../design_documents/cmake_framework.html#workflow">1.4. Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_documents/cmake_framework.html#example">1.5. Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../change-log.html">Change Log &amp; Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-2-4">Version 2.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#changed">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#resolved-issues">Resolved Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-2-3">Version 2.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id1">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id2">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id3">Resolved Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id4">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-2-2">Version 2.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id5">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id6">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id7">Resolved Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#deprecations">Deprecations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id8">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-2-1">Version 2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id9">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id10">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id11">Resolved Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id12">Deprecations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id13">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-2-0">Version 2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id14">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#issues-resolved-since-last-release">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id15">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-1-6">Version 1.6</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id16">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id17">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id18">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-1-5">Version 1.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id19">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id20">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id21">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-1-4">Version 1.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id22">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id23">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id24">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-1-3">Version 1.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id25">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id26">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id27">Known issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-1-2">Version 1.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id28">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id29">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id30">Known issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-1-1">Version 1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id31">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id32">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id33">Known issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-1-0">Version 1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id34">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id35">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id36">Known issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-0-4">Version 0.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id37">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id38">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id39">Known issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-0-3">Version 0.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id40">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id41">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id42">Known issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../change-log.html#version-0-2">Version 0.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id43">New features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id44">Issues resolved since last release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log.html#id45">Known issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../change-log-upcoming.html">Change Log for Upcoming Release</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../change-log-upcoming.html#upcoming-release-version-2-4">Upcoming Release Version 2.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../change-log-upcoming.html#new-features">New Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log-upcoming.html#changed">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log-upcoming.html#resolved-issues">Resolved Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log-upcoming.html#deprecations">Deprecations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../change-log-upcoming.html#known-issues">Known Issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../license.html#spdx-identifiers">SPDX Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html#other-projects">Other Projects</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cmake/index.html">Build System Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cmake/index.html#contents">Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../cmake/concepts.html">Build System Concepts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cmake/concepts.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/concepts.html#high-level-requirements">High-level requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/concepts.html#configuration-space">Configuration space</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/concepts.html#structured-programming-concepts-with-cmake">Structured Programming Concepts With CMake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/concepts.html#structuring-the-project">Structuring the project.</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/concepts.html#entry-points">Entry points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/concepts.html#todo-items">TODO items</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cmake/user_guide.html">Build System Users Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cmake/user_guide.html#what-is-needed-to-build-with-cmake">What is needed to build with CMake?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/user_guide.html#how-to-build-with-cmake">How-to build with CMake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/user_guide.html#current-limitations">Current limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cmake/user_guide.html#list-of-modules">List of modules</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Trusted Firmware-A</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">System Design</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Interrupt Management Framework</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/design/interrupt-framework-design.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="psci-pd-tree.html" class="btn btn-neutral float-right" title="6. PSCI Power Domain Tree Structure" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="firmware-design.html" class="btn btn-neutral float-left" title="4. Firmware Design" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="interrupt-management-framework">
<h1><span class="section-number">5. </span>Interrupt Management Framework<a class="headerlink" href="#interrupt-management-framework" title="Permalink to this headline">¶</a></h1>
<p>This framework is responsible for managing interrupts routed to EL3. It also
allows EL3 software to configure the interrupt routing behavior. Its main
objective is to implement the following two requirements.</p>
<ol class="arabic simple">
<li><p>It should be possible to route interrupts meant to be handled by secure
software (Secure interrupts) to EL3, when execution is in non-secure state
(normal world). The framework should then take care of handing control of
the interrupt to either software in EL3 or Secure-EL1 depending upon the
software configuration and the GIC implementation. This requirement ensures
that secure interrupts are under the control of the secure software with
respect to their delivery and handling without the possibility of
intervention from non-secure software.</p></li>
<li><p>It should be possible to route interrupts meant to be handled by
non-secure software (Non-secure interrupts) to the last executed exception
level in the normal world when the execution is in secure world at
exception levels lower than EL3. This could be done with or without the
knowledge of software executing in Secure-EL1/Secure-EL0. The choice of
approach should be governed by the secure software. This requirement
ensures that non-secure software is able to execute in tandem with the
secure software without overriding it.</p></li>
</ol>
<div class="section" id="concepts">
<h2><span class="section-number">5.1. </span>Concepts<a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="interrupt-types">
<h3><span class="section-number">5.1.1. </span>Interrupt types<a class="headerlink" href="#interrupt-types" title="Permalink to this headline">¶</a></h3>
<p>The framework categorises an interrupt to be one of the following depending upon
the exception level(s) it is handled in.</p>
<ol class="arabic simple">
<li><p>Secure EL1 interrupt. This type of interrupt can be routed to EL3 or
Secure-EL1 depending upon the security state of the current execution
context. It is always handled in Secure-EL1.</p></li>
<li><p>Non-secure interrupt. This type of interrupt can be routed to EL3,
Secure-EL1, Non-secure EL1 or EL2 depending upon the security state of the
current execution context. It is always handled in either Non-secure EL1
or EL2.</p></li>
<li><p>EL3 interrupt. This type of interrupt can be routed to EL3 or Secure-EL1
depending upon the security state of the current execution context. It is
always handled in EL3.</p></li>
</ol>
<p>The following constants define the various interrupt types in the framework
implementation.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define INTR_TYPE_S_EL1      0</span>
<span class="cp">#define INTR_TYPE_EL3        1</span>
<span class="cp">#define INTR_TYPE_NS         2</span>
</pre></div>
</div>
</div>
<div class="section" id="routing-model">
<h3><span class="section-number">5.1.2. </span>Routing model<a class="headerlink" href="#routing-model" title="Permalink to this headline">¶</a></h3>
<p>A type of interrupt can be either generated as an FIQ or an IRQ. The target
exception level of an interrupt type is configured through the FIQ and IRQ bits
in the Secure Configuration Register at EL3 (<code class="docutils literal notranslate"><span class="pre">SCR_EL3.FIQ</span></code> and <code class="docutils literal notranslate"><span class="pre">SCR_EL3.IRQ</span></code>
bits). When <code class="docutils literal notranslate"><span class="pre">SCR_EL3.FIQ</span></code>=1, FIQs are routed to EL3. Otherwise they are routed
to the First Exception Level (FEL) capable of handling interrupts. When
<code class="docutils literal notranslate"><span class="pre">SCR_EL3.IRQ</span></code>=1, IRQs are routed to EL3. Otherwise they are routed to the
FEL. This register is configured independently by EL3 software for each security
state prior to entry into a lower exception level in that security state.</p>
<p>A routing model for a type of interrupt (generated as FIQ or IRQ) is defined as
its target exception level for each security state. It is represented by a
single bit for each security state. A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> means that the interrupt
should be routed to the FEL. A value of <code class="docutils literal notranslate"><span class="pre">1</span></code> means that the interrupt should be
routed to EL3. A routing model is applicable only when execution is not in EL3.</p>
<p>The default routing model for an interrupt type is to route it to the FEL in
either security state.</p>
</div>
<div class="section" id="valid-routing-models">
<h3><span class="section-number">5.1.3. </span>Valid routing models<a class="headerlink" href="#valid-routing-models" title="Permalink to this headline">¶</a></h3>
<p>The framework considers certain routing models for each type of interrupt to be
incorrect as they conflict with the requirements mentioned in Section 1. The
following sub-sections describe all the possible routing models and specify
which ones are valid or invalid. EL3 interrupts are currently supported only
for GIC version 3.0 (Arm GICv3) and only the Secure-EL1 and Non-secure interrupt
types are supported for GIC version 2.0 (Arm GICv2) (see <a class="reference internal" href="#assumptions-in-interrupt-management-framework">Assumptions in
Interrupt Management Framework</a>). The terminology used in the following
sub-sections is explained below.</p>
<ol class="arabic simple">
<li><p><strong>CSS</strong>. Current Security State. <code class="docutils literal notranslate"><span class="pre">0</span></code> when secure and <code class="docutils literal notranslate"><span class="pre">1</span></code> when non-secure</p></li>
<li><p><strong>TEL3</strong>. Target Exception Level 3. <code class="docutils literal notranslate"><span class="pre">0</span></code> when targeted to the FEL. <code class="docutils literal notranslate"><span class="pre">1</span></code> when
targeted to EL3.</p></li>
</ol>
<div class="section" id="secure-el1-interrupts">
<h4><span class="section-number">5.1.3.1. </span>Secure-EL1 interrupts<a class="headerlink" href="#secure-el1-interrupts" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p><strong>CSS=0, TEL3=0</strong>. Interrupt is routed to the FEL when execution is in
secure state. This is a valid routing model as secure software is in
control of handling secure interrupts.</p></li>
<li><p><strong>CSS=0, TEL3=1</strong>. Interrupt is routed to EL3 when execution is in secure
state. This is a valid routing model as secure software in EL3 can
handover the interrupt to Secure-EL1 for handling.</p></li>
<li><p><strong>CSS=1, TEL3=0</strong>. Interrupt is routed to the FEL when execution is in
non-secure state. This is an invalid routing model as a secure interrupt
is not visible to the secure software which violates the motivation behind
the Arm Security Extensions.</p></li>
<li><p><strong>CSS=1, TEL3=1</strong>. Interrupt is routed to EL3 when execution is in
non-secure state. This is a valid routing model as secure software in EL3
can handover the interrupt to Secure-EL1 for handling.</p></li>
</ol>
</div>
<div class="section" id="non-secure-interrupts">
<h4><span class="section-number">5.1.3.2. </span>Non-secure interrupts<a class="headerlink" href="#non-secure-interrupts" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p><strong>CSS=0, TEL3=0</strong>. Interrupt is routed to the FEL when execution is in
secure state. This allows the secure software to trap non-secure
interrupts, perform its book-keeping and hand the interrupt to the
non-secure software through EL3. This is a valid routing model as secure
software is in control of how its execution is preempted by non-secure
interrupts.</p></li>
<li><p><strong>CSS=0, TEL3=1</strong>. Interrupt is routed to EL3 when execution is in secure
state. This is a valid routing model as secure software in EL3 can save
the state of software in Secure-EL1/Secure-EL0 before handing the
interrupt to non-secure software. This model requires additional
coordination between Secure-EL1 and EL3 software to ensure that the
former’s state is correctly saved by the latter.</p></li>
<li><p><strong>CSS=1, TEL3=0</strong>. Interrupt is routed to FEL when execution is in
non-secure state. This is a valid routing model as a non-secure interrupt
is handled by non-secure software.</p></li>
<li><p><strong>CSS=1, TEL3=1</strong>. Interrupt is routed to EL3 when execution is in
non-secure state. This is an invalid routing model as there is no valid
reason to route the interrupt to EL3 software and then hand it back to
non-secure software for handling.</p></li>
</ol>
</div>
<div class="section" id="el3-interrupts">
<span id="id1"></span><h4><span class="section-number">5.1.3.3. </span>EL3 interrupts<a class="headerlink" href="#el3-interrupts" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p><strong>CSS=0, TEL3=0</strong>. Interrupt is routed to the FEL when execution is in
Secure-EL1/Secure-EL0. This is a valid routing model as secure software
in Secure-EL1/Secure-EL0 is in control of how its execution is preempted
by EL3 interrupt and can handover the interrupt to EL3 for handling.</p>
<p>However, when <code class="docutils literal notranslate"><span class="pre">EL3_EXCEPTION_HANDLING</span></code> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this routing model is
invalid as EL3 interrupts are unconditionally routed to EL3, and EL3
interrupts will always preempt Secure EL1/EL0 execution. See <a class="reference internal" href="../components/exception-handling.html#interrupt-handling"><span class="std std-ref">exception
handling</span></a> documentation.</p>
</li>
<li><p><strong>CSS=0, TEL3=1</strong>. Interrupt is routed to EL3 when execution is in
Secure-EL1/Secure-EL0. This is a valid routing model as secure software
in EL3 can handle the interrupt.</p></li>
<li><p><strong>CSS=1, TEL3=0</strong>. Interrupt is routed to the FEL when execution is in
non-secure state. This is an invalid routing model as a secure interrupt
is not visible to the secure software which violates the motivation behind
the Arm Security Extensions.</p></li>
<li><p><strong>CSS=1, TEL3=1</strong>. Interrupt is routed to EL3 when execution is in
non-secure state. This is a valid routing model as secure software in EL3
can handle the interrupt.</p></li>
</ol>
</div>
</div>
<div class="section" id="mapping-of-interrupt-type-to-signal">
<h3><span class="section-number">5.1.4. </span>Mapping of interrupt type to signal<a class="headerlink" href="#mapping-of-interrupt-type-to-signal" title="Permalink to this headline">¶</a></h3>
<p>The framework is meant to work with any interrupt controller implemented by a
platform. A interrupt controller could generate a type of interrupt as either an
FIQ or IRQ signal to the CPU depending upon the current security state. The
mapping between the type and signal is known only to the platform. The framework
uses this information to determine whether the IRQ or the FIQ bit should be
programmed in <code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> while applying the routing model for a type of
interrupt. The platform provides this information through the
<code class="docutils literal notranslate"><span class="pre">plat_interrupt_type_to_line()</span></code> API (described in the
<a class="reference internal" href="../getting_started/porting-guide.html#porting-guide"><span class="std std-ref">Porting Guide</span></a>). For example, on the FVP port when the platform uses an
Arm GICv2 interrupt controller, Secure-EL1 interrupts are signaled through the
FIQ signal while Non-secure interrupts are signaled through the IRQ signal.
This applies when execution is in either security state.</p>
<div class="section" id="effect-of-mapping-of-several-interrupt-types-to-one-signal">
<h4><span class="section-number">5.1.4.1. </span>Effect of mapping of several interrupt types to one signal<a class="headerlink" href="#effect-of-mapping-of-several-interrupt-types-to-one-signal" title="Permalink to this headline">¶</a></h4>
<p>It should be noted that if more than one interrupt type maps to a single
interrupt signal, and if any one of the interrupt type sets <strong>TEL3=1</strong> for a
particular security state, then interrupt signal will be routed to EL3 when in
that security state. This means that all the other interrupt types using the
same interrupt signal will be forced to the same routing model. This should be
borne in mind when choosing the routing model for an interrupt type.</p>
<p>For example, in Arm GICv3, when the execution context is Secure-EL1/
Secure-EL0, both the EL3 and the non secure interrupt types map to the FIQ
signal. So if either one of the interrupt type sets the routing model so
that <strong>TEL3=1</strong> when <strong>CSS=0</strong>, the FIQ bit in <code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> will be programmed to
route the FIQ signal to EL3 when executing in Secure-EL1/Secure-EL0, thereby
effectively routing the other interrupt type also to EL3.</p>
</div>
</div>
</div>
<div class="section" id="assumptions-in-interrupt-management-framework">
<h2><span class="section-number">5.2. </span>Assumptions in Interrupt Management Framework<a class="headerlink" href="#assumptions-in-interrupt-management-framework" title="Permalink to this headline">¶</a></h2>
<p>The framework makes the following assumptions to simplify its implementation.</p>
<ol class="arabic simple">
<li><p>Although the framework has support for 2 types of secure interrupts (EL3
and Secure-EL1 interrupt), only interrupt controller architectures
like Arm GICv3 has architectural support for EL3 interrupts in the form of
Group 0 interrupts. In Arm GICv2, all secure interrupts are assumed to be
handled in Secure-EL1. They can be delivered to Secure-EL1 via EL3 but they
cannot be handled in EL3.</p></li>
<li><p>Interrupt exceptions (<code class="docutils literal notranslate"><span class="pre">PSTATE.I</span></code> and <code class="docutils literal notranslate"><span class="pre">F</span></code> bits) are masked during execution
in EL3.</p></li>
<li><p>Interrupt management: the following sections describe how interrupts are
managed by the interrupt handling framework. This entails:</p>
<ol class="arabic simple">
<li><p>Providing an interface to allow registration of a handler and
specification of the routing model for a type of interrupt.</p></li>
<li><p>Implementing support to hand control of an interrupt type to its
registered handler when the interrupt is generated.</p></li>
</ol>
</li>
</ol>
<p>Both aspects of interrupt management involve various components in the secure
software stack spanning from EL3 to Secure-EL1. These components are described
in the section <a class="reference internal" href="#software-components">Software components</a>. The framework stores information
associated with each type of interrupt in the following data structure.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">intr_type_desc</span> <span class="p">{</span>
        <span class="n">interrupt_type_handler_t</span> <span class="n">handler</span><span class="p">;</span>
        <span class="kt">uint32_t</span> <span class="n">flags</span><span class="p">;</span>
        <span class="kt">uint32_t</span> <span class="n">scr_el3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span> <span class="n">intr_type_desc_t</span><span class="p">;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">flags</span></code> field stores the routing model for the interrupt type in
bits[1:0]. Bit[0] stores the routing model when execution is in the secure
state. Bit[1] stores the routing model when execution is in the non-secure
state. As mentioned in Section <a class="reference internal" href="#routing-model">Routing model</a>, a value of <code class="docutils literal notranslate"><span class="pre">0</span></code> implies that
the interrupt should be targeted to the FEL. A value of <code class="docutils literal notranslate"><span class="pre">1</span></code> implies that it
should be targeted to EL3. The remaining bits are reserved and SBZ. The helper
macro <code class="docutils literal notranslate"><span class="pre">set_interrupt_rm_flag()</span></code> should be used to set the bits in the
<code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">scr_el3[2]</span></code> field also stores the routing model but as a mapping of the
model in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> field to the corresponding bit in the <code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> for each
security state.</p>
<p>The framework also depends upon the platform port to configure the interrupt
controller to distinguish between secure and non-secure interrupts. The platform
is expected to be aware of the secure devices present in the system and their
associated interrupt numbers. It should configure the interrupt controller to
enable the secure interrupts, ensure that their priority is always higher than
the non-secure interrupts and target them to the primary CPU. It should also
export the interface described in the <a class="reference internal" href="../getting_started/porting-guide.html#porting-guide"><span class="std std-ref">Porting Guide</span></a> to enable
handling of interrupts.</p>
<p>In the remainder of this document, for the sake of simplicity a Arm GICv2 system
is considered and it is assumed that the FIQ signal is used to generate Secure-EL1
interrupts and the IRQ signal is used to generate non-secure interrupts in either
security state. EL3 interrupts are not considered.</p>
</div>
<div class="section" id="software-components">
<h2><span class="section-number">5.3. </span>Software components<a class="headerlink" href="#software-components" title="Permalink to this headline">¶</a></h2>
<p>Roles and responsibilities for interrupt management are sub-divided between the
following components of software running in EL3 and Secure-EL1. Each component is
briefly described below.</p>
<ol class="arabic">
<li><p>EL3 Runtime Firmware. This component is common to all ports of TF-A.</p></li>
<li><p>Secure Payload Dispatcher (SPD) service. This service interfaces with the
Secure Payload (SP) software which runs in Secure-EL1/Secure-EL0 and is
responsible for switching execution between secure and non-secure states.
A switch is triggered by a Secure Monitor Call and it uses the APIs
exported by the Context management library to implement this functionality.
Switching execution between the two security states is a requirement for
interrupt management as well. This results in a significant dependency on
the SPD service. TF-A implements an example Test Secure Payload Dispatcher
(TSPD) service.</p>
<p>An SPD service plugs into the EL3 runtime firmware and could be common to
some ports of TF-A.</p>
</li>
<li><p>Secure Payload (SP). On a production system, the Secure Payload corresponds
to a Secure OS which runs in Secure-EL1/Secure-EL0. It interfaces with the
SPD service to manage communication with non-secure software. TF-A
implements an example secure payload called Test Secure Payload (TSP)
which runs only in Secure-EL1.</p>
<p>A Secure payload implementation could be common to some ports of TF-A,
just like the SPD service.</p>
</li>
</ol>
</div>
<div class="section" id="interrupt-registration">
<h2><span class="section-number">5.4. </span>Interrupt registration<a class="headerlink" href="#interrupt-registration" title="Permalink to this headline">¶</a></h2>
<p>This section describes in detail the role of each software component (see
<a class="reference internal" href="#software-components">Software components</a>) during the registration of a handler for an interrupt
type.</p>
<div class="section" id="el3-runtime-firmware">
<span id="id2"></span><h3><span class="section-number">5.4.1. </span>EL3 runtime firmware<a class="headerlink" href="#el3-runtime-firmware" title="Permalink to this headline">¶</a></h3>
<p>This component declares the following prototype for a handler of an interrupt type.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">uint64_t</span> <span class="p">(</span><span class="o">*</span><span class="n">interrupt_type_handler_t</span><span class="p">)(</span><span class="kt">uint32_t</span> <span class="n">id</span><span class="p">,</span>
                                             <span class="kt">uint32_t</span> <span class="n">flags</span><span class="p">,</span>
                                             <span class="kt">void</span> <span class="o">*</span><span class="n">handle</span><span class="p">,</span>
                                             <span class="kt">void</span> <span class="o">*</span><span class="n">cookie</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">id</span></code> is parameter is reserved and could be used in the future for passing
the interrupt id of the highest pending interrupt only if there is a foolproof
way of determining the id. Currently it contains <code class="docutils literal notranslate"><span class="pre">INTR_ID_UNAVAILABLE</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter contains miscellaneous information as follows.</p>
<ol class="arabic simple">
<li><p>Security state, bit[0]. This bit indicates the security state of the lower
exception level when the interrupt was generated. A value of <code class="docutils literal notranslate"><span class="pre">1</span></code> means
that it was in the non-secure state. A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> indicates that it was
in the secure state. This bit can be used by the handler to ensure that
interrupt was generated and routed as per the routing model specified
during registration.</p></li>
<li><p>Reserved, bits[31:1]. The remaining bits are reserved for future use.</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">handle</span></code> parameter points to the <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> structure of the current CPU
for the security state specified in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter.</p>
<p>Once the handler routine completes, execution will return to either the secure
or non-secure state. The handler routine must return a pointer to
<code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> structure of the current CPU for the target security state. On
AArch64, this return value is currently ignored by the caller as the
appropriate <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> to be used is expected to be set by the handler
via the context management library APIs.
A portable interrupt handler implementation must set the target context both in
the structure pointed to by the returned pointer and via the context management
library APIs. The handler should treat all error conditions as critical errors
and take appropriate action within its implementation e.g. use assertion
failures.</p>
<p>The runtime firmware provides the following API for registering a handler for a
particular type of interrupt. A Secure Payload Dispatcher service should use
this API to register a handler for Secure-EL1 and optionally for non-secure
interrupts. This API also requires the caller to specify the routing model for
the type of interrupt.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int32_t</span> <span class="nf">register_interrupt_type_handler</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">type</span><span class="p">,</span>
                                        <span class="n">interrupt_type_handler</span> <span class="n">handler</span><span class="p">,</span>
                                        <span class="kt">uint64_t</span> <span class="n">flags</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter can be one of the three interrupt types listed above i.e.
<code class="docutils literal notranslate"><span class="pre">INTR_TYPE_S_EL1</span></code>, <code class="docutils literal notranslate"><span class="pre">INTR_TYPE_NS</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">INTR_TYPE_EL3</span></code>. The <code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter
is as described in Section 2.</p>
<p>The function will return <code class="docutils literal notranslate"><span class="pre">0</span></code> upon a successful registration. It will return
<code class="docutils literal notranslate"><span class="pre">-EALREADY</span></code> in case a handler for the interrupt type has already been
registered. If the <code class="docutils literal notranslate"><span class="pre">type</span></code> is unrecognised or the <code class="docutils literal notranslate"><span class="pre">flags</span></code> or the <code class="docutils literal notranslate"><span class="pre">handler</span></code> are
invalid it will return <code class="docutils literal notranslate"><span class="pre">-EINVAL</span></code>.</p>
<p>Interrupt routing is governed by the configuration of the <code class="docutils literal notranslate"><span class="pre">SCR_EL3.FIQ/IRQ</span></code> bits
prior to entry into a lower exception level in either security state. The
context management library maintains a copy of the <code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> system register for
each security state in the <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> structure of each CPU. It exports the
following APIs to let EL3 Runtime Firmware program and retrieve the routing
model for each security state for the current CPU. The value of <code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> stored
in the <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> is used by the <code class="docutils literal notranslate"><span class="pre">el3_exit()</span></code> function to program the
<code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> register prior to returning from the EL3 exception level.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">uint32_t</span> <span class="nf">cm_get_scr_el3</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">security_state</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">cm_write_scr_el3_bit</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">security_state</span><span class="p">,</span>
                          <span class="kt">uint32_t</span> <span class="n">bit_pos</span><span class="p">,</span>
                          <span class="kt">uint32_t</span> <span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cm_get_scr_el3()</span></code> returns the value of the <code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> register for the specified
security state of the current CPU. <code class="docutils literal notranslate"><span class="pre">cm_write_scr_el3_bit()</span></code> writes a <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>
to the bit specified by <code class="docutils literal notranslate"><span class="pre">bit_pos</span></code>. <code class="docutils literal notranslate"><span class="pre">register_interrupt_type_handler()</span></code> invokes
<code class="docutils literal notranslate"><span class="pre">set_routing_model()</span></code> API which programs the <code class="docutils literal notranslate"><span class="pre">SCR_EL3</span></code> according to the routing
model using the <code class="docutils literal notranslate"><span class="pre">cm_get_scr_el3()</span></code> and <code class="docutils literal notranslate"><span class="pre">cm_write_scr_el3_bit()</span></code> APIs.</p>
<p>It is worth noting that in the current implementation of the framework, the EL3
runtime firmware is responsible for programming the routing model. The SPD is
responsible for ensuring that the routing model has been adhered to upon
receiving an interrupt.</p>
</div>
<div class="section" id="secure-payload-dispatcher">
<span id="spd-int-registration"></span><h3><span class="section-number">5.4.2. </span>Secure payload dispatcher<a class="headerlink" href="#secure-payload-dispatcher" title="Permalink to this headline">¶</a></h3>
<p>A SPD service is responsible for determining and maintaining the interrupt
routing model supported by itself and the Secure Payload. It is also responsible
for ferrying interrupts between secure and non-secure software depending upon
the routing model. It could determine the routing model at build time or at
runtime. It must use this information to register a handler for each interrupt
type using the <code class="docutils literal notranslate"><span class="pre">register_interrupt_type_handler()</span></code> API in EL3 runtime firmware.</p>
<p>If the routing model is not known to the SPD service at build time, then it must
be provided by the SP as the result of its initialisation. The SPD should
program the routing model only after SP initialisation has completed e.g. in the
SPD initialisation function pointed to by the <code class="docutils literal notranslate"><span class="pre">bl32_init</span></code> variable.</p>
<p>The SPD should determine the mechanism to pass control to the Secure Payload
after receiving an interrupt from the EL3 runtime firmware. This information
could either be provided to the SPD service at build time or by the SP at
runtime.</p>
</div>
<div class="section" id="test-secure-payload-dispatcher-behavior">
<h3><span class="section-number">5.4.3. </span>Test secure payload dispatcher behavior<a class="headerlink" href="#test-secure-payload-dispatcher-behavior" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Where this document discusses <code class="docutils literal notranslate"><span class="pre">TSP_NS_INTR_ASYNC_PREEMPT</span></code> as being
<code class="docutils literal notranslate"><span class="pre">1</span></code>, the same results also apply when <code class="docutils literal notranslate"><span class="pre">EL3_EXCEPTION_HANDLING</span></code> is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</div>
<p>The TSPD only handles Secure-EL1 interrupts and is provided with the following
routing model at build time.</p>
<ul class="simple">
<li><p>Secure-EL1 interrupts are routed to EL3 when execution is in non-secure
state and are routed to the FEL when execution is in the secure state
i.e <strong>CSS=0, TEL3=0</strong> &amp; <strong>CSS=1, TEL3=1</strong> for Secure-EL1 interrupts</p></li>
<li><p>When the build flag <code class="docutils literal notranslate"><span class="pre">TSP_NS_INTR_ASYNC_PREEMPT</span></code> is zero, the default routing
model is used for non-secure interrupts. They are routed to the FEL in
either security state i.e <strong>CSS=0, TEL3=0</strong> &amp; <strong>CSS=1, TEL3=0</strong> for
Non-secure interrupts.</p></li>
<li><p>When the build flag <code class="docutils literal notranslate"><span class="pre">TSP_NS_INTR_ASYNC_PREEMPT</span></code> is defined to 1, then the
non secure interrupts are routed to EL3 when execution is in secure state
i.e <strong>CSS=0, TEL3=1</strong> for non-secure interrupts. This effectively preempts
Secure-EL1. The default routing model is used for non secure interrupts in
non-secure state. i.e <strong>CSS=1, TEL3=0</strong>.</p></li>
</ul>
<p>It performs the following actions in the <code class="docutils literal notranslate"><span class="pre">tspd_init()</span></code> function to fulfill the
requirements mentioned earlier.</p>
<ol class="arabic">
<li><p>It passes control to the Test Secure Payload to perform its
initialisation. The TSP provides the address of the vector table
<code class="docutils literal notranslate"><span class="pre">tsp_vectors</span></code> in the SP which also includes the handler for Secure-EL1
interrupts in the <code class="docutils literal notranslate"><span class="pre">sel1_intr_entry</span></code> field. The TSPD passes control to the TSP at
this address when it receives a Secure-EL1 interrupt.</p>
<p>The handover agreement between the TSP and the TSPD requires that the TSPD
masks all interrupts (<code class="docutils literal notranslate"><span class="pre">PSTATE.DAIF</span></code> bits) when it calls
<code class="docutils literal notranslate"><span class="pre">tsp_sel1_intr_entry()</span></code>. The TSP has to preserve the callee saved general
purpose, SP_EL1/Secure-EL0, LR, VFP and system registers. It can use
<code class="docutils literal notranslate"><span class="pre">x0-x18</span></code> to enable its C runtime.</p>
</li>
<li><p>The TSPD implements a handler function for Secure-EL1 interrupts. This
function is registered with the EL3 runtime firmware using the
<code class="docutils literal notranslate"><span class="pre">register_interrupt_type_handler()</span></code> API as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Forward declaration */</span>
<span class="n">interrupt_type_handler</span> <span class="n">tspd_secure_el1_interrupt_handler</span><span class="p">;</span>
<span class="kt">int32_t</span> <span class="n">rc</span><span class="p">,</span> <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">set_interrupt_rm_flag</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">NON_SECURE</span><span class="p">);</span>
<span class="n">rc</span> <span class="o">=</span> <span class="n">register_interrupt_type_handler</span><span class="p">(</span><span class="n">INTR_TYPE_S_EL1</span><span class="p">,</span>
                                 <span class="n">tspd_secure_el1_interrupt_handler</span><span class="p">,</span>
                                 <span class="n">flags</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">rc</span><span class="p">)</span>
    <span class="n">panic</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p>When the build flag <code class="docutils literal notranslate"><span class="pre">TSP_NS_INTR_ASYNC_PREEMPT</span></code> is defined to 1, the TSPD
implements a handler function for non-secure interrupts. This function is
registered with the EL3 runtime firmware using the
<code class="docutils literal notranslate"><span class="pre">register_interrupt_type_handler()</span></code> API as follows</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Forward declaration */</span>
<span class="n">interrupt_type_handler</span> <span class="n">tspd_ns_interrupt_handler</span><span class="p">;</span>
<span class="kt">int32_t</span> <span class="n">rc</span><span class="p">,</span> <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">set_interrupt_rm_flag</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">SECURE</span><span class="p">);</span>
<span class="n">rc</span> <span class="o">=</span> <span class="n">register_interrupt_type_handler</span><span class="p">(</span><span class="n">INTR_TYPE_NS</span><span class="p">,</span>
                                <span class="n">tspd_ns_interrupt_handler</span><span class="p">,</span>
                                <span class="n">flags</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">rc</span><span class="p">)</span>
    <span class="n">panic</span><span class="p">();</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="secure-payload">
<span id="sp-int-registration"></span><h3><span class="section-number">5.4.4. </span>Secure payload<a class="headerlink" href="#secure-payload" title="Permalink to this headline">¶</a></h3>
<p>A Secure Payload must implement an interrupt handling framework at Secure-EL1
(Secure-EL1 IHF) to support its chosen interrupt routing model. Secure payload
execution will alternate between the below cases.</p>
<ol class="arabic simple">
<li><p>In the code where IRQ, FIQ or both interrupts are enabled, if an interrupt
type is targeted to the FEL, then it will be routed to the Secure-EL1
exception vector table. This is defined as the <strong>asynchronous mode</strong> of
handling interrupts. This mode applies to both Secure-EL1 and non-secure
interrupts.</p></li>
<li><p>In the code where both interrupts are disabled, if an interrupt type is
targeted to the FEL, then execution will eventually migrate to the
non-secure state. Any non-secure interrupts will be handled as described
in the routing model where <strong>CSS=1 and TEL3=0</strong>. Secure-EL1 interrupts
will be routed to EL3 (as per the routing model where <strong>CSS=1 and
TEL3=1</strong>) where the SPD service will hand them to the SP. This is defined
as the <strong>synchronous mode</strong> of handling interrupts.</p></li>
</ol>
<p>The interrupt handling framework implemented by the SP should support one or
both these interrupt handling models depending upon the chosen routing model.</p>
<p>The following list briefly describes how the choice of a valid routing model
(see <a class="reference internal" href="#valid-routing-models">Valid routing models</a>) effects the implementation of the Secure-EL1
IHF. If the choice of the interrupt routing model is not known to the SPD
service at compile time, then the SP should pass this information to the SPD
service at runtime during its initialisation phase.</p>
<p>As mentioned earlier, an Arm GICv2 system is considered and it is assumed that
the FIQ signal is used to generate Secure-EL1 interrupts and the IRQ signal
is used to generate non-secure interrupts in either security state.</p>
<div class="section" id="secure-payload-ihf-design-w-r-t-secure-el1-interrupts">
<h4><span class="section-number">5.4.4.1. </span>Secure payload IHF design w.r.t secure-EL1 interrupts<a class="headerlink" href="#secure-payload-ihf-design-w-r-t-secure-el1-interrupts" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p><strong>CSS=0, TEL3=0</strong>. If <code class="docutils literal notranslate"><span class="pre">PSTATE.F=0</span></code>, Secure-EL1 interrupts will be
triggered at one of the Secure-EL1 FIQ exception vectors. The Secure-EL1
IHF should implement support for handling FIQ interrupts asynchronously.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">PSTATE.F=1</span></code> then Secure-EL1 interrupts will be handled as per the
synchronous interrupt handling model. The SP could implement this scenario
by exporting a separate entrypoint for Secure-EL1 interrupts to the SPD
service during the registration phase. The SPD service would also need to
know the state of the system, general purpose and the <code class="docutils literal notranslate"><span class="pre">PSTATE</span></code> registers
in which it should arrange to return execution to the SP. The SP should
provide this information in an implementation defined way during the
registration phase if it is not known to the SPD service at build time.</p>
</li>
<li><p><strong>CSS=1, TEL3=1</strong>. Interrupts are routed to EL3 when execution is in
non-secure state. They should be handled through the synchronous interrupt
handling model as described in 1. above.</p></li>
<li><p><strong>CSS=0, TEL3=1</strong>. Secure-EL1 interrupts are routed to EL3 when execution
is in secure state. They will not be visible to the SP. The <code class="docutils literal notranslate"><span class="pre">PSTATE.F</span></code> bit
in Secure-EL1/Secure-EL0 will not mask FIQs. The EL3 runtime firmware will
call the handler registered by the SPD service for Secure-EL1 interrupts.
Secure-EL1 IHF should then handle all Secure-EL1 interrupt through the
synchronous interrupt handling model described in 1. above.</p></li>
</ol>
</div>
<div class="section" id="secure-payload-ihf-design-w-r-t-non-secure-interrupts">
<h4><span class="section-number">5.4.4.2. </span>Secure payload IHF design w.r.t non-secure interrupts<a class="headerlink" href="#secure-payload-ihf-design-w-r-t-non-secure-interrupts" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p><strong>CSS=0, TEL3=0</strong>. If <code class="docutils literal notranslate"><span class="pre">PSTATE.I=0</span></code>, non-secure interrupts will be
triggered at one of the Secure-EL1 IRQ exception vectors . The Secure-EL1
IHF should co-ordinate with the SPD service to transfer execution to the
non-secure state where the interrupt should be handled e.g the SP could
allocate a function identifier to issue a SMC64 or SMC32 to the SPD
service which indicates that the SP execution has been preempted by a
non-secure interrupt. If this function identifier is not known to the SPD
service at compile time then the SP could provide it during the
registration phase.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">PSTATE.I=1</span></code> then the non-secure interrupt will pend until execution
resumes in the non-secure state.</p>
</li>
<li><p><strong>CSS=0, TEL3=1</strong>. Non-secure interrupts are routed to EL3. They will not
be visible to the SP. The <code class="docutils literal notranslate"><span class="pre">PSTATE.I</span></code> bit in Secure-EL1/Secure-EL0 will
have not effect. The SPD service should register a non-secure interrupt
handler which should save the SP state correctly and resume execution in
the non-secure state where the interrupt will be handled. The Secure-EL1
IHF does not need to take any action.</p></li>
<li><p><strong>CSS=1, TEL3=0</strong>. Non-secure interrupts are handled in the FEL in
non-secure state (EL1/EL2) and are not visible to the SP. This routing
model does not affect the SP behavior.</p></li>
</ol>
<p>A Secure Payload must also ensure that all Secure-EL1 interrupts are correctly
configured at the interrupt controller by the platform port of the EL3 runtime
firmware. It should configure any additional Secure-EL1 interrupts which the EL3
runtime firmware is not aware of through its platform port.</p>
</div>
</div>
<div class="section" id="test-secure-payload-behavior">
<h3><span class="section-number">5.4.5. </span>Test secure payload behavior<a class="headerlink" href="#test-secure-payload-behavior" title="Permalink to this headline">¶</a></h3>
<p>The routing model for Secure-EL1 and non-secure interrupts chosen by the TSP is
described in Section <a class="reference external" href="#spd-int-registration">Secure Payload Dispatcher</a>. It is known to the TSPD
service at build time.</p>
<p>The TSP implements an entrypoint (<code class="docutils literal notranslate"><span class="pre">tsp_sel1_intr_entry()</span></code>) for handling Secure-EL1
interrupts taken in non-secure state and routed through the TSPD service
(synchronous handling model). It passes the reference to this entrypoint via
<code class="docutils literal notranslate"><span class="pre">tsp_vectors</span></code> to the TSPD service.</p>
<p>The TSP also replaces the default exception vector table referenced through the
<code class="docutils literal notranslate"><span class="pre">early_exceptions</span></code> variable, with a vector table capable of handling FIQ and IRQ
exceptions taken at the same (Secure-EL1) exception level. This table is
referenced through the <code class="docutils literal notranslate"><span class="pre">tsp_exceptions</span></code> variable and programmed into the
VBAR_EL1. It caters for the asynchronous handling model.</p>
<p>The TSP also programs the Secure Physical Timer in the Arm Generic Timer block
to raise a periodic interrupt (every half a second) for the purpose of testing
interrupt management across all the software components listed in <a class="reference internal" href="#software-components">Software
components</a>.</p>
</div>
</div>
<div class="section" id="interrupt-handling">
<h2><span class="section-number">5.5. </span>Interrupt handling<a class="headerlink" href="#interrupt-handling" title="Permalink to this headline">¶</a></h2>
<p>This section describes in detail the role of each software component (see
Section <a class="reference internal" href="#software-components">Software components</a>) in handling an interrupt of a particular type.</p>
<div class="section" id="id4">
<h3><span class="section-number">5.5.1. </span>EL3 runtime firmware<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>The EL3 runtime firmware populates the IRQ and FIQ exception vectors referenced
by the <code class="docutils literal notranslate"><span class="pre">runtime_exceptions</span></code> variable as follows.</p>
<ol class="arabic simple">
<li><p>IRQ and FIQ exceptions taken from the current exception level with
<code class="docutils literal notranslate"><span class="pre">SP_EL0</span></code> or <code class="docutils literal notranslate"><span class="pre">SP_EL3</span></code> are reported as irrecoverable error conditions. As
mentioned earlier, EL3 runtime firmware always executes with the
<code class="docutils literal notranslate"><span class="pre">PSTATE.I</span></code> and <code class="docutils literal notranslate"><span class="pre">PSTATE.F</span></code> bits set.</p></li>
<li><p>The following text describes how the IRQ and FIQ exceptions taken from a
lower exception level using AArch64 or AArch32 are handled.</p></li>
</ol>
<p>When an interrupt is generated, the vector for each interrupt type is
responsible for:</p>
<ol class="arabic">
<li><p>Saving the entire general purpose register context (x0-x30) immediately
upon exception entry. The registers are saved in the per-cpu <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code>
data structure referenced by the <code class="docutils literal notranslate"><span class="pre">SP_EL3</span></code>register.</p></li>
<li><p>Saving the <code class="docutils literal notranslate"><span class="pre">ELR_EL3</span></code>, <code class="docutils literal notranslate"><span class="pre">SP_EL0</span></code> and <code class="docutils literal notranslate"><span class="pre">SPSR_EL3</span></code> system registers in the
per-cpu <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> data structure referenced by the <code class="docutils literal notranslate"><span class="pre">SP_EL3</span></code> register.</p></li>
<li><p>Switching to the C runtime stack by restoring the <code class="docutils literal notranslate"><span class="pre">CTX_RUNTIME_SP</span></code> value
from the per-cpu <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> data structure in <code class="docutils literal notranslate"><span class="pre">SP_EL0</span></code> and
executing the <code class="docutils literal notranslate"><span class="pre">msr</span> <span class="pre">spsel,</span> <span class="pre">#0</span></code> instruction.</p></li>
<li><p>Determining the type of interrupt. Secure-EL1 interrupts will be signaled
at the FIQ vector. Non-secure interrupts will be signaled at the IRQ
vector. The platform should implement the following API to determine the
type of the pending interrupt.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">uint32_t</span> <span class="nf">plat_ic_get_interrupt_type</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
</pre></div>
</div>
<p>It should return either <code class="docutils literal notranslate"><span class="pre">INTR_TYPE_S_EL1</span></code> or <code class="docutils literal notranslate"><span class="pre">INTR_TYPE_NS</span></code>.</p>
</li>
<li><p>Determining the handler for the type of interrupt that has been generated.
The following API has been added for this purpose.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">interrupt_type_handler</span> <span class="nf">get_interrupt_type_handler</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">interrupt_type</span><span class="p">);</span>
</pre></div>
</div>
<p>It returns the reference to the registered handler for this interrupt
type. The <code class="docutils literal notranslate"><span class="pre">handler</span></code> is retrieved from the <code class="docutils literal notranslate"><span class="pre">intr_type_desc_t</span></code> structure as
described in Section 2. <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is returned if no handler has been
registered for this type of interrupt. This scenario is reported as an
irrecoverable error condition.</p>
</li>
<li><p>Calling the registered handler function for the interrupt type generated.
The <code class="docutils literal notranslate"><span class="pre">id</span></code> parameter is set to <code class="docutils literal notranslate"><span class="pre">INTR_ID_UNAVAILABLE</span></code> currently. The id along
with the current security state and a reference to the <code class="docutils literal notranslate"><span class="pre">cpu_context_t</span></code>
structure for the current security state are passed to the handler function
as its arguments.</p>
<p>The handler function returns a reference to the per-cpu <code class="docutils literal notranslate"><span class="pre">cpu_context_t</span></code>
structure for the target security state.</p>
</li>
<li><p>Calling <code class="docutils literal notranslate"><span class="pre">el3_exit()</span></code> to return from EL3 into a lower exception level in
the security state determined by the handler routine. The <code class="docutils literal notranslate"><span class="pre">el3_exit()</span></code>
function is responsible for restoring the register context from the
<code class="docutils literal notranslate"><span class="pre">cpu_context_t</span></code> data structure for the target security state.</p></li>
</ol>
</div>
<div class="section" id="id5">
<h3><span class="section-number">5.5.2. </span>Secure payload dispatcher<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="section" id="interrupt-entry">
<h4><span class="section-number">5.5.2.1. </span>Interrupt entry<a class="headerlink" href="#interrupt-entry" title="Permalink to this headline">¶</a></h4>
<p>The SPD service begins handling an interrupt when the EL3 runtime firmware calls
the handler function for that type of interrupt. The SPD service is responsible
for the following:</p>
<ol class="arabic">
<li><p>Validating the interrupt. This involves ensuring that the interrupt was
generated according to the interrupt routing model specified by the SPD
service during registration. It should use the security state of the
exception level (passed in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter of the handler) where
the interrupt was taken from to determine this. If the interrupt is not
recognised then the handler should treat it as an irrecoverable error
condition.</p>
<p>An SPD service can register a handler for Secure-EL1 and/or Non-secure
interrupts. A non-secure interrupt should never be routed to EL3 from
from non-secure state. Also if a routing model is chosen where Secure-EL1
interrupts are routed to S-EL1 when execution is in Secure state, then a
S-EL1 interrupt should never be routed to EL3 from secure state. The handler
could use the security state flag to check this.</p>
</li>
<li><p>Determining whether a context switch is required. This depends upon the
routing model and interrupt type. For non secure and S-EL1 interrupt,
if the security state of the execution context where the interrupt was
generated is not the same as the security state required for handling
the interrupt, a context switch is required. The following 2 cases
require a context switch from secure to non-secure or vice-versa:</p>
<ol class="arabic simple">
<li><p>A Secure-EL1 interrupt taken from the non-secure state should be
routed to the Secure Payload.</p></li>
<li><p>A non-secure interrupt taken from the secure state should be routed
to the last known non-secure exception level.</p></li>
</ol>
<p>The SPD service must save the system register context of the current
security state. It must then restore the system register context of the
target security state. It should use the <code class="docutils literal notranslate"><span class="pre">cm_set_next_eret_context()</span></code> API
to ensure that the next <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> to be restored is of the target
security state.</p>
<p>If the target state is secure then execution should be handed to the SP as
per the synchronous interrupt handling model it implements. A Secure-EL1
interrupt can be routed to EL3 while execution is in the SP. This implies
that SP execution can be preempted while handling an interrupt by a
another higher priority Secure-EL1 interrupt or a EL3 interrupt. The SPD
service should be able to handle this preemption or manage secure interrupt
priorities before handing control to the SP.</p>
</li>
<li><p>Setting the return value of the handler to the per-cpu <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> if
the interrupt has been successfully validated and ready to be handled at a
lower exception level.</p></li>
</ol>
<p>The routing model allows non-secure interrupts to interrupt Secure-EL1 when in
secure state if it has been configured to do so. The SPD service and the SP
should implement a mechanism for routing these interrupts to the last known
exception level in the non-secure state. The former should save the SP context,
restore the non-secure context and arrange for entry into the non-secure state
so that the interrupt can be handled.</p>
</div>
<div class="section" id="interrupt-exit">
<h4><span class="section-number">5.5.2.2. </span>Interrupt exit<a class="headerlink" href="#interrupt-exit" title="Permalink to this headline">¶</a></h4>
<p>When the Secure Payload has finished handling a Secure-EL1 interrupt, it could
return control back to the SPD service through a SMC32 or SMC64. The SPD service
should handle this secure monitor call so that execution resumes in the
exception level and the security state from where the Secure-EL1 interrupt was
originally taken.</p>
</div>
<div class="section" id="test-secure-payload-dispatcher-secure-el1-interrupt-handling">
<h4><span class="section-number">5.5.2.3. </span>Test secure payload dispatcher Secure-EL1 interrupt handling<a class="headerlink" href="#test-secure-payload-dispatcher-secure-el1-interrupt-handling" title="Permalink to this headline">¶</a></h4>
<p>The example TSPD service registers a handler for Secure-EL1 interrupts taken
from the non-secure state. During execution in S-EL1, the TSPD expects that the
Secure-EL1 interrupts are handled in S-EL1 by TSP. Its handler
<code class="docutils literal notranslate"><span class="pre">tspd_secure_el1_interrupt_handler()</span></code> expects only to be invoked for Secure-EL1
originating from the non-secure state. It takes the following actions upon being
invoked.</p>
<ol class="arabic simple">
<li><p>It uses the security state provided in the <code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter to ensure
that the secure interrupt originated from the non-secure state. It asserts
if this is not the case.</p></li>
<li><p>It saves the system register context for the non-secure state by calling
<code class="docutils literal notranslate"><span class="pre">cm_el1_sysregs_context_save(NON_SECURE);</span></code>.</p></li>
<li><p>It sets the <code class="docutils literal notranslate"><span class="pre">ELR_EL3</span></code> system register to <code class="docutils literal notranslate"><span class="pre">tsp_sel1_intr_entry</span></code> and sets the
<code class="docutils literal notranslate"><span class="pre">SPSR_EL3.DAIF</span></code> bits in the secure CPU context. It sets <code class="docutils literal notranslate"><span class="pre">x0</span></code> to
<code class="docutils literal notranslate"><span class="pre">TSP_HANDLE_SEL1_INTR_AND_RETURN</span></code>. If the TSP was preempted earlier by a non
secure interrupt during <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC processing, save the registers that
will be trashed, which is the <code class="docutils literal notranslate"><span class="pre">ELR_EL3</span></code> and <code class="docutils literal notranslate"><span class="pre">SPSR_EL3</span></code>, in order to be able
to re-enter TSP for Secure-EL1 interrupt processing. It does not need to
save any other secure context since the TSP is expected to preserve it
(see section <a class="reference internal" href="#test-secure-payload-dispatcher-behavior">Test secure payload dispatcher behavior</a>).</p></li>
<li><p>It restores the system register context for the secure state by calling
<code class="docutils literal notranslate"><span class="pre">cm_el1_sysregs_context_restore(SECURE);</span></code>.</p></li>
<li><p>It ensures that the secure CPU context is used to program the next
exception return from EL3 by calling <code class="docutils literal notranslate"><span class="pre">cm_set_next_eret_context(SECURE);</span></code>.</p></li>
<li><p>It returns the per-cpu <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> to indicate that the interrupt can
now be handled by the SP. <code class="docutils literal notranslate"><span class="pre">x1</span></code> is written with the value of <code class="docutils literal notranslate"><span class="pre">elr_el3</span></code>
register for the non-secure state. This information is used by the SP for
debugging purposes.</p></li>
</ol>
<p>The figure below describes how the interrupt handling is implemented by the TSPD
when a Secure-EL1 interrupt is generated when execution is in the non-secure
state.</p>
<p><img alt="Image 1" src="../_images/sec-int-handling.png" /></p>
<p>The TSP issues an SMC with <code class="docutils literal notranslate"><span class="pre">TSP_HANDLED_S_EL1_INTR</span></code> as the function identifier to
signal completion of interrupt handling.</p>
<p>The TSPD service takes the following actions in <code class="docutils literal notranslate"><span class="pre">tspd_smc_handler()</span></code> function
upon receiving an SMC with <code class="docutils literal notranslate"><span class="pre">TSP_HANDLED_S_EL1_INTR</span></code> as the function identifier:</p>
<ol class="arabic simple">
<li><p>It ensures that the call originated from the secure state otherwise
execution returns to the non-secure state with <code class="docutils literal notranslate"><span class="pre">SMC_UNK</span></code> in <code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p></li>
<li><p>It restores the saved <code class="docutils literal notranslate"><span class="pre">ELR_EL3</span></code> and <code class="docutils literal notranslate"><span class="pre">SPSR_EL3</span></code> system registers back to
the secure CPU context (see step 3 above) in case the TSP had been preempted
by a non secure interrupt earlier.</p></li>
<li><p>It restores the system register context for the non-secure state by
calling <code class="docutils literal notranslate"><span class="pre">cm_el1_sysregs_context_restore(NON_SECURE)</span></code>.</p></li>
<li><p>It ensures that the non-secure CPU context is used to program the next
exception return from EL3 by calling <code class="docutils literal notranslate"><span class="pre">cm_set_next_eret_context(NON_SECURE)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tspd_smc_handler()</span></code> returns a reference to the non-secure <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code>
as the return value.</p></li>
</ol>
</div>
<div class="section" id="test-secure-payload-dispatcher-non-secure-interrupt-handling">
<h4><span class="section-number">5.5.2.4. </span>Test secure payload dispatcher non-secure interrupt handling<a class="headerlink" href="#test-secure-payload-dispatcher-non-secure-interrupt-handling" title="Permalink to this headline">¶</a></h4>
<p>The TSP in Secure-EL1 can be preempted by a non-secure interrupt during
<code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC processing or by a higher priority EL3 interrupt during
Secure-EL1 interrupt processing. When <code class="docutils literal notranslate"><span class="pre">EL3_EXCEPTION_HANDLING</span></code> is <code class="docutils literal notranslate"><span class="pre">0</span></code>, only
non-secure interrupts can cause preemption of TSP since there are no EL3
interrupts in the system. With <code class="docutils literal notranslate"><span class="pre">EL3_EXCEPTION_HANDLING=1</span></code> however, any EL3
interrupt may preempt Secure execution.</p>
<p>It should be noted that while TSP is preempted, the TSPD only allows entry into
the TSP either for Secure-EL1 interrupt handling or for resuming the preempted
<code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC in response to the <code class="docutils literal notranslate"><span class="pre">TSP_FID_RESUME</span></code> SMC from the normal world.
(See Section <a class="reference internal" href="#implication-of-preempted-smc-on-non-secure-software">Implication of preempted SMC on Non-Secure Software</a>).</p>
<p>The non-secure interrupt triggered in Secure-EL1 during <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC
processing can be routed to either EL3 or Secure-EL1 and is controlled by build
option <code class="docutils literal notranslate"><span class="pre">TSP_NS_INTR_ASYNC_PREEMPT</span></code> (see Section <a class="reference internal" href="#test-secure-payload-dispatcher-behavior">Test secure payload
dispatcher behavior</a>). If the build option is set, the TSPD will set the
routing model for the non-secure interrupt to be routed to EL3 from secure state
i.e. <strong>TEL3=1, CSS=0</strong> and registers <code class="docutils literal notranslate"><span class="pre">tspd_ns_interrupt_handler()</span></code> as the
non-secure interrupt handler. The <code class="docutils literal notranslate"><span class="pre">tspd_ns_interrupt_handler()</span></code> on being
invoked ensures that the interrupt originated from the secure state and disables
routing of non-secure interrupts from secure state to EL3. This is to prevent
further preemption (by a non-secure interrupt) when TSP is reentered for
handling Secure-EL1 interrupts that triggered while execution was in the normal
world. The <code class="docutils literal notranslate"><span class="pre">tspd_ns_interrupt_handler()</span></code> then invokes
<code class="docutils literal notranslate"><span class="pre">tspd_handle_sp_preemption()</span></code> for further handling.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">TSP_NS_INTR_ASYNC_PREEMPT</span></code> build option is zero (default), the default
routing model for non-secure interrupt in secure state is in effect
i.e. <strong>TEL3=0, CSS=0</strong>. During <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC processing, the IRQ
exceptions are unmasked i.e. <code class="docutils literal notranslate"><span class="pre">PSTATE.I=0</span></code>, and a non-secure interrupt will
trigger at Secure-EL1 IRQ exception vector. The TSP saves the general purpose
register context and issues an SMC with <code class="docutils literal notranslate"><span class="pre">TSP_PREEMPTED</span></code> as the function
identifier to signal preemption of TSP. The TSPD SMC handler,
<code class="docutils literal notranslate"><span class="pre">tspd_smc_handler()</span></code>, ensures that the SMC call originated from the
secure state otherwise execution returns to the non-secure state with
<code class="docutils literal notranslate"><span class="pre">SMC_UNK</span></code> in <code class="docutils literal notranslate"><span class="pre">x0</span></code>. It then invokes <code class="docutils literal notranslate"><span class="pre">tspd_handle_sp_preemption()</span></code> for
further handling.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">tspd_handle_sp_preemption()</span></code> takes the following actions upon being
invoked:</p>
<ol class="arabic simple">
<li><p>It saves the system register context for the secure state by calling
<code class="docutils literal notranslate"><span class="pre">cm_el1_sysregs_context_save(SECURE)</span></code>.</p></li>
<li><p>It restores the system register context for the non-secure state by
calling <code class="docutils literal notranslate"><span class="pre">cm_el1_sysregs_context_restore(NON_SECURE)</span></code>.</p></li>
<li><p>It ensures that the non-secure CPU context is used to program the next
exception return from EL3 by calling <code class="docutils literal notranslate"><span class="pre">cm_set_next_eret_context(NON_SECURE)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SMC_PREEMPTED</span></code> is set in x0 and return to non secure state after
restoring non secure context.</p></li>
</ol>
<p>The Normal World is expected to resume the TSP after the <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC
preemption by issuing an SMC with <code class="docutils literal notranslate"><span class="pre">TSP_FID_RESUME</span></code> as the function identifier
(see section <a class="reference internal" href="#implication-of-preempted-smc-on-non-secure-software">Implication of preempted SMC on Non-Secure Software</a>).  The TSPD
service takes the following actions in <code class="docutils literal notranslate"><span class="pre">tspd_smc_handler()</span></code> function upon
receiving this SMC:</p>
<ol class="arabic simple">
<li><p>It ensures that the call originated from the non secure state. An
assertion is raised otherwise.</p></li>
<li><p>Checks whether the TSP needs a resume i.e check if it was preempted. It
then saves the system register context for the non-secure state by calling
<code class="docutils literal notranslate"><span class="pre">cm_el1_sysregs_context_save(NON_SECURE)</span></code>.</p></li>
<li><p>Restores the secure context by calling
<code class="docutils literal notranslate"><span class="pre">cm_el1_sysregs_context_restore(SECURE)</span></code></p></li>
<li><p>It ensures that the secure CPU context is used to program the next
exception return from EL3 by calling <code class="docutils literal notranslate"><span class="pre">cm_set_next_eret_context(SECURE)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tspd_smc_handler()</span></code> returns a reference to the secure <code class="docutils literal notranslate"><span class="pre">cpu_context</span></code> as the
return value.</p></li>
</ol>
<p>The figure below describes how the TSP/TSPD handle a non-secure interrupt when
it is generated during execution in the TSP with <code class="docutils literal notranslate"><span class="pre">PSTATE.I</span></code> = 0 when the
<code class="docutils literal notranslate"><span class="pre">TSP_NS_INTR_ASYNC_PREEMPT</span></code> build flag is 0.</p>
<p><img alt="Image 2" src="../_images/non-sec-int-handling.png" /></p>
</div>
</div>
<div class="section" id="secure-payload-interrupt-handling">
<span id="sp-synchronous-int"></span><h3><span class="section-number">5.5.3. </span>Secure payload interrupt handling<a class="headerlink" href="#secure-payload-interrupt-handling" title="Permalink to this headline">¶</a></h3>
<p>The SP should implement one or both of the synchronous and asynchronous
interrupt handling models depending upon the interrupt routing model it has
chosen (as described in section <a class="reference internal" href="#sp-int-registration"><span class="std std-ref">Secure Payload</span></a>).</p>
<p>In the synchronous model, it should begin handling a Secure-EL1 interrupt after
receiving control from the SPD service at an entrypoint agreed upon during build
time or during the registration phase. Before handling the interrupt, the SP
should save any Secure-EL1 system register context which is needed for resuming
normal execution in the SP later e.g. <code class="docutils literal notranslate"><span class="pre">SPSR_EL1</span></code>, <code class="docutils literal notranslate"><span class="pre">ELR_EL1</span></code>. After handling
the interrupt, the SP could return control back to the exception level and
security state where the interrupt was originally taken from. The SP should use
an SMC32 or SMC64 to ask the SPD service to do this.</p>
<p>In the asynchronous model, the Secure Payload is responsible for handling
non-secure and Secure-EL1 interrupts at the IRQ and FIQ vectors in its exception
vector table when <code class="docutils literal notranslate"><span class="pre">PSTATE.I</span></code> and <code class="docutils literal notranslate"><span class="pre">PSTATE.F</span></code> bits are 0. As described earlier,
when a non-secure interrupt is generated, the SP should coordinate with the SPD
service to pass control back to the non-secure state in the last known exception
level. This will allow the non-secure interrupt to be handled in the non-secure
state.</p>
<div class="section" id="id6">
<h4><span class="section-number">5.5.3.1. </span>Test secure payload behavior<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>The TSPD hands control of a Secure-EL1 interrupt to the TSP at the
<code class="docutils literal notranslate"><span class="pre">tsp_sel1_intr_entry()</span></code>. The TSP handles the interrupt while ensuring that the
handover agreement described in Section <a class="reference internal" href="#test-secure-payload-dispatcher-behavior">Test secure payload dispatcher
behavior</a> is maintained. It updates some statistics by calling
<code class="docutils literal notranslate"><span class="pre">tsp_update_sync_sel1_intr_stats()</span></code>. It then calls
<code class="docutils literal notranslate"><span class="pre">tsp_common_int_handler()</span></code> which.</p>
<ol class="arabic simple">
<li><p>Checks whether the interrupt is the secure physical timer interrupt. It
uses the platform API <code class="docutils literal notranslate"><span class="pre">plat_ic_get_pending_interrupt_id()</span></code> to get the
interrupt number. If it is not the secure physical timer interrupt, then
that means that a higher priority interrupt has preempted it. Invoke
<code class="docutils literal notranslate"><span class="pre">tsp_handle_preemption()</span></code> to handover control back to EL3 by issuing
an SMC with <code class="docutils literal notranslate"><span class="pre">TSP_PREEMPTED</span></code> as the function identifier.</p></li>
<li><p>Handles the secure timer interrupt interrupt by acknowledging it using the
<code class="docutils literal notranslate"><span class="pre">plat_ic_acknowledge_interrupt()</span></code> platform API, calling
<code class="docutils literal notranslate"><span class="pre">tsp_generic_timer_handler()</span></code> to reprogram the secure physical generic
timer and calling the <code class="docutils literal notranslate"><span class="pre">plat_ic_end_of_interrupt()</span></code> platform API to signal
end of interrupt processing.</p></li>
</ol>
<p>The TSP passes control back to the TSPD by issuing an SMC64 with
<code class="docutils literal notranslate"><span class="pre">TSP_HANDLED_S_EL1_INTR</span></code> as the function identifier.</p>
<p>The TSP handles interrupts under the asynchronous model as follows.</p>
<ol class="arabic simple">
<li><p>Secure-EL1 interrupts are handled by calling the <code class="docutils literal notranslate"><span class="pre">tsp_common_int_handler()</span></code>
function. The function has been described above.</p></li>
<li><p>Non-secure interrupts are handled by calling the <code class="docutils literal notranslate"><span class="pre">tsp_common_int_handler()</span></code>
function which ends up invoking <code class="docutils literal notranslate"><span class="pre">tsp_handle_preemption()</span></code> and issuing an
SMC64 with <code class="docutils literal notranslate"><span class="pre">TSP_PREEMPTED</span></code> as the function identifier. Execution resumes at
the instruction that follows this SMC instruction when the TSPD hands control
to the TSP in response to an SMC with <code class="docutils literal notranslate"><span class="pre">TSP_FID_RESUME</span></code> as the function
identifier from the non-secure state (see section <a class="reference internal" href="#test-secure-payload-dispatcher-non-secure-interrupt-handling">Test secure payload
dispatcher non-secure interrupt handling</a>).</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="other-considerations">
<h2><span class="section-number">5.6. </span>Other considerations<a class="headerlink" href="#other-considerations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="implication-of-preempted-smc-on-non-secure-software">
<h3><span class="section-number">5.6.1. </span>Implication of preempted SMC on Non-Secure Software<a class="headerlink" href="#implication-of-preempted-smc-on-non-secure-software" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC call to Secure payload can be preempted by a non-secure
interrupt and the execution can return to the non-secure world for handling
the interrupt (For details on <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC refer <a class="reference external" href="https://developer.arm.com/docs/den0028/latest">SMC calling convention</a>).
In this case, the SMC call has not completed its execution and the execution
must return back to the secure payload to resume the preempted SMC call.
This can be achieved by issuing an SMC call which instructs to resume the
preempted SMC.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">fast</span></code> SMC cannot be preempted and hence this case will not happen for
a fast SMC call.</p>
<p>In the Test Secure Payload implementation, <code class="docutils literal notranslate"><span class="pre">TSP_FID_RESUME</span></code> is designated
as the resume SMC FID. It is important to note that <code class="docutils literal notranslate"><span class="pre">TSP_FID_RESUME</span></code> is a
<code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC which means it too can be be preempted. The typical non
secure software sequence for issuing a <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC would look like this,
assuming <code class="docutils literal notranslate"><span class="pre">P.STATE.I=0</span></code> in the non secure state :</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">rc</span><span class="p">;</span>
<span class="n">rc</span> <span class="o">=</span> <span class="n">smc</span><span class="p">(</span><span class="n">TSP_YIELD_SMC_FID</span><span class="p">,</span> <span class="p">...);</span>     <span class="cm">/* Issue a Yielding SMC call */</span>
<span class="cm">/* The pending non-secure interrupt is handled by the interrupt handler</span>
<span class="cm">   and returns back here. */</span>
<span class="k">while</span> <span class="p">(</span><span class="n">rc</span> <span class="o">==</span> <span class="n">SMC_PREEMPTED</span><span class="p">)</span> <span class="p">{</span>       <span class="cm">/* Check if the SMC call is preempted */</span>
    <span class="n">rc</span> <span class="o">=</span> <span class="n">smc</span><span class="p">(</span><span class="n">TSP_FID_RESUME</span><span class="p">);</span>       <span class="cm">/* Issue resume SMC call */</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">TSP_YIELD_SMC_FID</span></code> is any <code class="docutils literal notranslate"><span class="pre">yielding</span></code> SMC function identifier and the smc()
function invokes a SMC call with the required arguments. The pending non-secure
interrupt causes an IRQ exception and the IRQ handler registered at the
exception vector handles the non-secure interrupt and returns. The return value
from the SMC call is tested for <code class="docutils literal notranslate"><span class="pre">SMC_PREEMPTED</span></code> to check whether it is
preempted. If it is, then the resume SMC call <code class="docutils literal notranslate"><span class="pre">TSP_FID_RESUME</span></code> is issued. The
return value of the SMC call is tested again to check if it is preempted.
This is done in a loop till the SMC call succeeds or fails. If a <code class="docutils literal notranslate"><span class="pre">yielding</span></code>
SMC is preempted, until it is resumed using <code class="docutils literal notranslate"><span class="pre">TSP_FID_RESUME</span></code> SMC and
completed, the current TSPD prevents any other SMC call from re-entering
TSP by returning <code class="docutils literal notranslate"><span class="pre">SMC_UNK</span></code> error.</p>
<hr class="docutils" />
<p><em>Copyright (c) 2014-2020, Arm Limited and Contributors. All rights reserved.</em></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="psci-pd-tree.html" class="btn btn-neutral float-right" title="6. PSCI Power Domain Tree Structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="firmware-design.html" class="btn btn-neutral float-left" title="4. Firmware Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>