<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="831px" preserveAspectRatio="none" style="width:1342px;height:831px;" version="1.1" viewBox="0 0 1342 831" width="1342px" zoomAndPan="magnify"><defs><filter height="300%" id="f1klycp8oqobvc" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="816.6484" style="stroke: #A80036; stroke-width: 1.0;" width="213" x="4" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="42.5" y="16.0669">BL2 common code</text><rect fill="#DDDDDD" height="816.6484" style="stroke: #A80036; stroke-width: 1.0;" width="593" x="219" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="429" y="16.0669">platform common code</text><rect fill="#ADD8E6" height="816.6484" style="stroke: #A80036; stroke-width: 1.0;" width="456" x="814" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="972.5" y="16.0669">arm platform code</text><rect fill="#FFFFFF" filter="url(#f1klycp8oqobvc)" height="296.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="244" y="317.4922"/><rect fill="#FFFFFF" filter="url(#f1klycp8oqobvc)" height="398.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="872.5" y="283.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="66" x2="66" y1="58.4297" y2="782.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="173" x2="173" y1="58.4297" y2="782.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="249" x2="249" y1="58.4297" y2="782.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="569" x2="569" y1="58.4297" y2="782.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="727" x2="727" y1="58.4297" y2="782.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="877" x2="877" y1="58.4297" y2="782.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1090" x2="1090" y1="58.4297" y2="782.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1214" x2="1214" y1="58.4297" y2="782.3516"/><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="8" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="15" y="43.1279">bl2_entrypoint</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="8" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="15" y="801.3467">bl2_entrypoint</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="134" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="141" y="43.1279">bl2_main</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="134" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="141" y="801.3467">bl2_main</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="223" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="230" y="43.1279">fconf</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="223" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="230" y="801.3467">fconf</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="501" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="508" y="43.1279">fconf_tbbr_getter</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="501" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="508" y="801.3467">fconf_tbbr_getter</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="647" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="654" y="43.1279">fconf_dyn_cfg_getter</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="647" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="143" x="654" y="801.3467">fconf_dyn_cfg_getter</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="818" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="825" y="43.1279">arm_bl2_setup</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="818" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="825" y="801.3467">arm_bl2_setup</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="1029" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="1036" y="43.1279">arm_io_storage</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="1029" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="105" x="1036" y="801.3467">arm_io_storage</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="1162" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="1169" y="43.1279">arm_fconf_io</text><rect fill="#FEFECE" filter="url(#f1klycp8oqobvc)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="1162" y="781.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="1169" y="801.3467">arm_fconf_io</text><rect fill="#FFFFFF" filter="url(#f1klycp8oqobvc)" height="296.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="244" y="317.4922"/><rect fill="#FFFFFF" filter="url(#f1klycp8oqobvc)" height="398.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="872.5" y="283.2266"/><rect fill="#EEEEEE" filter="url(#f1klycp8oqobvc)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1327" x="3" y="88.9961"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1330" y1="88.9961" y2="88.9961"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1330" y1="91.9961" y2="91.9961"/><rect fill="#EEEEEE" filter="url(#f1klycp8oqobvc)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="89" x="622" y="78.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="628" y="94.4966">bl2 setup</text><polygon fill="#A80036" points="161.5,128.5625,171.5,132.5625,161.5,136.5625,165.5,132.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="66" x2="167.5" y1="132.5625" y2="132.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="73" y="127.6294">bl2_setup()</text><polygon fill="#A80036" points="865.5,172.6953,875.5,176.6953,865.5,180.6953,869.5,176.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="173.5" x2="871.5" y1="176.6953" y2="176.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="180.5" y="156.7622">bl2_early_platform_setup2(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="216.5" y="171.895">arg0, arg1, arg2, arg3)</text><polygon fill="#FBFB77" filter="url(#f1klycp8oqobvc)" points="801,189.9609,801,229.9609,950,229.9609,950,199.9609,940,189.9609,801,189.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="940" x2="940" y1="189.9609" y2="199.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="950" x2="940" y1="199.9609" y2="199.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="807" y="207.0278">arg0 = fw_config</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="807" y="222.1606">arg1 = mem_layout</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="877.5" x2="924.5" y1="270.4922" y2="270.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="924.5" x2="924.5" y1="270.4922" y2="283.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="883.5" x2="924.5" y1="283.4922" y2="283.4922"/><polygon fill="#A80036" points="893.5,279.4922,883.5,283.4922,893.5,287.4922,889.5,283.4922" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="889.5" y="250.2935">arm_bl2_early_platform_setup(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="925.5" y="265.4263">fw_config, mem_layout)</text><polygon fill="#A80036" points="265,313.4922,255,317.4922,265,321.4922,261,317.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="259" x2="871.5" y1="317.4922" y2="317.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="271" y="312.5591">fconf_populate("FW_CONFIG", fw_config)</text><polygon fill="#A80036" points="715.5,342.625,725.5,346.625,715.5,350.625,719.5,346.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="254" x2="721.5" y1="346.625" y2="346.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="228" x="261" y="341.6919">populate_dtb_registry(uintptr_t dtb)</text><polygon fill="#FBFB77" filter="url(#f1klycp8oqobvc)" points="596,359.7578,596,384.7578,854,384.7578,854,369.7578,844,359.7578,596,359.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="844" x2="844" y1="359.7578" y2="369.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="854" x2="844" y1="369.7578" y2="369.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="602" y="376.8247">read dtb_registry properties from dtb</text><polygon fill="#A80036" points="860.5,395.8906,870.5,399.8906,860.5,403.8906,864.5,399.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="727.5" x2="866.5" y1="399.8906" y2="399.8906"/><polygon fill="#A80036" points="265,424.8906,255,428.8906,265,432.8906,261,428.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="259" x2="871.5" y1="428.8906" y2="428.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="359" x="271" y="423.9575">FCONF_GET_PROPERTY(dyn_cfg, dtb, TB_FW_CONFIG_ID)</text><polygon fill="#A80036" points="715.5,454.0234,725.5,458.0234,715.5,462.0234,719.5,458.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="254" x2="721.5" y1="458.0234" y2="458.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="261" y="453.0903">dyn_cfg_dtb_info_getter(TB_FW_CONFIG_ID)</text><polygon fill="#A80036" points="860.5,483.1563,870.5,487.1563,860.5,491.1563,864.5,487.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="727.5" x2="866.5" y1="487.1563" y2="487.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="734.5" y="482.2231">tb_fw_config_info</text><polygon fill="#A80036" points="265,512.2891,255,516.2891,265,520.2891,261,516.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="259" x2="871.5" y1="516.2891" y2="516.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="271" y="511.356">fconf_populate("TB_FW_CONFIG", tb_fw_config)</text><polygon fill="#A80036" points="557,541.4219,567,545.4219,557,549.4219,561,545.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="254" x2="563" y1="545.4219" y2="545.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="291" x="261" y="540.4888">fconf_populate_tbbr_dyn_config(uintptr_t dtb)</text><polygon fill="#FBFB77" filter="url(#f1klycp8oqobvc)" points="463,558.5547,463,583.5547,671,583.5547,671,568.5547,661,558.5547,463,558.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="661" x2="661" y1="558.5547" y2="568.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="671" x2="661" y1="568.5547" y2="568.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="469" y="575.6216">read tbbr properties from dtb</text><polygon fill="#A80036" points="1202,609.6875,1212,613.6875,1202,617.6875,1206,613.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="249" x2="1208" y1="613.6875" y2="613.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="256" y="608.7544">fconf_populate_arm_io_policies(uintptr_t dtb)</text><polygon fill="#FBFB77" filter="url(#f1klycp8oqobvc)" points="1103,626.8203,1103,651.8203,1321,651.8203,1321,636.8203,1311,626.8203,1103,626.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1311" x2="1311" y1="626.8203" y2="636.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1321" x2="1311" y1="636.8203" y2="636.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="1109" y="643.8872">read arm io propeties from dtb</text><polygon fill="#A80036" points="1078.5,677.9531,1088.5,681.9531,1078.5,685.9531,1082.5,681.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="877.5" x2="1084.5" y1="681.9531" y2="681.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="884.5" y="677.02">plat_arm_io_setup()</text><polygon fill="#FBFB77" filter="url(#f1klycp8oqobvc)" points="998,695.0859,998,720.0859,1179,720.0859,1179,705.0859,1169,695.0859,998,695.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1169" x2="1169" y1="695.0859" y2="705.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1179" x2="1169" y1="705.0859" y2="705.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="1004" y="712.1528">use populated properties</text><rect fill="#EEEEEE" filter="url(#f1klycp8oqobvc)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1327" x="3" y="749.7852"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1330" y1="749.7852" y2="749.7852"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1330" y1="752.7852" y2="752.7852"/><rect fill="#EEEEEE" filter="url(#f1klycp8oqobvc)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="83" x="625" y="739.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="64" x="631" y="755.2856">bl2 main</text><!--
@startuml

box "BL2 common code"
	participant bl2_entrypoint
	participant bl2_main
end box

box "platform common code"
	participant fconf
	participant fconf_tbbr_getter
participant fconf_dyn_cfg_getter
end box

box "arm platform code" #LightBlue
	participant arm_bl2_setup
	participant arm_io_storage
	participant arm_fconf_io
end box

== bl2 setup ==
bl2_entrypoint -> bl2_main : bl2_setup()
bl2_main -> arm_bl2_setup : bl2_early_platform_setup2(\n\t arg0, arg1, arg2, arg3)
note over arm_bl2_setup
	arg0 = fw_config
	arg1 = mem_layout
end note
arm_bl2_setup -> arm_bl2_setup : arm_bl2_early_platform_setup(\n\t fw_config, mem_layout)
activate arm_bl2_setup
	arm_bl2_setup -> fconf: fconf_populate("FW_CONFIG", fw_config)
	activate fconf
		fconf -> fconf_dyn_cfg_getter: populate_dtb_registry(uintptr_t dtb)
		note over fconf_dyn_cfg_getter: read dtb_registry properties from dtb
		fconf_dyn_cfg_getter -> arm_bl2_setup
		arm_bl2_setup -> fconf: FCONF_GET_PROPERTY(dyn_cfg, dtb, TB_FW_CONFIG_ID)
		fconf -> fconf_dyn_cfg_getter: dyn_cfg_dtb_info_getter(TB_FW_CONFIG_ID)
		fconf_dyn_cfg_getter -> arm_bl2_setup: tb_fw_config_info
		arm_bl2_setup -> fconf: fconf_populate("TB_FW_CONFIG", tb_fw_config)
		fconf -> fconf_tbbr_getter: fconf_populate_tbbr_dyn_config(uintptr_t dtb)
		note over fconf_tbbr_getter: read tbbr properties from dtb
		fconf -> arm_fconf_io: fconf_populate_arm_io_policies(uintptr_t dtb)
		note over arm_fconf_io: read arm io propeties from dtb
	deactivate fconf
	arm_bl2_setup -> arm_io_storage : plat_arm_io_setup()
	note over arm_io_storage: use populated properties
deactivate arm_bl2_setup

== bl2 main ==

@enduml

PlantUML version 1.2017.15(Mon Jul 03 17:45:34 BST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+1-Ubuntu-0ubuntu1.18.04
Operating System: Linux
OS Version: 4.15.0-124-generic
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>