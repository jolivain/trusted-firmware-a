{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "160e44ea_1391426f",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 2,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2021-01-28T18:34:05Z",
      "side": 1,
      "message": "Is this right?",
      "range": {
        "startLine": 2,
        "startChar": 17,
        "endLine": 2,
        "endChar": 26
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7b5c9880_acb5f78a",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 2,
      "author": {
        "id": 1000102
      },
      "writtenOn": "2021-02-23T16:36:35Z",
      "side": 1,
      "message": "should be \"2021\" only",
      "parentUuid": "160e44ea_1391426f",
      "range": {
        "startLine": 2,
        "startChar": 17,
        "endLine": 2,
        "endChar": 26
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4310ea13_b2e00a08",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 2,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-13T14:44:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7b5c9880_acb5f78a",
      "range": {
        "startLine": 2,
        "startChar": 17,
        "endLine": 2,
        "endChar": 26
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0cf54e9d_8afb41a6",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 13,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-28T12:31:02Z",
      "side": 1,
      "message": "(minor) Is sdei.h really needed here? If it is, what definition do you need from it?",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 26
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e77d1f9_57bc2477",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 13,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-13T14:44:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0cf54e9d_8afb41a6",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 26
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "51e1124e_d5aff9a3",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-01-28T16:25:12Z",
      "side": 1,
      "message": "off + sz could overflow and you would miss this condition. if offset is 0xFFFFFFFFFFFFFFFF and Sz is 1, this would be 0 and \u003c\u003d PCI_OFFSET_MASK.",
      "range": {
        "startLine": 36,
        "startChar": 6,
        "endLine": 36,
        "endChar": 14
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eec1a643_1bfa337d",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2021-01-28T18:34:05Z",
      "side": 1,
      "message": "Agree. Need to check for overflow.",
      "parentUuid": "51e1124e_d5aff9a3",
      "range": {
        "startLine": 36,
        "startChar": 6,
        "endLine": 36,
        "endChar": 14
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "66778578_7e123dbf",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-01-28T20:24:39Z",
      "side": 1,
      "message": "Silly me, I thought the lower levels were sanitizing to the SMC32 calling convention and truncating the registers and when I went looking for it couldn\u0027t find it (this itself is probably a bug!). I don\u0027t see a saturating add either in tfa, any pointers?\n\nFrankly I think I\u0027m going to actually fix this in the main pci_smc_handler, by zeroing the top bits as the spec requires. I might do it in std svc for 32-bit SMCCC calls, but i\u0027m a bit worried about breaking something now.",
      "parentUuid": "eec1a643_1bfa337d",
      "range": {
        "startLine": 36,
        "startChar": 6,
        "endLine": 36,
        "endChar": 14
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e2066c60_2770acc2",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-29T10:34:45Z",
      "side": 1,
      "message": "\u003e Silly me, I thought the lower levels were sanitizing to the SMC32 calling convention and truncating the registers and when I went looking for it couldn\u0027t find it (this itself is probably a bug!).\n\nYes, it sounds like something that should be sanitized upper by one of the callers. Feel free to submit a patch to this effect.\n\n\u003e I don\u0027t see a saturating add either in tfa, any pointers?\n\nI don\u0027t think we\u0027ve got a saturating add but we\u0027ve got a helper function that checks whether the result of the addition would overflow. See include/lib/utils_def.h, check_uptr_overflow().\n\n\u003e Frankly I think I\u0027m going to actually fix this in the main pci_smc_handler, by zeroing the top bits as the spec requires. I might do it in std svc for 32-bit SMCCC calls, but i\u0027m a bit worried about breaking something now.\n\nYes, I agree on the strategy here. We can have a separate patch to handle the overflow in the std service and we\u0027ll make sure this one goes through deeper reviews from the community.",
      "parentUuid": "66778578_7e123dbf",
      "range": {
        "startLine": 36,
        "startChar": 6,
        "endLine": 36,
        "endChar": 14
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a0b6a52f_ba5ec6c5",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-13T14:44:11Z",
      "side": 1,
      "message": "This should be taken care of by the first patch in the series now.",
      "parentUuid": "e2066c60_2770acc2",
      "range": {
        "startLine": 36,
        "startChar": 6,
        "endLine": 36,
        "endChar": 14
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c45868bc_0f9a8287",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 58,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-28T12:31:02Z",
      "side": 1,
      "message": "(minor) This break statement (and others below) is not needed because SMC_RET1() already exits the function.",
      "range": {
        "startLine": 58,
        "startChar": 2,
        "endLine": 58,
        "endChar": 7
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f6ac0250_6eebfd16",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 58,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2021-02-24T06:32:34Z",
      "side": 1,
      "message": "Was the break added to fix MISRA issues?",
      "parentUuid": "c45868bc_0f9a8287",
      "range": {
        "startLine": 58,
        "startChar": 2,
        "endLine": 58,
        "endChar": 7
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b59f8695_2485f59b",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 58,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-02-24T08:50:32Z",
      "side": 1,
      "message": "Perhaps... But most (if not all of) other SMC handlers use SMC_RETx() only (no break statement) and I assume we must have cleaned this code from MISRA violations so I don\u0027t think the break statement is requested by the MISRA checker. But I could be wrong.\n\nIt was only a minor comment anyway, it\u0027s not gating from my point of view.",
      "parentUuid": "f6ac0250_6eebfd16",
      "range": {
        "startLine": 58,
        "startChar": 2,
        "endLine": 58,
        "endChar": 7
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "082b5bb5_fad630b7",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 58,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-13T14:44:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b59f8695_2485f59b",
      "range": {
        "startLine": 58,
        "startChar": 2,
        "endLine": 58,
        "endChar": 7
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c67b6302_647af47b",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 67,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-28T12:31:02Z",
      "side": 1,
      "message": "Would SMC_PCI_CALL_SUCCESS be more explicit here?",
      "range": {
        "startLine": 67,
        "startChar": 20,
        "endLine": 67,
        "endChar": 21
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1e3cf28e_0e6ac0e6",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 67,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-01T21:30:58Z",
      "side": 1,
      "message": "Sure that makes sense here.",
      "parentUuid": "c67b6302_647af47b",
      "range": {
        "startLine": 67,
        "startChar": 20,
        "endLine": 67,
        "endChar": 21
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8d04a7c9_5001d501",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 67,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-13T14:44:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1e3cf28e_0e6ac0e6",
      "range": {
        "startLine": 67,
        "startChar": 20,
        "endLine": 67,
        "endChar": 21
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "362c0fc7_e7812aca",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 82,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-28T12:31:02Z",
      "side": 1,
      "message": "Replace with SMC_PCI_CALL_SUCCESS?",
      "range": {
        "startLine": 82,
        "startChar": 43,
        "endLine": 82,
        "endChar": 45
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "42b6ff10_4ac26f89",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 82,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-01T21:30:58Z",
      "side": 1,
      "message": "No, that doesn\u0027t make sense here because I\u0027m just explicitly assuring the MBZ fields are cleared. Although, now that I\u0027m considering that more, it seems that like the SMC_32 sanitation the default is somewhat brittle as we probably should be clearing fields that MBZ on input but aren\u0027t specified for output to 0.",
      "parentUuid": "362c0fc7_e7812aca",
      "range": {
        "startLine": 82,
        "startChar": 43,
        "endLine": 82,
        "endChar": 45
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b8be54f_cf055a50",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-28T12:31:02Z",
      "side": 1,
      "message": "(minor) Would it make sense to fold these 3 tests, as in\n\n if ((validate...() !\u003d SUCCESS) ||\n     (x4 !\u003d 0) ||\n     (pci_read_config() !\u003d 0)) {\n   SMC_RET2(handle, SMC_PCI_CALL_INVAL_PARAM, 0);\n }\n\n? I would find it easier to the eye but that\u0027s personal style...",
      "range": {
        "startLine": 76,
        "startChar": 0,
        "endLine": 83,
        "endChar": 49
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ba83cbd5_8303c4f3",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 83,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-01T21:30:58Z",
      "side": 1,
      "message": "Godbolt tell me that gcc at -O2 and above, and clang at -O, and above will collapse the duplicate returns. \n\nSo its mostly a style thing left over from dumb compilers, AFAIK its discouraged in most projects to create long chained conditionals due to readability, usually because people tend to mix their \u0026\u0026, ||\u0027s and () in unexpected ways. OTOH, I think misra wants single function return (don\u0027t actually have it handy) but this SMC_RETX makes that nearly impossible.\n\nUnless you have a strong opinion I think this one should be left alone.",
      "parentUuid": "8b8be54f_cf055a50",
      "range": {
        "startLine": 76,
        "startChar": 0,
        "endLine": 83,
        "endChar": 49
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85ca61ab_3717eb52",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 85,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-28T12:31:02Z",
      "side": 1,
      "message": "Replace with SMC_PCI_CALL_SUCCESS?",
      "range": {
        "startLine": 85,
        "startChar": 20,
        "endLine": 85,
        "endChar": 21
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "54b711d5_7d955b2e",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 85,
      "author": {
        "id": 1000043
      },
      "writtenOn": "2021-01-28T12:31:02Z",
      "side": 1,
      "message": "(style) Extra space.",
      "range": {
        "startLine": 85,
        "startChar": 23,
        "endLine": 85,
        "endChar": 24
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "815e0f97_e392a98c",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 85,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-01T21:30:58Z",
      "side": 1,
      "message": "Yup makes sense here.",
      "parentUuid": "85ca61ab_3717eb52",
      "range": {
        "startLine": 85,
        "startChar": 20,
        "endLine": 85,
        "endChar": 21
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ccdf3abd_260e1473",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 85,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-13T14:44:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "54b711d5_7d955b2e",
      "range": {
        "startLine": 85,
        "startChar": 23,
        "endLine": 85,
        "endChar": 24
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9cd33236_02419aa6",
        "filename": "services/std_svc/pci_svc.c",
        "patchSetId": 4
      },
      "lineNbr": 85,
      "author": {
        "id": 1000503
      },
      "writtenOn": "2021-04-13T14:44:11Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "815e0f97_e392a98c",
      "range": {
        "startLine": 85,
        "startChar": 20,
        "endLine": 85,
        "endChar": 21
      },
      "revId": "fbcc23598dc7d5e0cccab303c1bbd05879357c4d",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}