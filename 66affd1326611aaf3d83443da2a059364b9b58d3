{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d783e98a_33cc2d97",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 8,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-01-31T10:11:22Z",
      "side": 1,
      "message": "This is a good cleanup, although there is a slight legacy case being missed here (which may not be working as intended anyway, so good to remove it). Even when EL2 exists in all the worlds, the previous code allowed to initialize NS EL1 ctx. Whether this is a valid config to support in a S-EL2 based system is questionable, but I would have voted to remove that legacy support anyway for these new systems. \n\nMy suggestion is to call this aspect of the patch in the commit message as a NOTE so platform integrators are aware of what this change entails.",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07744f30_fb292844",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 8,
      "author": {
        "id": 1000883
      },
      "writtenOn": "2023-01-31T10:29:45Z",
      "side": 1,
      "message": "Sorry, I\u0027m not entirely sure what the change you mean is. Could you point me to where? I specifically tried to have the exact same flow as before (hence my reply to Juan) in both cases so this is a surprise.",
      "parentUuid": "d783e98a_33cc2d97",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b1cfceae_9dffb4cd",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 8,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2023-01-31T10:56:00Z",
      "side": 1,
      "message": "https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/18770/2/lib/el3_runtime/aarch64/context_mgmt.c#587,\n\nwouldn\u0027t this code get removed when CTX_INCLUDE_EL2_REGS\u003d1 ? But I see now that this code path was not getting invoked anyway, so there is no concern. OK, we are good then.\n\nWould be good to factor out the code under #if !CTX_INCLUDE_EL2_REGS (line 587 - 790) to an internal helper to reduce the LoC of the function cm_prepare_el3_exit().",
      "parentUuid": "07744f30_fb292844",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0d367945_9f78a27b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 8,
      "author": {
        "id": 1000883
      },
      "writtenOn": "2023-01-31T11:00:28Z",
      "side": 1,
      "message": "Yes, it would and we revert to the old code path. I have more patches to (re)factor those lines. I\u0027m hoping I can unify the two cases a little bit after",
      "parentUuid": "b1cfceae_9dffb4cd",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8b3b18ae_949ed08b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 8,
      "author": {
        "id": 1000883
      },
      "writtenOn": "2023-09-22T13:47:17Z",
      "side": 1,
      "message": "discussed offline, old comment",
      "parentUuid": "0d367945_9f78a27b",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "53607e4d_46e8950c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2023-01-26T22:21:31Z",
      "side": 1,
      "message": "Looks good in general. Added a few comments.",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b3143a0_ea2a2647",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 793,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2023-01-26T22:21:31Z",
      "side": 1,
      "message": "Can\u0027t you move this to line 587 instead and use an #else macro in substitution for lines 790 and 795? I think it would be clearer.",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "355cf919_470a40f2",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 793,
      "author": {
        "id": 1000883
      },
      "writtenOn": "2023-01-27T09:24:20Z",
      "side": 1,
      "message": "I would really like to, but I can\u0027t. This function modifies some registers in place and I can\u0027t be sure it will function the same if I moved it. I hope to do it eventually, but that will happen after I refactor it (I have WIP patches) and the register setting above",
      "parentUuid": "3b3143a0_ea2a2647",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4924009f_78b9fd39",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 793,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2023-01-30T23:26:54Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "355cf919_470a40f2",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e15c8bab_01393c99",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 797,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2023-01-26T22:21:31Z",
      "side": 1,
      "message": "I noticed that this does not involve an assertion, so it can be moved outside the #if CTX_INCLUDE_EL2_REGS macro. In fact. Line 588, which is identical, can be moved ouside too (to line 587), therefore they can be unified.",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a7dade44_0f50fca0",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 797,
      "author": {
        "id": 1000883
      },
      "writtenOn": "2023-01-27T09:24:20Z",
      "side": 1,
      "message": "the problem with these two is that when security_state !\u003d NON_SECURE they are unused, producing a warning. Sadly I think this is the best way to do it.",
      "parentUuid": "e15c8bab_01393c99",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "569f816f_a8031f19",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 797,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2023-01-30T23:26:54Z",
      "side": 1,
      "message": "I see. But even if that happens, line 587 is within the if (security_state \u003d\u003d NON_SECURE) condition, therefore there shouldn\u0027t be a warning, right? Or perhaps there\u0027s something that I\u0027m not seeing.",
      "parentUuid": "a7dade44_0f50fca0",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "846f4ef3_72eb3e9a",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 797,
      "author": {
        "id": 1000883
      },
      "writtenOn": "2023-02-07T17:53:37Z",
      "side": 1,
      "message": "right, sorry, the corner case is CTX_INCLUDE_EL2_REGS\u003d1, ENABLE_ASSERTIONS\u003d0, i.e. the release SPM build. Then the variable is created but not consumed.",
      "parentUuid": "569f816f_a8031f19",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3a95fe6c_3ce45348",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 797,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2023-02-09T18:08:27Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "846f4ef3_72eb3e9a",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bb72fb47_72f39552",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 803,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2023-01-26T22:21:31Z",
      "side": 1,
      "message": "Add empty line here.",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ef1e9fe0_a91b098d",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 803,
      "author": {
        "id": 1000883
      },
      "writtenOn": "2023-02-08T09:38:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bb72fb47_72f39552",
      "revId": "66affd1326611aaf3d83443da2a059364b9b58d3",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}