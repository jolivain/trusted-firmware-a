{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e7c38334_bda4a2df",
        "filename": "drivers/arm/pl011/aarch64/pl011_console.S",
        "patchSetId": 3
      },
      "lineNbr": 137,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2024-08-01T09:16:13Z",
      "side": 1,
      "message": "just checking, UART device should be mapped Device-xxx\nIs an explicit memory barrier required as write to this peripheral memory region would be implicitly ordered? Or perhaps it requires revisiting the (n)G(n)R(n)E constraint?",
      "range": {
        "startLine": 137,
        "startChar": 1,
        "endLine": 137,
        "endChar": 11
      },
      "revId": "67aa5d2b15ab66565248523d67220234caeb939e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "186429c5_61ee0a58",
        "filename": "drivers/arm/pl011/aarch64/pl011_console.S",
        "patchSetId": 3
      },
      "lineNbr": 137,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2024-08-01T10:24:41Z",
      "side": 1,
      "message": "Thanks for pointing this out.\n\nWe map the device region as nGnRE - Device non-Gathering, non-Reordering, Early Write Acknowledgement see the code [1] and [2].\n\nIIUC Early Write Acknowledgement means writes to this memory region are acknowledged immediately without waiting for the actual write to complete in hardware. This means that once a write operation is issued, it is considered complete from the perspective of the processor, but the actual hardware write might occur asynchronously.\n\nI\u0027m considering whether we should use ``dsb`` to ensure that device register writes are fully processed and visible, providing complete synchronization. This approach is preferable to using ``dmb st``, which ensures that writes are ordered and visible but may not guarantee full completion of external device operations. Or, we could consider changing the device memory attribute to nGnRnE, This approach would affect all devices, but I\u0027m unsure if changing the attribute for all devices is the best solution. Please let me know what do you think?\n\n[1]: https://review.trustedfirmware.org/plugins/gitiles/TF-A/trusted-firmware-a/+/refs/heads/integration/lib/xlat_tables/aarch64/xlat_tables.c#159 \n[2]: https://review.trustedfirmware.org/plugins/gitiles/TF-A/trusted-firmware-a/+/refs/heads/integration/include/lib/xlat_tables/xlat_tables_defs.h#154",
      "parentUuid": "e7c38334_bda4a2df",
      "range": {
        "startLine": 137,
        "startChar": 1,
        "endLine": 137,
        "endChar": 11
      },
      "revId": "67aa5d2b15ab66565248523d67220234caeb939e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}