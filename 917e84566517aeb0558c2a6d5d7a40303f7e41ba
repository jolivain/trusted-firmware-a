{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "22990299_a6c51684",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 20
      },
      "lineNbr": 0,
      "author": {
        "id": 1000817
      },
      "writtenOn": "2022-08-28T09:59:09Z",
      "side": 1,
      "message": "DLME memory setup should be handled by the platform specific code.",
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26cf4cc8_707a827b",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000817
      },
      "writtenOn": "2022-08-28T09:59:09Z",
      "side": 1,
      "message": "DLME memory area setup should be handled in the platform specific code and shouldn\u0027t part of the base drtm implementation. In case of a security co-processor, dlme memory setup could be handled by the co-processor.",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7f733dee_155dff59",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-08-29T07:40:49Z",
      "side": 1,
      "message": "Hi Varun,\n\nAccording to the DRTM specification (see figure 9 in section 3.14) this function is designed to pull various regions from the platform as shown below (though retrieval of some of the regions is still in the ToDo list).\n\n1. DLME data header (fixed across the platform)\n\nPlatform specific regions -\n2. Protected region list\n3. Address map\n4. DRTM Event Log\n5. TCB hash tables\n6. Implementation specific regions\n\nIn this function, all platform-defined regions are accumulated to create a final DLME data region. This function is much common/logical across platforms (if any regions are not supported by the platform, then it should return NULL for those regions).\n\nIt\u0027s possible to make this whole function platform-specific, but it will be quite a bit of duplicated work for every platform. Could you please let me know your thoughts or did I misunderstand your comment? Thanks!",
      "parentUuid": "26cf4cc8_707a827b",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "443e2bdf_c1f28b01",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000817
      },
      "writtenOn": "2022-09-06T17:43:59Z",
      "side": 1,
      "message": "Hi Manish,\nI am considering a scenario where the DCE may use services provided by the security co-processor to setup the memory for DLME. This could vary from one platform to another. In such a scenario this function would require platform specific modifications.",
      "parentUuid": "7f733dee_155dff59",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d080c16f_2b61cff1",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-09-06T18:41:24Z",
      "side": 1,
      "message": "Hi Varun,\n\nCould you explain with an example what services you specifically believe that the security co-processor may be able to provide for DLME memory setup?\n\nI still think this function is quite logical, and already consist of platform APIs to gather the platform-specific regions. This function works as below -\n1. It dynamically map the DLME region provided DCE-preamble (running in Non-Secure Wd)\n2. Collect the platform-specific regions from the platform\n3. Copy these regions into the DLME memory (mapped in step 1)\n4. Un-map DLME memory region",
      "parentUuid": "443e2bdf_c1f28b01",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "76a0fe3a_977ffcbf",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-09-08T09:41:30Z",
      "side": 1,
      "message": "Additionally, I believe that any services we expect from the security-processor can be handled in step 2 (to gather platform-specific regions) without modifying this function.\n\nMore details on how various platform-specific regions are retrieved -\n1. Platform-specific hooks are used to populate address regions quite early in the DRTM setup phase [1]\n2. As part of the DRTM Event Log work, required components are measured using the platform-supported crypto engine and then these measurements are recorded in DRTM Event Log buffer [2]\n3. There are still other regions in ToDos, but they can be made platform-specific and then eventually can be copied in the DLME memory\n\nHence making this whole function \u0027drtm_dl_prepare_dlme_data\u0027 platform-specific may not be a good idea. Let me know what do you think?\n\n[1]: https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/15700/23/services/std_svc/drtm/drtm_main.c#66\n[2]: https://review.trustedfirmware.org/c/TF-A/trusted-firmware-a/+/15700/23/services/std_svc/drtm/drtm_main.c#491",
      "parentUuid": "d080c16f_2b61cff1",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5dfaa27_7dfdd649",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000817
      },
      "writtenOn": "2022-09-08T17:11:41Z",
      "side": 1,
      "message": "Hi Manish,\nYes, I was concerned about the measurement/attestation of DLME payload and the mechanism to retrieve the address regions. I may have missed these points while going over the patches. I have been struggling a bit with gerrit. Let me just go over the patchset again and see if I can get more clarity.\n\nRegards\nVarun",
      "parentUuid": "76a0fe3a_977ffcbf",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c2332dfa_4dcddd32",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-09-13T15:42:10Z",
      "side": 1,
      "message": "Hi Varun,\n\nHave you had a chance to view the full patch stack? We are planning on merging these phase-I changes of DRTM and improvising them in subsequent patches. \n\nThanks,\nManish",
      "parentUuid": "a5dfaa27_7dfdd649",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "81555a85_70f9a6e4",
        "filename": "services/std_svc/drtm/drtm_main.c",
        "patchSetId": 20
      },
      "lineNbr": 293,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2022-09-29T16:36:24Z",
      "side": 1,
      "message": "@Varun, Hope you\u0027re fine with merging these phase-I DRTM patches.",
      "parentUuid": "c2332dfa_4dcddd32",
      "range": {
        "startLine": 293,
        "startChar": 0,
        "endLine": 293,
        "endChar": 1
      },
      "revId": "917e84566517aeb0558c2a6d5d7a40303f7e41ba",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}