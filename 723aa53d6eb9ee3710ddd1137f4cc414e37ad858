{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "e48c60c8_c921869d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-23T00:05:47Z",
      "side": 1,
      "message": "Juan, thanks for having a look!",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0a96f160_299f5c56",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-23T22:25:12Z",
      "side": 1,
      "message": "No problem! I hope it helps :)",
      "parentUuid": "e48c60c8_c921869d",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "939b8b1a_dc9dcf18",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-22T23:29:44Z",
      "side": 1,
      "message": "*RNDRRS",
      "range": {
        "startLine": 17,
        "startChar": 26,
        "endLine": 17,
        "endChar": 32
      },
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9cac7ce7_3917a9ca",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 17,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-23T00:05:47Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "939b8b1a_dc9dcf18",
      "range": {
        "startLine": 17,
        "startChar": 26,
        "endLine": 17,
        "endChar": 32
      },
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "79e89c41_6bc50172",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-22T23:29:44Z",
      "side": 1,
      "message": "This doesn\u0027t seem to be platform-dependent, so I would move it somewhere else. There is no C file for helpers like this, but maybe adding it to plat/common/aarch64/platform_helpers.h (to be created) is the right place.",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 34,
        "endChar": 1
      },
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "42d1a36d_7f328f85",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-23T00:05:47Z",
      "side": 1,
      "message": "This is a somewhat odd function, the fact that the trap even applies to EL3 tells me that using the real instructions was probably not the intention. So I am not sure this is useful somewhere else, and given that this is more of a demo or reference code, I don\u0027t think we should have that somewhere more generic. At least for now. Maybe let\u0027s wait for the first *real* user?",
      "parentUuid": "79e89c41_6bc50172",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 34,
        "endChar": 1
      },
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "627b9c35_de2560a6",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-23T21:30:50Z",
      "side": 1,
      "message": "Right. It won\u0027t probably be used anywhere else. We can move it later if we need.",
      "parentUuid": "42d1a36d_7f328f85",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 34,
        "endChar": 1
      },
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c228b2ac_ad4c291d",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 34,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-12-06T16:25:03Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "627b9c35_de2560a6",
      "range": {
        "startLine": 19,
        "startChar": 0,
        "endLine": 34,
        "endChar": 1
      },
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5581c899_97f2d39b",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-22T23:29:44Z",
      "side": 1,
      "message": "Although this is just a proof of concept, I would have a different block for *RNDRRS",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fdee4793_109da9df",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-23T00:05:47Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "5581c899_97f2d39b",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "265548a5_715eb921",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-24T17:15:32Z",
      "side": 1,
      "message": "So I tried that, and it doesn\u0027t really look nice, it just duplicates some code, for no good reason. I think people get the idea when they see the \u0027||\u0027, so I would like to keep it in that compact way.",
      "parentUuid": "fdee4793_109da9df",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "dd2ea8d4_7d8182a9",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-28T22:32:55Z",
      "side": 1,
      "message": "I see... The only thing I see is that you would get the same result (what\u0027s in RNDR) whether you try to read RNDR or RNDRRS. The impact for an FVP seems to be minimal and for me it would be OK, but I\u0027m going to ask Manish P or Madhu to review this in particular, as they are the owners of this module, and therefore they will be able to judge better than I.",
      "parentUuid": "265548a5_715eb921",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "26903467_7ebe42b4",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-28T23:43:54Z",
      "side": 1,
      "message": "Yeah, but as you said I don\u0027t think this is meaningful in this context - especially as this is demonstration code. In the real world chances are we trap because the h/w instructions have some issues, so executing them in EL3 is not really useful in practice.\nBut I am happy either way, let\u0027s see what Manish or Madhu say.",
      "parentUuid": "dd2ea8d4_7d8182a9",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "378e67ba_3a287b05",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 41,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2022-12-05T20:59:37Z",
      "side": 1,
      "message": "No major concerns from me. Posted a minor comment in patchset2",
      "parentUuid": "26903467_7ebe42b4",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0fa02b05_4e726580",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 45,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-22T23:29:44Z",
      "side": 1,
      "message": "The only problem I see here is that a concurrent access to RNDR/RNDRRS would not be trapped (unlikely but possible) when RNG_TRAP is disabled. Maybe we should mask this type of trap for EL3 only to prevent ignoring traps coming from lower ELs.",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6e92434_85d50308",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 45,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-23T00:05:47Z",
      "side": 1,
      "message": "Which concurrent access? Both the instruction and the trap bit are per core, so who should execute those instructions between those two calls? Definitely not lower EL.\nAnd mask how? This is a synchronous exception.",
      "parentUuid": "0fa02b05_4e726580",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ba3007b1_e458aa71",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 45,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-23T21:30:50Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "e6e92434_85d50308",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "81385cce_9485a709",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-22T23:29:44Z",
      "side": 1,
      "message": "you can use rnd \u003d read_rndr() (and read_rndrrs()) instead ;)",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c21d7714_0fd4dd01",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-23T00:05:47Z",
      "side": 1,
      "message": "Ah, good point, I missed that.",
      "parentUuid": "81385cce_9485a709",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7ffbf125_213193df",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-24T17:15:32Z",
      "side": 1,
      "message": "Well, almost, the assembler complains about the \"rndr\" encoding unless we also enable armv8.5-a. I changed the existing definition to use the alternative S3_... encoding.",
      "parentUuid": "c21d7714_0fd4dd01",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c6e775cf_f794352a",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1000750
      },
      "writtenOn": "2022-11-28T22:32:55Z",
      "side": 1,
      "message": "I don\u0027t think that this would be much of a problem, but just FYI: FEAT_RNG is a v8.5 feature, shouldn\u0027t we expect those registers to be available from that version on?",
      "parentUuid": "7ffbf125_213193df",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "35ea5eae_0431aa70",
        "filename": "plat/arm/board/fvp/fvp_sync_traps.c",
        "patchSetId": 1
      },
      "lineNbr": 46,
      "author": {
        "id": 1000118
      },
      "writtenOn": "2022-11-28T23:43:54Z",
      "side": 1,
      "message": "So I see different problems here:\n- RNG is an *optional* v8.5 feature, many SoCs might not have an entropy source. And it stays optional, even with implementations using a higher architecture level.\n- The assembler *complains* unless we specify -march\u003darmv8.5-a during build. This is a somewhat questionable molly-guard, if you ask me, because the compiler does not generate RND instructions, it\u0027s just explicitly warning us about using instructions that *might* not run on every machine. Now in this case we know it works, because otherwise we wouldn\u0027t have ended up in the trap here in the first place.\n- The FVP is highly configurable, you can turn on and off features on the command line. Specifying an architecture level at compile time in unrelated to the option you start the FVP with. We acknowledge this by checking the availability of features at runtime, using the architected way of reading the ID registers (at least we aim at that, see my other series).\n- There is also the chance that your compiler/assembler version might simply not know about the instruction or the specific -march *string*, so we unnecessarily restrict the user\u0027s choice of a toolchain.\n- From a pure technical point of view the architecture level is not very meaningful: some features can be backported, some are optional, others are cherry-picked from higher levels. All we need to know is: does this particular CPU have this particular *feature*?\n\nThe best thing is: there is a simple solution to all of this: Just use the explicit S3_... encoding. We sign the waiver by saying we know what we are doing, and we are using this explicitly in places that we checked it works.",
      "parentUuid": "c6e775cf_f794352a",
      "revId": "723aa53d6eb9ee3710ddd1137f4cc414e37ad858",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}