{
  "comments": [
    {
      "key": {
        "uuid": "7434c8b5_6c1ea018",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-02-05T17:05:25Z",
      "side": 1,
      "message": "do we really need the ISB? E2H will not take effect until you are in EL2 so none of those bits should apply at all while we are context switching in EL3.",
      "range": {
        "startLine": 14,
        "startChar": 6,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "b740863d7b1d271c332a952d644a95d8e837c97e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a69ad432_021c7a76",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1000181
      },
      "writtenOn": "2021-02-05T17:16:34Z",
      "side": 1,
      "message": "We tried it in TC0 model which simulates delays in synchronization \nof system registers (though not accurately). If the E2H bit was not set before the ASID changes in TTBR_EL2, the asid id was not correct while accessing data via MMU, therefore we couldnt access memory after getting into kernel.\n\nWith this ISB, it is guaranteed that E2H will be set before TTBR1_EL2 is written, which is not always the case in models as they have large/infinite synchronization times and can be out of order executed resulting in TTBR1_EL2 being set before HCR_EL2.E2H.",
      "parentUuid": "7434c8b5_6c1ea018",
      "range": {
        "startLine": 14,
        "startChar": 6,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "b740863d7b1d271c332a952d644a95d8e837c97e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "87aab881_a993c2de",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-02-05T17:23:39Z",
      "side": 1,
      "message": "That sounds like the bug in the model. Is that fair to say? Architecturally, as far as i know, the isb is not required at EL3.\nNot sure we want to put a fix for a model which affects all silicon as well.\n\nAs always, adding barriers means cost in context switch code which we should try to avoid if at all possible.",
      "parentUuid": "a69ad432_021c7a76",
      "range": {
        "startLine": 14,
        "startChar": 6,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "b740863d7b1d271c332a952d644a95d8e837c97e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc55b350_9456cb2a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1000228
      },
      "writtenOn": "2021-02-05T17:32:54Z",
      "side": 1,
      "message": "Agree with Raghu.. Last update I saw on this topic concluded a model bug, so is this change still worth it? Unless we cannot get the model updated (in time) hence this change is temporary and shall be marked as such.",
      "parentUuid": "87aab881_a993c2de",
      "range": {
        "startLine": 14,
        "startChar": 6,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "b740863d7b1d271c332a952d644a95d8e837c97e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "28b6d63a_f2fc1d12",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 14,
      "author": {
        "id": 1000181
      },
      "writtenOn": "2021-02-05T17:43:21Z",
      "side": 1,
      "message": "Thanks Raghu and Olivier for the review!\n\nAgree its a model issue, i.e. the order of msr instruction execution is not guaranteed.\n\nAs it has a significant cost on execution time in silicon as Raghu pointed out, it should not be merged, i will discuss with models team and abandon the patch.",
      "parentUuid": "cc55b350_9456cb2a",
      "range": {
        "startLine": 14,
        "startChar": 6,
        "endLine": 14,
        "endChar": 51
      },
      "revId": "b740863d7b1d271c332a952d644a95d8e837c97e",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    }
  ]
}