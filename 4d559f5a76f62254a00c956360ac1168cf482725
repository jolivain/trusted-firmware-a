{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f66cd3b1_36c3a663",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-04-05T15:45:30Z",
      "side": 1,
      "message": "it would be worth mentioning that in the current measured boot model, bl1, bl2, bl31 and all of secure world effectively forms the S-CRTM.There are assets to protect, i.e the event log and measurements, and I think it would be good to call out that these are stored in secure memory, like you mention in the commit messages.\nBl1, bl2, bl31 itself are assets (FW) that need protection and are protected by secure boot.",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "360ca13e_ac8b2102",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-04-05T15:46:43Z",
      "side": 1,
      "message": "would highly recommend being explicit so people are aware what they are signing up for. There are two issues with the measured boot design, that I have pointed out in earlier reviews:\n1) If secure boot is broken, measured boot is broken.\n2) S-CRTM is fairly large, since it includes all of secure world.",
      "parentUuid": "f66cd3b1_36c3a663",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1fdca54_4aaa1806",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-04-05T16:38:57Z",
      "side": 1,
      "message": "\u003e it would be worth mentioning that in the current measured boot model, bl1, bl2, bl31 and all of secure world effectively forms the S-CRTM.There are assets to protect, i.e the event log and measurements, and I think it would be good to call out that these are stored in secure memory, like you mention in the commit messages.\nBl1, bl2, bl31 itself are assets (FW) that need protection and are protected by secure boot.\n\nThanks! I will mention this explicitly in the document.\n\n\u003e would highly recommend being explicit so people are aware what they are signing up for. There are two issues with the measured boot design, that I have pointed out in earlier reviews:\n1) If secure boot is broken, measured boot is broken.\n2) S-CRTM is fairly large, since it includes all of secure world.\n\nAs far as (1) is concerned, it is obvious that secured boot is broken, and measured boot is broken because BL2 is taking measurements of all images. In order for those components which take the measurements to trust them, Secure-Boot must be implemented. This doesn\u0027t seem to be a problem to me. Please correct me if I\u0027m wrong. I\u0027m fine with (2) to mention it explicitly.",
      "parentUuid": "360ca13e_ac8b2102",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0926b848_a7814999",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-04-05T16:54:11Z",
      "side": 1,
      "message": "Hi Manish, for #2, I wouldn\u0027t word it exactly like I did and scare people, instead we should probably just say, the SCRTM includes all of those components and people can make up their mind about how large they think it is (it is subjective).\nFor #1, I could design a measured boot scheme where the first measurement to the TPM (discrete TPM) is made from the boot rom. That way, secure boot does not matter even if it is broken, since measured boot only relies on integrity of only the boot rom. Since the first measurement is made in boot rom, even if mutable firmware is malicious, it cannot spoof the measurement of the first mutable code (i.e first mutable code cannot lie about its measurement). \nLet me know if that clears out #1.",
      "parentUuid": "e1fdca54_4aaa1806",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "89dcd3f2_9d030cc0",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-04-05T19:56:03Z",
      "side": 1,
      "message": "\u003e Hi Manish, for #2, I wouldn\u0027t word it exactly like I did and scare people, instead we should probably just say, the SCRTM includes all of those components and people can make up their mind about how large they think it is (it is subjective).\n\nOkay. IMO, it is more of an FYI than a warning I will mention in this document. As SRTM is generally designed in this way, this limitation is well known. \n\n\u003e For #1, I could design a measured boot scheme where the first measurement to the TPM (discrete TPM) is made from the boot rom. That way, secure boot does not matter even if it is broken, since measured boot only relies on integrity of only the boot rom. Since the first measurement is made in boot rom, even if mutable firmware is malicious, it cannot spoof the measurement of the first mutable code (i.e first mutable code cannot lie about its measurement).\n\u003e Let me know if that clears out #1\n\nThanks that clears my understanding. Since the first measurement is taken by an immutable component (BL1) in dTPM, it is always legit. Any subsequent measurements taken by malicious mutable component will be added to this first measurement in dTPM and that results in always final PCR value different than expected one that explains Measured-Boot is not really depends on Secure-Boot but only need to be depend on integrity of BL1 (that is the must case anyways).\nIn the current TF-A Measured Boot design, the first measurement is taken by the immutable component (BL1) and is recorded in the Event Log via platform API. However, there are no existing platforms today that leverage use of this API to record the measurement in the dTPM that is why we can say Measured Boot depends on Secure Boot (so if Secure-Boot is broken then Measured-Boot is broken) to trust on Event Log. But this is not really a TF-A Measured-Boot design limitation but rather implementation choice by the platform/HW limitation (dTPM) of the platform right?",
      "parentUuid": "0926b848_a7814999",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "22f61817_77f086cb",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-04-05T21:41:32Z",
      "side": 1,
      "message": "agree with warning for #2.\nFor #1, agree, if a platform implements measured boot with the backend as TPM and event log as opposed to using a dTPM, there is no issue. It is a platform choice. I think my statement was more from the point of view of the most common and default implementation, which DOES have this problem since a fTPM is used. \nPerhaps the clarification should be that the warning and threat/mitigation applies to the default implementation and the fTPM model and need not necessarily apply to a dTPM implementation that hooks up to the dTPM from Bl1.\nI just saw a review from Sandrine that talks about how the threat model applies to most common platforms so if that is the case with this document, I thought it might be worth calling this nuance out. Let me know if you disagree.",
      "parentUuid": "89dcd3f2_9d030cc0",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1c20636e_af08649e",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2023-04-06T08:29:41Z",
      "side": 1,
      "message": "Hi Raghu, I agree with what you said. Now that I\u0027ve captured everything below -\n\n\"In the current Measured Boot design, BL1, BL2, and BL31, as well as the secure world components, form the SRTM. Measuring data is currently considered an asset to be protected against attack, and this is achieved by storing it in a TCG-compatible Event Log buffer in the Secure Memory. Beyond the TCG-compliant Event Log buffer, there are no other assets to protect or threats to defend against that could compromise the TF-A execution environment\u0027s security.\n\nThere are generally security assets and threats associated with remote/delegated attestation. However, these are outside the TF-A security boundary and should be dealt with by the appropriate agent in the platform system. \n\nA limitation of the current Measured Boot design is that it is dependent upon Secure Boot as the default implementation of Measured Boot does not support Discrete TPM. This implies that if Secure-Boot breaks, Measured Boot also breaks.\n\nPlatforms must be cautious in deciding how large they need this SRTM as SRTM includes all Secure World components.\"\n\nPlease let me know if this is okay. If there is anything else I can cover, let me know.",
      "parentUuid": "22f61817_77f086cb",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "edec962c_8dc0f867",
        "filename": "docs/threat_model/threat_model.rst",
        "patchSetId": 1
      },
      "lineNbr": 44,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2023-04-06T13:40:01Z",
      "side": 1,
      "message": "this looks fine. some nits: feel free to ignore:\n1) Would change \"Measuring data\" to \"Measurement Data\".\n2) \"that could compromise the TF-A execution environment\u0027s security.\" -\u003e \"that could compromise the security guarantees provided by measured boot\"\n3) \"There are generally security assets\" -\u003e \"There are general security assets\"\n4) \"appropriate agent in the platform system\" -\u003e \"appropriate agent in the platform/system\"? \n5) \"implementation of Measured Boot does not support Discrete TPM\" -\u003e \"implementation of measured boot does not extend measurements into a discrete TPM\". discrete TPM is supported by the default implementation if the platform chooses to right? and is it the default implementation or the FVP implementation? This looks like we dont support a dTPM backend, but i believe we do?\n6) \"This implies that if Secure-Boot breaks, Measured Boot also breaks.\" - Would remove the word \"breaks\" and replace with \"is compromised, measured boot may also be compromised\".\n7) \"Platforms must be cautious in deciding how large they need this SRTM as SRTM includes all Secure World components\" -\u003e \"Platforms must carefully evaluate the security of the default implementation since the SRTM includes all secure world components\".",
      "parentUuid": "1c20636e_af08649e",
      "revId": "4d559f5a76f62254a00c956360ac1168cf482725",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}