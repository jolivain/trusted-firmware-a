{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c80ce2db_7ce83127",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2024-08-12T13:32:43Z",
      "side": 1,
      "message": "Hi Yann,\n\nThe FW config is primarily used for managing configuration Device Tree (DT) files across various firmware components. It should include the following:\n\nTB_FW_CONFIG: To be utilized by BL2.\nNT_FW_CONFIG: To be utilized by BL33.\nHW_CONFIG: To be securely used by BL31, and by BL33 through non-secure memory.\nTOS_FW_CONFIG: To be utilized by BL32.\n\nIdeally, this configuration should not contain details about the firmware to be loaded. If the device trees are already embedded within the firmware, explicit entries are unnecessary, as these DTs are part of the firmware and will be loaded by BL2 using memory descriptors. The primary purpose of FW_CONFIG is to provide a dynamic capability to load firmware configurations at the desired location.\n\nI saw from your patch that it is basically using FW_CONFIG DT to load the firmware by providing its load address. See how Arm FVP platform uses here [1].\n\nThis makes me think that on the ST platform, you\u0027ve chosen not to load BL32 and BL33 at fixed addresses. Please correct me if I\u0027m mistaken.\n\n\n[1]: https://review.trustedfirmware.org/plugins/gitiles/TF-A/trusted-firmware-a/+/refs/heads/master/plat/arm/board/fvp/fdts/fvp_fw_config.dts",
      "revId": "9da0a4e9590b8bc957f4965b4bd0bdf74f764a99",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aaa50467_14787a1b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000103
      },
      "writtenOn": "2024-08-12T13:51:42Z",
      "side": 1,
      "message": "On STM32MP1 and STM32MP2 platform, there is no BL1, and the ROM code can only load one binary. That\u0027s why TB_FW_CONFIG macro is not used, but BL2 DT is inside the .stm32 binary together with BL2.\nAs OP-TEE does not properly handle external DT (but it may have changed), we decided to use directly HW_CONFIG for U-Boot device tree.\nOn ST boards, we usually load BL32 and BL33 at the same place, but we want to let our customers the possibility to change this. This could be required for boards having less DDR for example.",
      "parentUuid": "c80ce2db_7ce83127",
      "revId": "9da0a4e9590b8bc957f4965b4bd0bdf74f764a99",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "65af31ce_cd3980fe",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1000328
      },
      "writtenOn": "2024-08-12T18:02:58Z",
      "side": 1,
      "message": "I understand your point. It seems like we might be altering the original purpose of the FW_CONFIG device tree. The intent behind adding FW_CONFIG was to provide load addresses for different configurations (mentioned in above discussion) that come into play during the boot process, not to include firmware\u0027s load addresses.\n\nIMO, if we need to incorporate firmware load addresses into the device tree, they should be included in the TB_FW_CONFIG. Is it possible for BL2 to load the TB_FW_CONFIG on its own to retrieve those details before proceeding with firmware loading? (as you mentioned in ST case ROM can\u0027t load the TB_FW_CONFIG).\n\nI believe we should explore adopting the firmware handoff mechanism in the future, as it may reduce the need for FW_CONFIG.",
      "parentUuid": "aaa50467_14787a1b",
      "revId": "9da0a4e9590b8bc957f4965b4bd0bdf74f764a99",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1e5ceb31_fb975179",
        "filename": "fdts/stm32mp25-fw-config.dtsi",
        "patchSetId": 2
      },
      "lineNbr": 25,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2024-08-09T17:55:32Z",
      "side": 1,
      "message": "shouldn\u0027t it be NT_FW_CONFIG_ID?",
      "range": {
        "startLine": 25,
        "startChar": 9,
        "endLine": 25,
        "endChar": 22
      },
      "revId": "9da0a4e9590b8bc957f4965b4bd0bdf74f764a99",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "94dcc577_51c33d87",
        "filename": "fdts/stm32mp25-fw-config.dtsi",
        "patchSetId": 2
      },
      "lineNbr": 25,
      "author": {
        "id": 1000103
      },
      "writtenOn": "2024-08-12T07:19:05Z",
      "side": 1,
      "message": "From what I understand, NT_FW_CONFIG_ID is for the config for Non-trusted firmware, not the firmware. The non-trusted firmware is U-Boot in our case, and its config would be U-Boot device tree. But we already use hw-config for this.",
      "parentUuid": "1e5ceb31_fb975179",
      "range": {
        "startLine": 25,
        "startChar": 9,
        "endLine": 25,
        "endChar": 22
      },
      "revId": "9da0a4e9590b8bc957f4965b4bd0bdf74f764a99",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d44b4435_96a5c5cf",
        "filename": "fdts/stm32mp25-fw-config.dtsi",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1000098
      },
      "writtenOn": "2024-08-09T17:55:32Z",
      "side": 1,
      "message": "TOS_FW_CONFIG_ID?",
      "range": {
        "startLine": 29,
        "startChar": 9,
        "endLine": 29,
        "endChar": 22
      },
      "revId": "9da0a4e9590b8bc957f4965b4bd0bdf74f764a99",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "dc20ffb5_c2836cc9",
        "filename": "fdts/stm32mp25-fw-config.dtsi",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1000103
      },
      "writtenOn": "2024-08-12T07:19:05Z",
      "side": 1,
      "message": "Same kind of thing here. TOS_FW_CONFIG_ID would be OP-TEE device tree for our use-case. But it is not possible (yet?) to load a separate DT for OP-TEE. The DT is embedded into OP-TEE binary.",
      "parentUuid": "d44b4435_96a5c5cf",
      "range": {
        "startLine": 29,
        "startChar": 9,
        "endLine": 29,
        "endChar": 22
      },
      "revId": "9da0a4e9590b8bc957f4965b4bd0bdf74f764a99",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}