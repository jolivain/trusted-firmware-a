{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d6efb91f_0a6e88c1",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 1155,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2024-02-06T11:22:40Z",
      "side": 1,
      "message": "Sorry, I need to correct my previous understanding. Although Realm world does not handle Physical Interrupt from GIC, Realm world uses Virtual interrupts for Realm VMs. This means that some of the control bits in these registers still need to be programmed for Realm world.\n\nSo, Initially for RME , we used to enable S-EL2 regardless of 3 world or 4 world setup. This means that this flow works will work without any NS bit programming.\n\nSo we have 2 solutions for this :\n\n1. Enable EEL2 for both SPMD_AT_EL2 and ENABLE_RME cases.\n2. Detect Realm world here and toggle scr_el3.ns and scr_el3.nse to correspond to the correct world when programming the context.",
      "revId": "a2183f564582808c747df872f725fd7bb5f07028",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9f39ee71_415d322b",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 1155,
      "author": {
        "id": 1000102
      },
      "writtenOn": "2024-02-06T13:04:29Z",
      "side": 1,
      "message": "If we think about option 1 then more fundamental approach would be to mandate that there cannot be a 3 world system (without S-EL2). For the 2nd option, it would look ugly but let me explore more if we could find any alternate solution.",
      "parentUuid": "d6efb91f_0a6e88c1",
      "revId": "a2183f564582808c747df872f725fd7bb5f07028",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f35b837a_40bed037",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 1155,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2024-02-06T16:46:10Z",
      "side": 1,
      "message": "For RME , there is an implicit assumption in TF-A that if Secure world must exist, then S-EL2 must be enabled. \n\nAlso the assumption that S-EL2 is enabled in CPU for RME but not have any secure world software is also not problematic AFAICS (3 world configuration). \n\nThe option 2 solution may be overkill as real hardware platforms may always have a secure world (in S-El2) so any runtime check is an overhead.\n\nAlso when RMMD and SPMD takes responsibility for fine grained EL2 save and restore, then this problem can be solved within these components.",
      "parentUuid": "9f39ee71_415d322b",
      "revId": "a2183f564582808c747df872f725fd7bb5f07028",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "78ecbafc_3f9f2a05",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 1155,
      "author": {
        "id": 1000102
      },
      "writtenOn": "2024-02-07T16:04:19Z",
      "side": 1,
      "message": "BY \"Secure world must exist, then S-EL2 must be enabled\" you mean there is a possibility that Secure world does not exist in PE but if it exists then S-El2 must be present? \n\n\u003e Also the assumption that S-EL2 is enabled in CPU for RME but not have any secure \u003e world software is also not problematic AFAICS (3 world configuration).\nEEL2 should be zero in this case, no ?",
      "parentUuid": "f35b837a_40bed037",
      "revId": "a2183f564582808c747df872f725fd7bb5f07028",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3e5dff2c_9b96d149",
        "filename": "lib/el3_runtime/aarch64/context_mgmt.c",
        "patchSetId": 2
      },
      "lineNbr": 1155,
      "author": {
        "id": 1000102
      },
      "writtenOn": "2024-02-08T11:46:56Z",
      "side": 1,
      "message": "Updated the patch",
      "parentUuid": "78ecbafc_3f9f2a05",
      "revId": "a2183f564582808c747df872f725fd7bb5f07028",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda"
    }
  ]
}