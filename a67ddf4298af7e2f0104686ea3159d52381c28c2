{
  "comments": [
    {
      "key": {
        "uuid": "dda255b0_b8837afc",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 57,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-01-24T20:07:38Z",
      "side": 1,
      "message": "why do we need an isb here?",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b6dcd0f8_95557b15",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 57,
      "author": {
        "id": 1000469
      },
      "writtenOn": "2021-01-25T13:10:30Z",
      "side": 1,
      "message": "isb is here to avoid speculative read of DCC status register before executing read or write.\nNormally you print/get more chars that\u0027s why this code is called in a loop.\n\nThe same is mentioned at\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/plain/arch/arm64/include/asm/dcc.h?h\u003dv5.11-rc5",
      "parentUuid": "dda255b0_b8837afc",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea5db52a_fa067c42",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 57,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-01-25T14:20:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "b6dcd0f8_95557b15",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2130f7ae_1deddc44",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 57,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-01-25T16:54:37Z",
      "side": 1,
      "message": "Actually, i want to debate this a little more. ISB does nothing for speculative execution per the ARM ARM but it does for ordering instructions. Can you explain to me a little more what happens if you dont use the ISB?",
      "parentUuid": "ea5db52a_fa067c42",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "169eb504_dd6ddf68",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 57,
      "author": {
        "id": 1000469
      },
      "writtenOn": "2021-01-29T07:29:29Z",
      "side": 1,
      "message": "ISB\n\nInstruction Synchronization Barrier flushes the pipeline in the processor, so that all instructions following the ISB are fetched from cache or memory, after the instruction has been completed. It ensures that the effects of context altering operations, such as changing the ASID, or completed TLB maintenance operations, or branch predictor maintenance operations, as well as all changes to the CP15 registers, executed before the ISB instruction are visible to the instructions fetched after the ISB.\n\nIn addition, the ISB instruction ensures that any branches that appear in program order after it are always written into the branch prediction logic with the context that is visible after the ISB instruction. This is required to ensure correct execution of the instruction stream.\n\nYou have likely closer connection to arm than I but it sounds like branch prediction which should be speculative execution is also affected by isb.",
      "parentUuid": "2130f7ae_1deddc44",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b535831_af044b0e",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 57,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-01-29T15:26:22Z",
      "side": 1,
      "message": "Thanks Michal, familiar with this text. The problem with the ARM ARM is that what it usually talks about is architectural execution unless it explicitly specifies constraints on speculative execution, like it does in other parts of the spec. Here, ISB places no constraints on speculative execution at all so if you are depending on ISB to constrain speculative execution, it may not work on all implementations. That is why i asked you what happens if you dont use the ISB. That way, we know what exactly you are attempting to solve. If not, you may be slowing down performance for no reason. I understand linux uses it but they may have a different reason for doing it or may be there is a bug there as well. Would be good to understand the exact issue being solved with the ISB.",
      "parentUuid": "169eb504_dd6ddf68",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "17bed495_843f9ee2",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 57,
      "author": {
        "id": 1000469
      },
      "writtenOn": "2021-01-30T15:05:32Z",
      "side": 1,
      "message": "Asked already Venkatesh to try it if he sees any issue. And I see he has removed it. Let\u0027s see if something pops up in future.",
      "parentUuid": "4b535831_af044b0e",
      "range": {
        "startLine": 57,
        "startChar": 1,
        "endLine": 57,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba917cf3_9fde82fb",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 69,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-01-24T20:07:38Z",
      "side": 1,
      "message": "why do we need an isb here?",
      "range": {
        "startLine": 69,
        "startChar": 1,
        "endLine": 69,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42a14ba4_78806c59",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 69,
      "author": {
        "id": 1000114
      },
      "writtenOn": "2021-01-25T14:20:21Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "ba917cf3_9fde82fb",
      "range": {
        "startLine": 69,
        "startChar": 1,
        "endLine": 69,
        "endChar": 4
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a487ac02_d0876fe7",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 75,
      "author": {
        "id": 1000162
      },
      "writtenOn": "2021-01-25T18:55:29Z",
      "side": 1,
      "message": "Can you please add a comment saying that on a timeout we will overwrite the previous character? Do you think that\u0027s the best option? Should we not return error for a timeout scenario? Is there a need to reset the hardware block to get rid of the timeout causing conditions?",
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c9ad4dd6_d51c47d3",
        "filename": "drivers/arm/dcc/dcc_console.c",
        "patchSetId": 3
      },
      "lineNbr": 76,
      "author": {
        "id": 1000440
      },
      "writtenOn": "2021-01-25T16:22:29Z",
      "side": 1,
      "message": "MISRA - this should be of boolean essential type:\n((__dcc_getstatus() \u0026 DCC_STATUS_RX) !\u003d 0)\n\nAlso in ln 87, ln 109",
      "range": {
        "startLine": 76,
        "startChar": 8,
        "endLine": 76,
        "endChar": 43
      },
      "revId": "a67ddf4298af7e2f0104686ea3159d52381c28c2",
      "serverId": "8f6f209b-db1a-4cbf-aa44-c8bc30e9bfda",
      "unresolved": true
    }
  ]
}